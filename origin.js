var vn=Object.create,zr=Object.defineProperty,wn=Object.getOwnPropertyDescriptor,_n=Object.getOwnPropertyNames,Sn=Object.getPrototypeOf,kn=Object.prototype.hasOwnProperty,l=(e,t)=>zr(e,"name",{value:t,configurable:!0}),Ve=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):e)((function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')})),lr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Cn=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of _n(t))!kn.call(e,o)&&o!==r&&zr(e,o,{get:()=>t[o],enumerable:!(n=wn(t,o))||n.enumerable});return e},gr=(e,t,r)=>(r=null!=e?vn(Sn(e)):{},Cn(!t&&e&&e.__esModule?r:zr(r,"default",{value:e,enumerable:!0}),e)),to=lr((()=>{})),eo=lr(((e,t)=>{!function(e){"use strict";var t=l((function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r}),"gf"),r=l((function(){throw new Error("no PRNG")}),"randombytes"),n=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var a=t(),i=t([1]),s=t([56129,1]),c=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),d=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function f(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function m(e,t,r,n,o){var a,i=0;for(a=0;a<o;a++)i|=e[t+a]^r[n+a];return(1&i-1>>>8)-1}function g(e,t,r,n){return m(e,t,r,n,16)}function y(e,t,r,n){return m(e,t,r,n,32)}function b(e,t,r,n){for(var o,a=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,l=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,c=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,d=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,u=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,f=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,m=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,y=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,b=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,v=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,w=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,_=a,x=i,k=s,S=l,C=c,E=d,A=u,P=h,I=p,R=f,T=m,N=g,D=y,$=b,B=v,M=w,z=0;z<20;z+=2)_^=(o=(D^=(o=(I^=(o=(C^=(o=_+D|0)<<7|o>>>25)+_|0)<<9|o>>>23)+C|0)<<13|o>>>19)+I|0)<<18|o>>>14,E^=(o=(x^=(o=($^=(o=(R^=(o=E+x|0)<<7|o>>>25)+E|0)<<9|o>>>23)+R|0)<<13|o>>>19)+$|0)<<18|o>>>14,T^=(o=(A^=(o=(k^=(o=(B^=(o=T+A|0)<<7|o>>>25)+T|0)<<9|o>>>23)+B|0)<<13|o>>>19)+k|0)<<18|o>>>14,M^=(o=(N^=(o=(P^=(o=(S^=(o=M+N|0)<<7|o>>>25)+M|0)<<9|o>>>23)+S|0)<<13|o>>>19)+P|0)<<18|o>>>14,_^=(o=(S^=(o=(k^=(o=(x^=(o=_+S|0)<<7|o>>>25)+_|0)<<9|o>>>23)+x|0)<<13|o>>>19)+k|0)<<18|o>>>14,E^=(o=(C^=(o=(P^=(o=(A^=(o=E+C|0)<<7|o>>>25)+E|0)<<9|o>>>23)+A|0)<<13|o>>>19)+P|0)<<18|o>>>14,T^=(o=(R^=(o=(I^=(o=(N^=(o=T+R|0)<<7|o>>>25)+T|0)<<9|o>>>23)+N|0)<<13|o>>>19)+I|0)<<18|o>>>14,M^=(o=(B^=(o=($^=(o=(D^=(o=M+B|0)<<7|o>>>25)+M|0)<<9|o>>>23)+D|0)<<13|o>>>19)+$|0)<<18|o>>>14;_=_+a|0,x=x+i|0,k=k+s|0,S=S+l|0,C=C+c|0,E=E+d|0,A=A+u|0,P=P+h|0,I=I+p|0,R=R+f|0,T=T+m|0,N=N+g|0,D=D+y|0,$=$+b|0,B=B+v|0,M=M+w|0,e[0]=_>>>0&255,e[1]=_>>>8&255,e[2]=_>>>16&255,e[3]=_>>>24&255,e[4]=x>>>0&255,e[5]=x>>>8&255,e[6]=x>>>16&255,e[7]=x>>>24&255,e[8]=k>>>0&255,e[9]=k>>>8&255,e[10]=k>>>16&255,e[11]=k>>>24&255,e[12]=S>>>0&255,e[13]=S>>>8&255,e[14]=S>>>16&255,e[15]=S>>>24&255,e[16]=C>>>0&255,e[17]=C>>>8&255,e[18]=C>>>16&255,e[19]=C>>>24&255,e[20]=E>>>0&255,e[21]=E>>>8&255,e[22]=E>>>16&255,e[23]=E>>>24&255,e[24]=A>>>0&255,e[25]=A>>>8&255,e[26]=A>>>16&255,e[27]=A>>>24&255,e[28]=P>>>0&255,e[29]=P>>>8&255,e[30]=P>>>16&255,e[31]=P>>>24&255,e[32]=I>>>0&255,e[33]=I>>>8&255,e[34]=I>>>16&255,e[35]=I>>>24&255,e[36]=R>>>0&255,e[37]=R>>>8&255,e[38]=R>>>16&255,e[39]=R>>>24&255,e[40]=T>>>0&255,e[41]=T>>>8&255,e[42]=T>>>16&255,e[43]=T>>>24&255,e[44]=N>>>0&255,e[45]=N>>>8&255,e[46]=N>>>16&255,e[47]=N>>>24&255,e[48]=D>>>0&255,e[49]=D>>>8&255,e[50]=D>>>16&255,e[51]=D>>>24&255,e[52]=$>>>0&255,e[53]=$>>>8&255,e[54]=$>>>16&255,e[55]=$>>>24&255,e[56]=B>>>0&255,e[57]=B>>>8&255,e[58]=B>>>16&255,e[59]=B>>>24&255,e[60]=M>>>0&255,e[61]=M>>>8&255,e[62]=M>>>16&255,e[63]=M>>>24&255}function v(e,t,r,n){for(var o,a=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,l=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,c=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,d=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,u=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,f=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,m=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,y=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,b=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,v=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,w=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,_=0;_<20;_+=2)a^=(o=(y^=(o=(p^=(o=(c^=(o=a+y|0)<<7|o>>>25)+a|0)<<9|o>>>23)+c|0)<<13|o>>>19)+p|0)<<18|o>>>14,d^=(o=(i^=(o=(b^=(o=(f^=(o=d+i|0)<<7|o>>>25)+d|0)<<9|o>>>23)+f|0)<<13|o>>>19)+b|0)<<18|o>>>14,m^=(o=(u^=(o=(s^=(o=(v^=(o=m+u|0)<<7|o>>>25)+m|0)<<9|o>>>23)+v|0)<<13|o>>>19)+s|0)<<18|o>>>14,w^=(o=(g^=(o=(h^=(o=(l^=(o=w+g|0)<<7|o>>>25)+w|0)<<9|o>>>23)+l|0)<<13|o>>>19)+h|0)<<18|o>>>14,a^=(o=(l^=(o=(s^=(o=(i^=(o=a+l|0)<<7|o>>>25)+a|0)<<9|o>>>23)+i|0)<<13|o>>>19)+s|0)<<18|o>>>14,d^=(o=(c^=(o=(h^=(o=(u^=(o=d+c|0)<<7|o>>>25)+d|0)<<9|o>>>23)+u|0)<<13|o>>>19)+h|0)<<18|o>>>14,m^=(o=(f^=(o=(p^=(o=(g^=(o=m+f|0)<<7|o>>>25)+m|0)<<9|o>>>23)+g|0)<<13|o>>>19)+p|0)<<18|o>>>14,w^=(o=(v^=(o=(b^=(o=(y^=(o=w+v|0)<<7|o>>>25)+w|0)<<9|o>>>23)+y|0)<<13|o>>>19)+b|0)<<18|o>>>14;e[0]=a>>>0&255,e[1]=a>>>8&255,e[2]=a>>>16&255,e[3]=a>>>24&255,e[4]=d>>>0&255,e[5]=d>>>8&255,e[6]=d>>>16&255,e[7]=d>>>24&255,e[8]=m>>>0&255,e[9]=m>>>8&255,e[10]=m>>>16&255,e[11]=m>>>24&255,e[12]=w>>>0&255,e[13]=w>>>8&255,e[14]=w>>>16&255,e[15]=w>>>24&255,e[16]=u>>>0&255,e[17]=u>>>8&255,e[18]=u>>>16&255,e[19]=u>>>24&255,e[20]=h>>>0&255,e[21]=h>>>8&255,e[22]=h>>>16&255,e[23]=h>>>24&255,e[24]=p>>>0&255,e[25]=p>>>8&255,e[26]=p>>>16&255,e[27]=p>>>24&255,e[28]=f>>>0&255,e[29]=f>>>8&255,e[30]=f>>>16&255,e[31]=f>>>24&255}function w(e,t,r,n){b(e,t,r,n)}function _(e,t,r,n){v(e,t,r,n)}l(f,"ts64"),l(m,"vn"),l(g,"crypto_verify_16"),l(y,"crypto_verify_32"),l(b,"core_salsa20"),l(v,"core_hsalsa20"),l(w,"crypto_core_salsa20"),l(_,"crypto_core_hsalsa20");var x=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function k(e,t,r,n,o,a,i){var s,l,c=new Uint8Array(16),d=new Uint8Array(64);for(l=0;l<16;l++)c[l]=0;for(l=0;l<8;l++)c[l]=a[l];for(;o>=64;){for(w(d,c,i,x),l=0;l<64;l++)e[t+l]=r[n+l]^d[l];for(s=1,l=8;l<16;l++)s=s+(255&c[l])|0,c[l]=255&s,s>>>=8;o-=64,t+=64,n+=64}if(o>0)for(w(d,c,i,x),l=0;l<o;l++)e[t+l]=r[n+l]^d[l];return 0}function S(e,t,r,n,o){var a,i,s=new Uint8Array(16),l=new Uint8Array(64);for(i=0;i<16;i++)s[i]=0;for(i=0;i<8;i++)s[i]=n[i];for(;r>=64;){for(w(l,s,o,x),i=0;i<64;i++)e[t+i]=l[i];for(a=1,i=8;i<16;i++)a=a+(255&s[i])|0,s[i]=255&a,a>>>=8;r-=64,t+=64}if(r>0)for(w(l,s,o,x),i=0;i<r;i++)e[t+i]=l[i];return 0}function C(e,t,r,n,o){var a=new Uint8Array(32);_(a,n,o,x);for(var i=new Uint8Array(8),s=0;s<8;s++)i[s]=n[s+16];return S(e,t,r,i,a)}function E(e,t,r,n,o,a,i){var s=new Uint8Array(32);_(s,a,i,x);for(var l=new Uint8Array(8),c=0;c<8;c++)l[c]=a[c+16];return k(e,t,r,n,o,l,s)}l(k,"crypto_stream_salsa20_xor"),l(S,"crypto_stream_salsa20"),l(C,"crypto_stream"),l(E,"crypto_stream_xor");var A=l((function(e){var t,r,n,o,a,i,s,l;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),o=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|o<<9),a=255&e[8]|(255&e[9])<<8,this.r[4]=255&(o>>>4|a<<12),this.r[5]=a>>>1&8190,i=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(a>>>14|i<<2),s=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(i>>>11|s<<5),l=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(s>>>8|l<<8),this.r[9]=l>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8}),"poly1305");function P(e,t,r,n,o,a){var i=new A(a);return i.update(r,n,o),i.finish(e,t),0}function I(e,t,r,n,o,a){var i=new Uint8Array(16);return P(i,0,r,n,o,a),g(e,t,i,0)}function R(e,t,r,n,o){var a;if(r<32)return-1;for(E(e,0,t,0,r,n,o),P(e,16,e,32,r-32,e),a=0;a<16;a++)e[a]=0;return 0}function T(e,t,r,n,o){var a,i=new Uint8Array(32);if(r<32||(C(i,0,32,n,o),0!==I(t,16,t,32,r-32,i)))return-1;for(E(e,0,t,0,r,n,o),a=0;a<32;a++)e[a]=0;return 0}function N(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function D(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function $(e,t,r){for(var n,o=~(r-1),a=0;a<16;a++)n=o&(e[a]^t[a]),e[a]^=n,t[a]^=n}function B(e,r){var n,o,a,i=t(),s=t();for(n=0;n<16;n++)s[n]=r[n];for(D(s),D(s),D(s),o=0;o<2;o++){for(i[0]=s[0]-65517,n=1;n<15;n++)i[n]=s[n]-65535-(i[n-1]>>16&1),i[n-1]&=65535;i[15]=s[15]-32767-(i[14]>>16&1),a=i[15]>>16&1,i[14]&=65535,$(s,i,1-a)}for(n=0;n<16;n++)e[2*n]=255&s[n],e[2*n+1]=s[n]>>8}function M(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return B(r,e),B(n,t),y(r,0,n,0)}function z(e){var t=new Uint8Array(32);return B(t,e),1&t[0]}function U(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function O(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function F(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function L(e,t,r){var n,o,a=0,i=0,s=0,l=0,c=0,d=0,u=0,h=0,p=0,f=0,m=0,g=0,y=0,b=0,v=0,w=0,_=0,x=0,k=0,S=0,C=0,E=0,A=0,P=0,I=0,R=0,T=0,N=0,D=0,$=0,B=0,M=r[0],z=r[1],U=r[2],O=r[3],F=r[4],L=r[5],W=r[6],H=r[7],j=r[8],J=r[9],V=r[10],K=r[11],q=r[12],G=r[13],Z=r[14],Q=r[15];a+=(n=t[0])*M,i+=n*z,s+=n*U,l+=n*O,c+=n*F,d+=n*L,u+=n*W,h+=n*H,p+=n*j,f+=n*J,m+=n*V,g+=n*K,y+=n*q,b+=n*G,v+=n*Z,w+=n*Q,i+=(n=t[1])*M,s+=n*z,l+=n*U,c+=n*O,d+=n*F,u+=n*L,h+=n*W,p+=n*H,f+=n*j,m+=n*J,g+=n*V,y+=n*K,b+=n*q,v+=n*G,w+=n*Z,_+=n*Q,s+=(n=t[2])*M,l+=n*z,c+=n*U,d+=n*O,u+=n*F,h+=n*L,p+=n*W,f+=n*H,m+=n*j,g+=n*J,y+=n*V,b+=n*K,v+=n*q,w+=n*G,_+=n*Z,x+=n*Q,l+=(n=t[3])*M,c+=n*z,d+=n*U,u+=n*O,h+=n*F,p+=n*L,f+=n*W,m+=n*H,g+=n*j,y+=n*J,b+=n*V,v+=n*K,w+=n*q,_+=n*G,x+=n*Z,k+=n*Q,c+=(n=t[4])*M,d+=n*z,u+=n*U,h+=n*O,p+=n*F,f+=n*L,m+=n*W,g+=n*H,y+=n*j,b+=n*J,v+=n*V,w+=n*K,_+=n*q,x+=n*G,k+=n*Z,S+=n*Q,d+=(n=t[5])*M,u+=n*z,h+=n*U,p+=n*O,f+=n*F,m+=n*L,g+=n*W,y+=n*H,b+=n*j,v+=n*J,w+=n*V,_+=n*K,x+=n*q,k+=n*G,S+=n*Z,C+=n*Q,u+=(n=t[6])*M,h+=n*z,p+=n*U,f+=n*O,m+=n*F,g+=n*L,y+=n*W,b+=n*H,v+=n*j,w+=n*J,_+=n*V,x+=n*K,k+=n*q,S+=n*G,C+=n*Z,E+=n*Q,h+=(n=t[7])*M,p+=n*z,f+=n*U,m+=n*O,g+=n*F,y+=n*L,b+=n*W,v+=n*H,w+=n*j,_+=n*J,x+=n*V,k+=n*K,S+=n*q,C+=n*G,E+=n*Z,A+=n*Q,p+=(n=t[8])*M,f+=n*z,m+=n*U,g+=n*O,y+=n*F,b+=n*L,v+=n*W,w+=n*H,_+=n*j,x+=n*J,k+=n*V,S+=n*K,C+=n*q,E+=n*G,A+=n*Z,P+=n*Q,f+=(n=t[9])*M,m+=n*z,g+=n*U,y+=n*O,b+=n*F,v+=n*L,w+=n*W,_+=n*H,x+=n*j,k+=n*J,S+=n*V,C+=n*K,E+=n*q,A+=n*G,P+=n*Z,I+=n*Q,m+=(n=t[10])*M,g+=n*z,y+=n*U,b+=n*O,v+=n*F,w+=n*L,_+=n*W,x+=n*H,k+=n*j,S+=n*J,C+=n*V,E+=n*K,A+=n*q,P+=n*G,I+=n*Z,R+=n*Q,g+=(n=t[11])*M,y+=n*z,b+=n*U,v+=n*O,w+=n*F,_+=n*L,x+=n*W,k+=n*H,S+=n*j,C+=n*J,E+=n*V,A+=n*K,P+=n*q,I+=n*G,R+=n*Z,T+=n*Q,y+=(n=t[12])*M,b+=n*z,v+=n*U,w+=n*O,_+=n*F,x+=n*L,k+=n*W,S+=n*H,C+=n*j,E+=n*J,A+=n*V,P+=n*K,I+=n*q,R+=n*G,T+=n*Z,N+=n*Q,b+=(n=t[13])*M,v+=n*z,w+=n*U,_+=n*O,x+=n*F,k+=n*L,S+=n*W,C+=n*H,E+=n*j,A+=n*J,P+=n*V,I+=n*K,R+=n*q,T+=n*G,N+=n*Z,D+=n*Q,v+=(n=t[14])*M,w+=n*z,_+=n*U,x+=n*O,k+=n*F,S+=n*L,C+=n*W,E+=n*H,A+=n*j,P+=n*J,I+=n*V,R+=n*K,T+=n*q,N+=n*G,D+=n*Z,$+=n*Q,w+=(n=t[15])*M,i+=38*(x+=n*U),s+=38*(k+=n*O),l+=38*(S+=n*F),c+=38*(C+=n*L),d+=38*(E+=n*W),u+=38*(A+=n*H),h+=38*(P+=n*j),p+=38*(I+=n*J),f+=38*(R+=n*V),m+=38*(T+=n*K),g+=38*(N+=n*q),y+=38*(D+=n*G),b+=38*($+=n*Z),v+=38*(B+=n*Q),a=(n=(a+=38*(_+=n*z))+(o=1)+65535)-65536*(o=Math.floor(n/65536)),i=(n=i+o+65535)-65536*(o=Math.floor(n/65536)),s=(n=s+o+65535)-65536*(o=Math.floor(n/65536)),l=(n=l+o+65535)-65536*(o=Math.floor(n/65536)),c=(n=c+o+65535)-65536*(o=Math.floor(n/65536)),d=(n=d+o+65535)-65536*(o=Math.floor(n/65536)),u=(n=u+o+65535)-65536*(o=Math.floor(n/65536)),h=(n=h+o+65535)-65536*(o=Math.floor(n/65536)),p=(n=p+o+65535)-65536*(o=Math.floor(n/65536)),f=(n=f+o+65535)-65536*(o=Math.floor(n/65536)),m=(n=m+o+65535)-65536*(o=Math.floor(n/65536)),g=(n=g+o+65535)-65536*(o=Math.floor(n/65536)),y=(n=y+o+65535)-65536*(o=Math.floor(n/65536)),b=(n=b+o+65535)-65536*(o=Math.floor(n/65536)),v=(n=v+o+65535)-65536*(o=Math.floor(n/65536)),w=(n=w+o+65535)-65536*(o=Math.floor(n/65536)),a=(n=(a+=o-1+37*(o-1))+(o=1)+65535)-65536*(o=Math.floor(n/65536)),i=(n=i+o+65535)-65536*(o=Math.floor(n/65536)),s=(n=s+o+65535)-65536*(o=Math.floor(n/65536)),l=(n=l+o+65535)-65536*(o=Math.floor(n/65536)),c=(n=c+o+65535)-65536*(o=Math.floor(n/65536)),d=(n=d+o+65535)-65536*(o=Math.floor(n/65536)),u=(n=u+o+65535)-65536*(o=Math.floor(n/65536)),h=(n=h+o+65535)-65536*(o=Math.floor(n/65536)),p=(n=p+o+65535)-65536*(o=Math.floor(n/65536)),f=(n=f+o+65535)-65536*(o=Math.floor(n/65536)),m=(n=m+o+65535)-65536*(o=Math.floor(n/65536)),g=(n=g+o+65535)-65536*(o=Math.floor(n/65536)),y=(n=y+o+65535)-65536*(o=Math.floor(n/65536)),b=(n=b+o+65535)-65536*(o=Math.floor(n/65536)),v=(n=v+o+65535)-65536*(o=Math.floor(n/65536)),w=(n=w+o+65535)-65536*(o=Math.floor(n/65536)),a+=o-1+37*(o-1),e[0]=a,e[1]=i,e[2]=s,e[3]=l,e[4]=c,e[5]=d,e[6]=u,e[7]=h,e[8]=p,e[9]=f,e[10]=m,e[11]=g,e[12]=y,e[13]=b,e[14]=v,e[15]=w}function W(e,t){L(e,t,t)}function H(e,r){var n,o=t();for(n=0;n<16;n++)o[n]=r[n];for(n=253;n>=0;n--)W(o,o),2!==n&&4!==n&&L(o,o,r);for(n=0;n<16;n++)e[n]=o[n]}function j(e,r){var n,o=t();for(n=0;n<16;n++)o[n]=r[n];for(n=250;n>=0;n--)W(o,o),1!==n&&L(o,o,r);for(n=0;n<16;n++)e[n]=o[n]}function J(e,r,n){var o,a,i=new Uint8Array(32),l=new Float64Array(80),c=t(),d=t(),u=t(),h=t(),p=t(),f=t();for(a=0;a<31;a++)i[a]=r[a];for(i[31]=127&r[31]|64,i[0]&=248,U(l,n),a=0;a<16;a++)d[a]=l[a],h[a]=c[a]=u[a]=0;for(c[0]=h[0]=1,a=254;a>=0;--a)$(c,d,o=i[a>>>3]>>>(7&a)&1),$(u,h,o),O(p,c,u),F(c,c,u),O(u,d,h),F(d,d,h),W(h,p),W(f,c),L(c,u,c),L(u,d,p),O(p,c,u),F(c,c,u),W(d,c),F(u,h,f),L(c,u,s),O(c,c,h),L(u,u,c),L(c,h,f),L(h,d,l),W(d,p),$(c,d,o),$(u,h,o);for(a=0;a<16;a++)l[a+16]=c[a],l[a+32]=u[a],l[a+48]=d[a],l[a+64]=h[a];var m=l.subarray(32),g=l.subarray(16);return H(m,m),L(g,g,m),B(e,g),0}function V(e,t){return J(e,t,o)}function K(e,t){return r(t,32),V(e,t)}function q(e,t,r){var o=new Uint8Array(32);return J(o,r,t),_(e,n,o,x)}A.prototype.blocks=function(e,t,r){for(var n,o,a,i,s,l,c,d,u,h,p,f,m,g,y,b,v,w,_,x=this.fin?0:2048,k=this.h[0],S=this.h[1],C=this.h[2],E=this.h[3],A=this.h[4],P=this.h[5],I=this.h[6],R=this.h[7],T=this.h[8],N=this.h[9],D=this.r[0],$=this.r[1],B=this.r[2],M=this.r[3],z=this.r[4],U=this.r[5],O=this.r[6],F=this.r[7],L=this.r[8],W=this.r[9];r>=16;)h=u=0,h+=(k+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*D,h+=(S+=8191&(n>>>13|(o=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*W),h+=(C+=8191&(o>>>10|(a=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*L),h+=(E+=8191&(a>>>7|(i=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*F),u=(h+=(A+=8191&(i>>>4|(s=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*O))>>>13,h&=8191,h+=(P+=s>>>1&8191)*(5*U),h+=(I+=8191&(s>>>14|(l=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*z),h+=(R+=8191&(l>>>11|(c=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*M),h+=(T+=8191&(c>>>8|(d=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*B),p=u+=(h+=(N+=d>>>5|x)*(5*$))>>>13,p+=k*$,p+=S*D,p+=C*(5*W),p+=E*(5*L),u=(p+=A*(5*F))>>>13,p&=8191,p+=P*(5*O),p+=I*(5*U),p+=R*(5*z),p+=T*(5*M),u+=(p+=N*(5*B))>>>13,p&=8191,f=u,f+=k*B,f+=S*$,f+=C*D,f+=E*(5*W),u=(f+=A*(5*L))>>>13,f&=8191,f+=P*(5*F),f+=I*(5*O),f+=R*(5*U),f+=T*(5*z),m=u+=(f+=N*(5*M))>>>13,m+=k*M,m+=S*B,m+=C*$,m+=E*D,u=(m+=A*(5*W))>>>13,m&=8191,m+=P*(5*L),m+=I*(5*F),m+=R*(5*O),m+=T*(5*U),g=u+=(m+=N*(5*z))>>>13,g+=k*z,g+=S*M,g+=C*B,g+=E*$,u=(g+=A*D)>>>13,g&=8191,g+=P*(5*W),g+=I*(5*L),g+=R*(5*F),g+=T*(5*O),y=u+=(g+=N*(5*U))>>>13,y+=k*U,y+=S*z,y+=C*M,y+=E*B,u=(y+=A*$)>>>13,y&=8191,y+=P*D,y+=I*(5*W),y+=R*(5*L),y+=T*(5*F),b=u+=(y+=N*(5*O))>>>13,b+=k*O,b+=S*U,b+=C*z,b+=E*M,u=(b+=A*B)>>>13,b&=8191,b+=P*$,b+=I*D,b+=R*(5*W),b+=T*(5*L),v=u+=(b+=N*(5*F))>>>13,v+=k*F,v+=S*O,v+=C*U,v+=E*z,u=(v+=A*M)>>>13,v&=8191,v+=P*B,v+=I*$,v+=R*D,v+=T*(5*W),w=u+=(v+=N*(5*L))>>>13,w+=k*L,w+=S*F,w+=C*O,w+=E*U,u=(w+=A*z)>>>13,w&=8191,w+=P*M,w+=I*B,w+=R*$,w+=T*D,_=u+=(w+=N*(5*W))>>>13,_+=k*W,_+=S*L,_+=C*F,_+=E*O,u=(_+=A*U)>>>13,_&=8191,_+=P*z,_+=I*M,_+=R*B,_+=T*$,k=h=8191&(u=(u=((u+=(_+=N*D)>>>13)<<2)+u|0)+(h&=8191)|0),S=p+=u>>>=13,C=f&=8191,E=m&=8191,A=g&=8191,P=y&=8191,I=b&=8191,R=v&=8191,T=w&=8191,N=_&=8191,t+=16,r-=16;this.h[0]=k,this.h[1]=S,this.h[2]=C,this.h[3]=E,this.h[4]=A,this.h[5]=P,this.h[6]=I,this.h[7]=R,this.h[8]=T,this.h[9]=N},A.prototype.finish=function(e,t){var r,n,o,a,i=new Uint16Array(10);if(this.leftover){for(a=this.leftover,this.buffer[a++]=1;a<16;a++)this.buffer[a]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,a=2;a<10;a++)this.h[a]+=r,r=this.h[a]>>>13,this.h[a]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,i[0]=this.h[0]+5,r=i[0]>>>13,i[0]&=8191,a=1;a<10;a++)i[a]=this.h[a]+r,r=i[a]>>>13,i[a]&=8191;for(i[9]-=8192,n=(1^r)-1,a=0;a<10;a++)i[a]&=n;for(n=~n,a=0;a<10;a++)this.h[a]=this.h[a]&n|i[a];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),o=this.h[0]+this.pad[0],this.h[0]=65535&o,a=1;a<8;a++)o=(this.h[a]+this.pad[a]|0)+(o>>>16)|0,this.h[a]=65535&o;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},A.prototype.update=function(e,t,r){var n,o;if(this.leftover){for((o=16-this.leftover)>r&&(o=r),n=0;n<o;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=o,t+=o,this.leftover+=o,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(o=r-r%16,this.blocks(e,t,o),t+=o,r-=o),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}},l(P,"crypto_onetimeauth"),l(I,"crypto_onetimeauth_verify"),l(R,"crypto_secretbox"),l(T,"crypto_secretbox_open"),l(N,"set25519"),l(D,"car25519"),l($,"sel25519"),l(B,"pack25519"),l(M,"neq25519"),l(z,"par25519"),l(U,"unpack25519"),l(O,"A"),l(F,"Z"),l(L,"M"),l(W,"S"),l(H,"inv25519"),l(j,"pow2523"),l(J,"crypto_scalarmult"),l(V,"crypto_scalarmult_base"),l(K,"crypto_box_keypair"),l(q,"crypto_box_beforenm");var G=R,Z=T;function Q(e,t,r,n,o,a){var i=new Uint8Array(32);return q(i,o,a),G(e,t,r,n,i)}function X(e,t,r,n,o,a){var i=new Uint8Array(32);return q(i,o,a),Z(e,t,r,n,i)}l(Q,"crypto_box"),l(X,"crypto_box_open");var Y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function ee(e,t,r,n){for(var o,a,i,s,l,c,d,u,h,p,f,m,g,y,b,v,w,_,x,k,S,C,E,A,P,I,R=new Int32Array(16),T=new Int32Array(16),N=e[0],D=e[1],$=e[2],B=e[3],M=e[4],z=e[5],U=e[6],O=e[7],F=t[0],L=t[1],W=t[2],H=t[3],j=t[4],J=t[5],V=t[6],K=t[7],q=0;n>=128;){for(x=0;x<16;x++)k=8*x+q,R[x]=r[k+0]<<24|r[k+1]<<16|r[k+2]<<8|r[k+3],T[x]=r[k+4]<<24|r[k+5]<<16|r[k+6]<<8|r[k+7];for(x=0;x<80;x++)if(o=N,a=D,i=$,s=B,l=M,c=z,d=U,O,h=F,p=L,f=W,m=H,g=j,y=J,b=V,K,E=65535&(C=K),A=C>>>16,P=65535&(S=O),I=S>>>16,E+=65535&(C=(j>>>14|M<<18)^(j>>>18|M<<14)^(M>>>9|j<<23)),A+=C>>>16,P+=65535&(S=(M>>>14|j<<18)^(M>>>18|j<<14)^(j>>>9|M<<23)),I+=S>>>16,E+=65535&(C=j&J^~j&V),A+=C>>>16,P+=65535&(S=M&z^~M&U),I+=S>>>16,E+=65535&(C=Y[2*x+1]),A+=C>>>16,P+=65535&(S=Y[2*x]),I+=S>>>16,S=R[x%16],A+=(C=T[x%16])>>>16,P+=65535&S,I+=S>>>16,P+=(A+=(E+=65535&C)>>>16)>>>16,E=65535&(C=_=65535&E|A<<16),A=C>>>16,P=65535&(S=w=65535&P|(I+=P>>>16)<<16),I=S>>>16,E+=65535&(C=(F>>>28|N<<4)^(N>>>2|F<<30)^(N>>>7|F<<25)),A+=C>>>16,P+=65535&(S=(N>>>28|F<<4)^(F>>>2|N<<30)^(F>>>7|N<<25)),I+=S>>>16,A+=(C=F&L^F&W^L&W)>>>16,P+=65535&(S=N&D^N&$^D&$),I+=S>>>16,u=65535&(P+=(A+=(E+=65535&C)>>>16)>>>16)|(I+=P>>>16)<<16,v=65535&E|A<<16,E=65535&(C=m),A=C>>>16,P=65535&(S=s),I=S>>>16,A+=(C=_)>>>16,P+=65535&(S=w),I+=S>>>16,D=o,$=a,B=i,M=s=65535&(P+=(A+=(E+=65535&C)>>>16)>>>16)|(I+=P>>>16)<<16,z=l,U=c,O=d,N=u,L=h,W=p,H=f,j=m=65535&E|A<<16,J=g,V=y,K=b,F=v,x%16==15)for(k=0;k<16;k++)S=R[k],E=65535&(C=T[k]),A=C>>>16,P=65535&S,I=S>>>16,S=R[(k+9)%16],E+=65535&(C=T[(k+9)%16]),A+=C>>>16,P+=65535&S,I+=S>>>16,w=R[(k+1)%16],E+=65535&(C=((_=T[(k+1)%16])>>>1|w<<31)^(_>>>8|w<<24)^(_>>>7|w<<25)),A+=C>>>16,P+=65535&(S=(w>>>1|_<<31)^(w>>>8|_<<24)^w>>>7),I+=S>>>16,w=R[(k+14)%16],A+=(C=((_=T[(k+14)%16])>>>19|w<<13)^(w>>>29|_<<3)^(_>>>6|w<<26))>>>16,P+=65535&(S=(w>>>19|_<<13)^(_>>>29|w<<3)^w>>>6),I+=S>>>16,I+=(P+=(A+=(E+=65535&C)>>>16)>>>16)>>>16,R[k]=65535&P|I<<16,T[k]=65535&E|A<<16;E=65535&(C=F),A=C>>>16,P=65535&(S=N),I=S>>>16,S=e[0],A+=(C=t[0])>>>16,P+=65535&S,I+=S>>>16,I+=(P+=(A+=(E+=65535&C)>>>16)>>>16)>>>16,e[0]=N=65535&P|I<<16,t[0]=F=65535&E|A<<16,E=65535&(C=L),A=C>>>16,P=65535&(S=D),I=S>>>16,S=e[1],A+=(C=t[1])>>>16,P+=65535&S,I+=S>>>16,I+=(P+=(A+=(E+=65535&C)>>>16)>>>16)>>>16,e[1]=D=65535&P|I<<16,t[1]=L=65535&E|A<<16,E=65535&(C=W),A=C>>>16,P=65535&(S=$),I=S>>>16,S=e[2],A+=(C=t[2])>>>16,P+=65535&S,I+=S>>>16,I+=(P+=(A+=(E+=65535&C)>>>16)>>>16)>>>16,e[2]=$=65535&P|I<<16,t[2]=W=65535&E|A<<16,E=65535&(C=H),A=C>>>16,P=65535&(S=B),I=S>>>16,S=e[3],A+=(C=t[3])>>>16,P+=65535&S,I+=S>>>16,I+=(P+=(A+=(E+=65535&C)>>>16)>>>16)>>>16,e[3]=B=65535&P|I<<16,t[3]=H=65535&E|A<<16,E=65535&(C=j),A=C>>>16,P=65535&(S=M),I=S>>>16,S=e[4],A+=(C=t[4])>>>16,P+=65535&S,I+=S>>>16,I+=(P+=(A+=(E+=65535&C)>>>16)>>>16)>>>16,e[4]=M=65535&P|I<<16,t[4]=j=65535&E|A<<16,E=65535&(C=J),A=C>>>16,P=65535&(S=z),I=S>>>16,S=e[5],A+=(C=t[5])>>>16,P+=65535&S,I+=S>>>16,I+=(P+=(A+=(E+=65535&C)>>>16)>>>16)>>>16,e[5]=z=65535&P|I<<16,t[5]=J=65535&E|A<<16,E=65535&(C=V),A=C>>>16,P=65535&(S=U),I=S>>>16,S=e[6],A+=(C=t[6])>>>16,P+=65535&S,I+=S>>>16,I+=(P+=(A+=(E+=65535&C)>>>16)>>>16)>>>16,e[6]=U=65535&P|I<<16,t[6]=V=65535&E|A<<16,E=65535&(C=K),A=C>>>16,P=65535&(S=O),I=S>>>16,S=e[7],A+=(C=t[7])>>>16,P+=65535&S,I+=S>>>16,I+=(P+=(A+=(E+=65535&C)>>>16)>>>16)>>>16,e[7]=O=65535&P|I<<16,t[7]=K=65535&E|A<<16,q+=128,n-=128}return n}function te(e,t,r){var n,o=new Int32Array(8),a=new Int32Array(8),i=new Uint8Array(256),s=r;for(o[0]=1779033703,o[1]=3144134277,o[2]=1013904242,o[3]=2773480762,o[4]=1359893119,o[5]=2600822924,o[6]=528734635,o[7]=1541459225,a[0]=4089235720,a[1]=2227873595,a[2]=4271175723,a[3]=1595750129,a[4]=2917565137,a[5]=725511199,a[6]=4215389547,a[7]=327033209,ee(o,a,t,r),r%=128,n=0;n<r;n++)i[n]=t[s-r+n];for(i[r]=128,i[(r=256-128*(r<112?1:0))-9]=0,f(i,r-8,s/536870912|0,s<<3),ee(o,a,i,r),n=0;n<8;n++)f(e,8*n,o[n],a[n]);return 0}function re(e,r){var n=t(),o=t(),a=t(),i=t(),s=t(),l=t(),c=t(),u=t(),h=t();F(n,e[1],e[0]),F(h,r[1],r[0]),L(n,n,h),O(o,e[0],e[1]),O(h,r[0],r[1]),L(o,o,h),L(a,e[3],r[3]),L(a,a,d),L(i,e[2],r[2]),O(i,i,i),F(s,o,n),F(l,i,a),O(c,i,a),O(u,o,n),L(e[0],s,l),L(e[1],u,c),L(e[2],c,l),L(e[3],s,u)}function ne(e,t,r){var n;for(n=0;n<4;n++)$(e[n],t[n],r)}function oe(e,r){var n=t(),o=t(),a=t();H(a,r[2]),L(n,r[0],a),L(o,r[1],a),B(e,o),e[31]^=z(n)<<7}function ae(e,t,r){var n,o;for(N(e[0],a),N(e[1],i),N(e[2],i),N(e[3],a),o=255;o>=0;--o)ne(e,t,n=r[o/8|0]>>(7&o)&1),re(t,e),re(e,e),ne(e,t,n)}function ie(e,r){var n=[t(),t(),t(),t()];N(n[0],u),N(n[1],h),N(n[2],i),L(n[3],u,h),ae(e,n,r)}function se(e,n,o){var a,i=new Uint8Array(64),s=[t(),t(),t(),t()];for(o||r(n,32),te(i,n,32),i[0]&=248,i[31]&=127,i[31]|=64,ie(s,i),oe(e,s),a=0;a<32;a++)n[a+32]=e[a];return 0}l(ee,"crypto_hashblocks_hl"),l(te,"crypto_hash"),l(re,"add"),l(ne,"cswap"),l(oe,"pack"),l(ae,"scalarmult"),l(ie,"scalarbase"),l(se,"crypto_sign_keypair");var le=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ce(e,t){var r,n,o,a;for(n=63;n>=32;--n){for(r=0,o=n-32,a=n-12;o<a;++o)t[o]+=r-16*t[n]*le[o-(n-32)],r=Math.floor((t[o]+128)/256),t[o]-=256*r;t[o]+=r,t[n]=0}for(r=0,o=0;o<32;o++)t[o]+=r-(t[31]>>4)*le[o],r=t[o]>>8,t[o]&=255;for(o=0;o<32;o++)t[o]-=r*le[o];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function de(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;ce(e,r)}function ue(e,r,n,o){var a,i,s=new Uint8Array(64),l=new Uint8Array(64),c=new Uint8Array(64),d=new Float64Array(64),u=[t(),t(),t(),t()];te(s,o,32),s[0]&=248,s[31]&=127,s[31]|=64;var h=n+64;for(a=0;a<n;a++)e[64+a]=r[a];for(a=0;a<32;a++)e[32+a]=s[32+a];for(te(c,e.subarray(32),n+32),de(c),ie(u,c),oe(e,u),a=32;a<64;a++)e[a]=o[a];for(te(l,e,n+64),de(l),a=0;a<64;a++)d[a]=0;for(a=0;a<32;a++)d[a]=c[a];for(a=0;a<32;a++)for(i=0;i<32;i++)d[a+i]+=l[a]*s[i];return ce(e.subarray(32),d),h}function he(e,r){var n=t(),o=t(),s=t(),l=t(),d=t(),u=t(),h=t();return N(e[2],i),U(e[1],r),W(s,e[1]),L(l,s,c),F(s,s,e[2]),O(l,e[2],l),W(d,l),W(u,d),L(h,u,d),L(n,h,s),L(n,n,l),j(n,n),L(n,n,s),L(n,n,l),L(n,n,l),L(e[0],n,l),W(o,e[0]),L(o,o,l),M(o,s)&&L(e[0],e[0],p),W(o,e[0]),L(o,o,l),M(o,s)?-1:(z(e[0])===r[31]>>7&&F(e[0],a,e[0]),L(e[3],e[0],e[1]),0)}function pe(e,r,n,o){var a,i=new Uint8Array(32),s=new Uint8Array(64),l=[t(),t(),t(),t()],c=[t(),t(),t(),t()];if(n<64||he(c,o))return-1;for(a=0;a<n;a++)e[a]=r[a];for(a=0;a<32;a++)e[a+32]=o[a];if(te(s,e,n),de(s),ae(l,c,s),ie(c,r.subarray(32)),re(l,c),oe(i,l),n-=64,y(r,0,i,0)){for(a=0;a<n;a++)e[a]=0;return-1}for(a=0;a<n;a++)e[a]=r[a+64];return n}l(ce,"modL"),l(de,"reduce"),l(ue,"crypto_sign"),l(he,"unpackneg"),l(pe,"crypto_sign_open");var fe=16,me=64,ge=32,ye=64;function be(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function ve(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}function we(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function _e(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:_,crypto_stream_xor:E,crypto_stream:C,crypto_stream_salsa20_xor:k,crypto_stream_salsa20:S,crypto_onetimeauth:P,crypto_onetimeauth_verify:I,crypto_verify_16:g,crypto_verify_32:y,crypto_secretbox:R,crypto_secretbox_open:T,crypto_scalarmult:J,crypto_scalarmult_base:V,crypto_box_beforenm:q,crypto_box_afternm:G,crypto_box:Q,crypto_box_open:X,crypto_box_keypair:K,crypto_hash:te,crypto_sign:ue,crypto_sign_keypair:se,crypto_sign_open:pe,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:fe,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:me,crypto_sign_PUBLICKEYBYTES:ge,crypto_sign_SECRETKEYBYTES:ye,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:c,L:le,pack25519:B,unpack25519:U,M:L,A:O,S:W,Z:F,pow2523:j,add:re,set25519:N,modL:ce,scalarmult:ae,scalarbase:ie},l(be,"checkLengths"),l(ve,"checkBoxLengths"),l(we,"checkArrayTypes"),l(_e,"cleanup"),e.randomBytes=function(e){var t=new Uint8Array(e);return r(t,e),t},e.secretbox=function(e,t,r){we(e,t,r),be(r,t);for(var n=new Uint8Array(32+e.length),o=new Uint8Array(n.length),a=0;a<e.length;a++)n[a+32]=e[a];return R(o,n,n.length,t,r),o.subarray(fe)},e.secretbox.open=function(e,t,r){we(e,t,r),be(r,t);for(var n=new Uint8Array(fe+e.length),o=new Uint8Array(n.length),a=0;a<e.length;a++)n[a+fe]=e[a];return n.length<32||0!==T(o,n,n.length,t,r)?null:o.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=fe,e.scalarMult=function(e,t){if(we(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return J(r,e,t),r},e.scalarMult.base=function(e){if(we(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return V(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,n,o){var a=e.box.before(n,o);return e.secretbox(t,r,a)},e.box.before=function(e,t){we(e,t),ve(e,t);var r=new Uint8Array(32);return q(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,n,o){var a=e.box.before(n,o);return e.secretbox.open(t,r,a)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return K(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(we(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return V(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(we(e,t),t.length!==ye)throw new Error("bad secret key size");var r=new Uint8Array(me+e.length);return ue(r,e,e.length,t),r},e.sign.open=function(e,t){if(we(e,t),t.length!==ge)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=pe(r,e,e.length,t);if(n<0)return null;for(var o=new Uint8Array(n),a=0;a<o.length;a++)o[a]=r[a];return o},e.sign.detached=function(t,r){for(var n=e.sign(t,r),o=new Uint8Array(me),a=0;a<o.length;a++)o[a]=n[a];return o},e.sign.detached.verify=function(e,t,r){if(we(e,t,r),t.length!==me)throw new Error("bad signature size");if(r.length!==ge)throw new Error("bad public key size");var n,o=new Uint8Array(me+e.length),a=new Uint8Array(me+e.length);for(n=0;n<me;n++)o[n]=t[n];for(n=0;n<e.length;n++)o[n+me]=e[n];return pe(a,o,o.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(ge),t=new Uint8Array(ye);return se(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(we(e),e.length!==ye)throw new Error("bad secret key size");for(var t=new Uint8Array(ge),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(we(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(ge),r=new Uint8Array(ye),n=0;n<32;n++)r[n]=e[n];return se(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=ge,e.sign.secretKeyLength=ye,e.sign.seedLength=32,e.sign.signatureLength=me,e.hash=function(e){we(e);var t=new Uint8Array(64);return te(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return we(e,t),0!==e.length&&0!==t.length&&e.length===t.length&&0===m(e,0,t,0,e.length)},e.setPRNG=function(e){r=e},function(){var t=typeof self<"u"?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){e.setPRNG((function(e,r){var n,o=new Uint8Array(r);for(n=0;n<r;n+=65536)t.getRandomValues(o.subarray(n,n+Math.min(r-n,65536)));for(n=0;n<r;n++)e[n]=o[n];_e(o)}))}else typeof Ve<"u"&&((t=to())&&t.randomBytes&&e.setPRNG((function(e,r){var n,o=t.randomBytes(r);for(n=0;n<r;n++)e[n]=o[n];_e(o)})))}()}(typeof t<"u"&&t.exports?t.exports:self.nacl=self.nacl||{})})),Mo=lr(((e,t)=>{!function(r){"object"==typeof e&&typeof t<"u"?t.exports=r():"function"==typeof define&&define.amd?define([],r):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).JSZip=r()}((function(){return l((function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var l="function"==typeof Ve&&Ve;if(!s&&l)return l(i,!0);if(a)return a(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[i]={exports:{}};t[i][0].call(d.exports,(function(e){return o(t[i][1][e]||e)}),d,d.exports,e,t,r,n)}return r[i].exports}l(o,"u");for(var a="function"==typeof Ve&&Ve,i=0;i<n.length;i++)o(n[i]);return o}),"s")({1:[function(e,t,r){"use strict";var n=e("./utils"),o=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,o,i,s,l,c,d=[],u=0,h=e.length,p=h,f="string"!==n.getTypeOf(e);u<e.length;)p=h-u,o=f?(t=e[u++],r=u<h?e[u++]:0,u<h?e[u++]:0):(t=e.charCodeAt(u++),r=u<h?e.charCodeAt(u++):0,u<h?e.charCodeAt(u++):0),i=t>>2,s=(3&t)<<4|r>>4,l=1<p?(15&r)<<2|o>>6:64,c=2<p?63&o:64,d.push(a.charAt(i)+a.charAt(s)+a.charAt(l)+a.charAt(c));return d.join("")},r.decode=function(e){var t,r,n,i,s,l,c=0,d=0,u="data:";if(e.substr(0,5)===u)throw new Error("Invalid base64 input, it looks like a data url.");var h,p=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&p--,e.charAt(e.length-2)===a.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=o.uint8array?new Uint8Array(0|p):new Array(0|p);c<e.length;)t=a.indexOf(e.charAt(c++))<<2|(i=a.indexOf(e.charAt(c++)))>>4,r=(15&i)<<4|(s=a.indexOf(e.charAt(c++)))>>2,n=(3&s)<<6|(l=a.indexOf(e.charAt(c++))),h[d++]=t,64!==s&&(h[d++]=r),64!==l&&(h[d++]=n);return h}},{"./support":30,"./utils":32}],2:[function(e,t,r){"use strict";var n=e("./external"),o=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),i=e("./stream/DataLengthProbe");function s(e,t,r,n,o){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=o}l(s,"o"),s.prototype={getContentWorker:l((function(){var e=new o(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new i("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e}),"getContentWorker"),getCompressedWorker:l((function(){return new o(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}),"getCompressedWorker")},s.createWorkerFrom=function(e,t,r){return e.pipe(new a).pipe(new i("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new i("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){"use strict";var n=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:l((function(){return new n("STORE compression")}),"compressWorker"),uncompressWorker:l((function(){return new n("STORE decompression")}),"uncompressWorker")},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){"use strict";var n=e("./utils"),o=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==n.getTypeOf(e)?function(e,t,r){var n=o,a=0+r;e^=-1;for(var i=0;i<a;i++)e=e>>>8^n[255&(e^t[i])];return~e}(0|t,e,e.length):function(e,t,r){var n=o,a=0+r;e^=-1;for(var i=0;i<a;i++)e=e>>>8^n[255&(e^t.charCodeAt(i))];return~e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){"use strict";var n;n=typeof Promise<"u"?Promise:e("lie"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,r){"use strict";var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),a=e("./utils"),i=e("./stream/GenericWorker"),s=n?"uint8array":"array";function c(e,t){i.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}l(c,"h"),r.magic="\b\0",a.inherits(c,i),c.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(s,e.data),!1)},c.prototype.flush=function(){i.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},r.compressWorker=function(e){return new c("Deflate",e)},r.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,r){"use strict";function n(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function o(e,t,r,o,i,l){var u,h,p=e.file,f=e.compression,m=l!==s.utf8encode,g=a.transformTo("string",l(p.name)),y=a.transformTo("string",s.utf8encode(p.name)),b=p.comment,v=a.transformTo("string",l(b)),w=a.transformTo("string",s.utf8encode(b)),_=y.length!==p.name.length,x=w.length!==b.length,k="",S="",C="",E=p.dir,A=p.date,P={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(P.crc32=e.crc32,P.compressedSize=e.compressedSize,P.uncompressedSize=e.uncompressedSize);var I=0;t&&(I|=8),m||!_&&!x||(I|=2048);var R,T,N,D=0,$=0;E&&(D|=16),"UNIX"===i?($=798,D|=(R=p.unixPermissions,T=E,N=R,R||(N=T?16893:33204),(65535&N)<<16)):($=20,D|=function(e){return 63&(e||0)}(p.dosPermissions)),u=A.getUTCHours(),u<<=6,u|=A.getUTCMinutes(),u<<=5,u|=A.getUTCSeconds()/2,h=A.getUTCFullYear()-1980,h<<=4,h|=A.getUTCMonth()+1,h<<=5,h|=A.getUTCDate(),_&&(S=n(1,1)+n(c(g),4)+y,k+="up"+n(S.length,2)+S),x&&(C=n(1,1)+n(c(v),4)+w,k+="uc"+n(C.length,2)+C);var B="";return B+="\n\0",B+=n(I,2),B+=f.magic,B+=n(u,2),B+=n(h,2),B+=n(P.crc32,4),B+=n(P.compressedSize,4),B+=n(P.uncompressedSize,4),B+=n(g.length,2),B+=n(k.length,2),{fileRecord:d.LOCAL_FILE_HEADER+B+g+k,dirRecord:d.CENTRAL_FILE_HEADER+n($,2)+B+n(v.length,2)+"\0\0\0\0"+n(D,4)+n(o,4)+g+k+v}}l(n,"A"),l(o,"n");var a=e("../utils"),i=e("../stream/GenericWorker"),s=e("../utf8"),c=e("../crc32"),d=e("../signature");function u(e,t,r,n){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l(u,"s"),a.inherits(u,i),u.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,i.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=o(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t,r=this.streamFiles&&!e.file.dir,a=o(e,r,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(a.dirRecord),r)this.push({data:(t=e,d.DATA_DESCRIPTOR+n(t.crc32,4)+n(t.compressedSize,4)+n(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:a.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r,o,i,s,l,c,u=this.bytesWritten-e,h=(r=this.dirRecords.length,o=u,i=e,s=this.zipComment,l=this.encodeFileName,c=a.transformTo("string",l(s)),d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(r,2)+n(r,2)+n(o,4)+n(i,4)+n(c.length,2)+c);this.push({data:h,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},u.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!i.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch{}return!0},u.prototype.lock=function(){i.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){"use strict";var n=e("../compressions"),o=e("./ZipFileWorker");r.generateWorker=function(e,t,r){var a=new o(t.streamFiles,r,t.platform,t.encodeFileName),i=0;try{e.forEach((function(e,r){i++;var o=function(e,t){var r=e||t,o=n[r];if(!o)throw new Error(r+" is not a valid compression method !");return o}(r.options.compression,t.compression),s=r.options.compressionOptions||t.compressionOptions||{},l=r.dir,c=r.date;r._compressWorker(o,s).withStreamInfo("file",{name:e,dir:l,date:c,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(a)})),a.entriesCount=i}catch(e){a.error(e)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){"use strict";function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new n;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}l(n,"n"),(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){"use strict";var n=e("./utils"),o=e("./external"),a=e("./utf8"),i=e("./zipEntries"),s=e("./stream/Crc32Probe"),c=e("./nodejsUtils");function d(e){return new o.Promise((function(t,r){var n=e.decompressed.getContentWorker().pipe(new s);n.on("error",(function(e){r(e)})).on("end",(function(){n.streamInfo.crc32!==e.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}l(d,"f"),t.exports=function(e,t){var r=this;return t=n.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(e)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var r=new i(t);return r.load(e),r})).then((function(e){var r=[o.Promise.resolve(e)],n=e.files;if(t.checkCRC32)for(var a=0;a<n.length;a++)r.push(d(n[a]));return o.Promise.all(r)})).then((function(e){for(var o=e.shift(),a=o.files,i=0;i<a.length;i++){var s=a[i],l=s.fileNameStr,c=n.resolve(s.fileNameStr);r.file(c,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(r.file(c).unsafeOriginalName=l)}return o.zipComment.length&&(r.comment=o.zipComment),r}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){"use strict";var n=e("../utils"),o=e("../stream/GenericWorker");function a(e,t){o.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}l(a,"s"),n.inherits(a,o),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){"use strict";var n=e("readable-stream").Readable;function o(e,t,r){n.call(this,t),this._helper=e;var o=this;e.on("data",(function(e,t){o.push(e)||o._helper.pause(),r&&r(t)})).on("error",(function(e){o.emit("error",e)})).on("end",(function(){o.push(null)}))}l(o,"n"),e("../utils").inherits(o,n),o.prototype._read=function(){this._helper.resume()},t.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,t,r){"use strict";t.exports={isNode:typeof Buffer<"u",newBufferFrom:l((function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)}),"newBufferFrom"),allocBuffer:l((function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t}),"allocBuffer"),isBuffer:l((function(e){return Buffer.isBuffer(e)}),"isBuffer"),isStream:l((function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}),"isStream")}},{}],15:[function(e,t,r){"use strict";function n(e,t,r){var n,o=a.getTypeOf(t),s=a.extend(r||{},c);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=g(e)),s.createFolders&&(n=m(e))&&y.call(this,n,!0);var l="string"===o&&!1===s.binary&&!1===s.base64;r&&void 0!==r.binary||(s.binary=!l),(t instanceof d&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",o="string");var h;h=t instanceof d||t instanceof i?t:p.isNode&&p.isStream(t)?new f(e,t):a.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var b=new u(e,h,s);this.files[e]=b}l(n,"s");var o=e("./utf8"),a=e("./utils"),i=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),c=e("./defaults"),d=e("./compressedObject"),u=e("./zipObject"),h=e("./generate"),p=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),m=l((function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""}),"_"),g=l((function(e){return"/"!==e.slice(-1)&&(e+="/"),e}),"g"),y=l((function(e,t){return t=void 0!==t?t:c.createFolders,e=g(e),this.files[e]||n.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]}),"b");function b(e){return"[object RegExp]"===Object.prototype.toString.call(e)}l(b,"h");var v={load:l((function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")}),"load"),forEach:l((function(e){var t,r,n;for(t in this.files)n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n)}),"forEach"),filter:l((function(e){var t=[];return this.forEach((function(r,n){e(r,n)&&t.push(n)})),t}),"filter"),file:l((function(e,t,r){if(1!==arguments.length)return e=this.root+e,n.call(this,e,t,r),this;if(b(e)){var o=e;return this.filter((function(e,t){return!t.dir&&o.test(e)}))}var a=this.files[this.root+e];return a&&!a.dir?a:null}),"file"),folder:l((function(e){if(!e)return this;if(b(e))return this.filter((function(t,r){return r.dir&&e.test(t)}));var t=this.root+e,r=y.call(this,t),n=this.clone();return n.root=r.name,n}),"folder"),remove:l((function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter((function(t,r){return r.name.slice(0,e.length)===e})),n=0;n<r.length;n++)delete this.files[r[n].name];return this}),"remove"),generate:l((function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")}),"generate"),generateInternalStream:l((function(e){var t,r={};try{if((r=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");a.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";t=h.generateWorker(this,r,n)}catch(e){(t=new i("error")).error(e)}return new s(t,r.type||"string",r.mimeType)}),"generateInternalStream"),generateAsync:l((function(e,t){return this.generateInternalStream(e).accumulate(t)}),"generateAsync"),generateNodeStream:l((function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}),"generateNodeStream")};t.exports=v},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){"use strict";var n=e("./DataReader");function o(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}l(o,"i"),e("../utils").inherits(o,n),o.prototype.byteAt=function(e){return this.data[this.zero+e]},o.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),o=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===r&&this.data[a+2]===n&&this.data[a+3]===o)return a-this.zero;return-1},o.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),o=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&r===a[1]&&n===a[2]&&o===a[3]},o.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){"use strict";var n=e("../utils");function o(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}l(o,"i"),o.prototype={checkOffset:l((function(e){this.checkIndex(this.index+e)}),"checkOffset"),checkIndex:l((function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")}),"checkIndex"),setIndex:l((function(e){this.checkIndex(e),this.index=e}),"setIndex"),skip:l((function(e){this.setIndex(this.index+e)}),"skip"),byteAt:l((function(){}),"byteAt"),readInt:l((function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r}),"readInt"),readString:l((function(e){return n.transformTo("string",this.readData(e))}),"readString"),readData:l((function(){}),"readData"),lastIndexOfSignature:l((function(){}),"lastIndexOfSignature"),readAndCheckSignature:l((function(){}),"readAndCheckSignature"),readDate:l((function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}),"readDate")},t.exports=o},{"../utils":32}],19:[function(e,t,r){"use strict";var n=e("./Uint8ArrayReader");function o(e){n.call(this,e)}l(o,"i"),e("../utils").inherits(o,n),o.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){"use strict";var n=e("./DataReader");function o(e){n.call(this,e)}l(o,"i"),e("../utils").inherits(o,n),o.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},o.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},o.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},o.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){"use strict";var n=e("./ArrayReader");function o(e){n.call(this,e)}l(o,"i"),e("../utils").inherits(o,n),o.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){"use strict";var n=e("../utils"),o=e("../support"),a=e("./ArrayReader"),i=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),"string"!==t||o.uint8array?"nodebuffer"===t?new s(e):o.uint8array?new l(n.transformTo("uint8array",e)):new a(n.transformTo("array",e)):new i(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,r){"use strict";var n=e("./GenericWorker"),o=e("../utils");function a(e){n.call(this,"ConvertWorker to "+e),this.destType=e}l(a,"s"),o.inherits(a,n),a.prototype.processChunk=function(e){this.push({data:o.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){"use strict";var n=e("./GenericWorker"),o=e("../crc32");function a(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}l(a,"s"),e("../utils").inherits(a,n),a.prototype.processChunk=function(e){this.streamInfo.crc32=o(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){"use strict";var n=e("../utils"),o=e("./GenericWorker");function a(e){o.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}l(a,"s"),n.inherits(a,o),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}o.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){"use strict";var n=e("../utils"),o=e("./GenericWorker");function a(e){o.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}l(a,"s"),n.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){"use strict";function n(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l(n,"n"),n.prototype={push:l((function(e){this.emit("data",e)}),"push"),end:l((function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0}),"end"),error:l((function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)}),"error"),on:l((function(e,t){return this._listeners[e].push(t),this}),"on"),cleanUp:l((function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]}),"cleanUp"),emit:l((function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)}),"emit"),pipe:l((function(e){return e.registerPrevious(this)}),"pipe"),registerPrevious:l((function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this}),"registerPrevious"),pause:l((function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)}),"pause"),resume:l((function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e}),"resume"),flush:l((function(){}),"flush"),processChunk:l((function(e){this.push(e)}),"processChunk"),withStreamInfo:l((function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this}),"withStreamInfo"),mergeStreamInfo:l((function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])}),"mergeStreamInfo"),lock:l((function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()}),"lock"),toString:l((function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}),"toString")},t.exports=n},{}],29:[function(e,t,r){"use strict";var n=e("../utils"),o=e("./ConvertWorker"),a=e("./GenericWorker"),i=e("../base64"),s=e("../support"),c=e("../external"),d=null;if(s.nodestream)try{d=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function u(e,t){return new c.Promise((function(r,o){var a=[],s=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",(function(e,r){a.push(e),t&&t(r)})).on("error",(function(e){a=[],o(e)})).on("end",(function(){try{var e=function(e,t,r){switch(e){case"blob":return n.newBlob(n.transformTo("arraybuffer",t),r);case"base64":return i.encode(t);default:return n.transformTo(e,t)}}(l,function(e,t){var r,n=0,o=null,a=0;for(r=0;r<t.length;r++)a+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(o=new Uint8Array(a),r=0;r<t.length;r++)o.set(t[r],n),n+=t[r].length;return o;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,a),c);r(e)}catch(e){o(e)}a=[]})).resume()}))}function h(e,t,r){var i=t;switch(t){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string"}try{this._internalType=i,this._outputType=t,this._mimeType=r,n.checkSupport(i),this._worker=e.pipe(new o(i)),e.lock()}catch(e){this._worker=new a("error"),this._worker.error(e)}}l(u,"l"),l(h,"f"),h.prototype={accumulate:l((function(e){return u(this,e)}),"accumulate"),on:l((function(e,t){var r=this;return"data"===e?this._worker.on(e,(function(e){t.call(r,e.data,e.meta)})):this._worker.on(e,(function(){n.delay(t,arguments,r)})),this}),"on"),resume:l((function(){return n.delay(this._worker.resume,[],this._worker),this}),"resume"),pause:l((function(){return this._worker.pause(),this}),"pause"),toNodejsStream:l((function(e){if(n.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:"nodebuffer"!==this._outputType},e)}),"toNodejsStream")},t.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,r){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=0===new Blob([n],{type:"application/zip"}).size}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(n),r.blob=0===o.getBlob("application/zip").size}catch{r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,r){"use strict";for(var n=e("./utils"),o=e("./support"),a=e("./nodejsUtils"),i=e("./stream/GenericWorker"),s=new Array(256),c=0;c<256;c++)s[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function d(){i.call(this,"utf-8 decode"),this.leftOver=null}function u(){i.call(this,"utf-8 encode")}s[254]=s[254]=1,l(d,"a"),l(u,"l"),r.utf8encode=function(e){return o.nodebuffer?a.newBufferFrom(e,"utf-8"):function(e){var t,r,n,a,i,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=o.uint8array?new Uint8Array(l):new Array(l),a=i=0;i<l;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),r<128?t[i++]=r:(r<2048?t[i++]=192|r>>>6:(r<65536?t[i++]=224|r>>>12:(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63),t[i++]=128|r>>>6&63),t[i++]=128|63&r);return t}(e)},r.utf8decode=function(e){return o.nodebuffer?n.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,o,a,i=e.length,l=new Array(2*i);for(t=r=0;t<i;)if((o=e[t++])<128)l[r++]=o;else if(4<(a=s[o]))l[r++]=65533,t+=a-1;else{for(o&=2===a?31:3===a?15:7;1<a&&t<i;)o=o<<6|63&e[t++],a--;1<a?l[r++]=65533:o<65536?l[r++]=o:(o-=65536,l[r++]=55296|o>>10&1023,l[r++]=56320|1023&o)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),n.applyFromCharCode(l)}(e=n.transformTo(o.uint8array?"uint8array":"array",e))},n.inherits(d,i),d.prototype.processChunk=function(e){var t=n.transformTo(o.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var a=t;(t=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),t.set(a,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var i=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+s[e[r]]>t?r:t}(t),l=t;i!==t.length&&(o.uint8array?(l=t.subarray(0,i),this.leftOver=t.subarray(i,t.length)):(l=t.slice(0,i),this.leftOver=t.slice(i,t.length))),this.push({data:r.utf8decode(l),meta:e.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=d,n.inherits(u,i),u.prototype.processChunk=function(e){this.push({data:r.utf8encode(e.data),meta:e.meta})},r.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,r){"use strict";var n=e("./support"),o=e("./base64"),a=e("./nodejsUtils"),i=e("./external");function s(e){return e}function c(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}l(s,"n"),l(c,"l"),e("setimmediate"),r.newBlob=function(e,t){r.checkSupport("blob");try{return new Blob([e],{type:t})}catch{try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(e),n.getBlob(t)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:l((function(e,t,r){var n=[],o=0,a=e.length;if(a<=r)return String.fromCharCode.apply(null,e);for(;o<a;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(o,Math.min(o+r,a)))):n.push(String.fromCharCode.apply(null,e.subarray(o,Math.min(o+r,a)))),o+=r;return n.join("")}),"stringifyByChunk"),stringifyByChar:l((function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),"stringifyByChar"),applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch{return!1}}()}};function u(e){var t=65536,n=r.getTypeOf(e),o=!0;if("uint8array"===n?o=d.applyCanBeUsed.uint8array:"nodebuffer"===n&&(o=d.applyCanBeUsed.nodebuffer),o)for(;1<t;)try{return d.stringifyByChunk(e,n,t)}catch{t=Math.floor(t/2)}return d.stringifyByChar(e)}function h(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}l(u,"s"),l(h,"f"),r.applyFromCharCode=u;var p={};p.string={string:s,array:l((function(e){return c(e,new Array(e.length))}),"array"),arraybuffer:l((function(e){return p.string.uint8array(e).buffer}),"arraybuffer"),uint8array:l((function(e){return c(e,new Uint8Array(e.length))}),"uint8array"),nodebuffer:l((function(e){return c(e,a.allocBuffer(e.length))}),"nodebuffer")},p.array={string:u,array:s,arraybuffer:l((function(e){return new Uint8Array(e).buffer}),"arraybuffer"),uint8array:l((function(e){return new Uint8Array(e)}),"uint8array"),nodebuffer:l((function(e){return a.newBufferFrom(e)}),"nodebuffer")},p.arraybuffer={string:l((function(e){return u(new Uint8Array(e))}),"string"),array:l((function(e){return h(new Uint8Array(e),new Array(e.byteLength))}),"array"),arraybuffer:s,uint8array:l((function(e){return new Uint8Array(e)}),"uint8array"),nodebuffer:l((function(e){return a.newBufferFrom(new Uint8Array(e))}),"nodebuffer")},p.uint8array={string:u,array:l((function(e){return h(e,new Array(e.length))}),"array"),arraybuffer:l((function(e){return e.buffer}),"arraybuffer"),uint8array:s,nodebuffer:l((function(e){return a.newBufferFrom(e)}),"nodebuffer")},p.nodebuffer={string:u,array:l((function(e){return h(e,new Array(e.length))}),"array"),arraybuffer:l((function(e){return p.nodebuffer.uint8array(e).buffer}),"arraybuffer"),uint8array:l((function(e){return h(e,new Uint8Array(e.length))}),"uint8array"),nodebuffer:s},r.transformTo=function(e,t){if(t=t||"",!e)return t;r.checkSupport(e);var n=r.getTypeOf(t);return p[n][e](t)},r.resolve=function(e){for(var t=e.split("/"),r=[],n=0;n<t.length;n++){var o=t[n];"."===o||""===o&&0!==n&&n!==t.length-1||(".."===o?r.pop():r.push(o))}return r.join("/")},r.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":n.nodebuffer&&a.isBuffer(e)?"nodebuffer":n.uint8array&&e instanceof Uint8Array?"uint8array":n.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(e){if(!n[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},r.delay=function(e,t,r){setImmediate((function(){e.apply(r||null,t||[])}))},r.inherits=function(e,t){function r(){}l(r,"r"),r.prototype=t.prototype,e.prototype=new r},r.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},r.prepareContent=function(e,t,a,s,l){return i.Promise.resolve(t).then((function(e){return n.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&typeof FileReader<"u"?new i.Promise((function(t,r){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){r(e.target.error)},n.readAsArrayBuffer(e)})):e})).then((function(t){var d,u=r.getTypeOf(t);return u?("arraybuffer"===u?t=r.transformTo("uint8array",t):"string"===u&&(l?t=o.decode(t):a&&!0!==s&&(t=c(d=t,n.uint8array?new Uint8Array(d.length):new Array(d.length)))),t):i.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),o=e("./utils"),a=e("./signature"),i=e("./zipEntry"),s=e("./support");function c(e){this.files=[],this.loadOptions=e}l(c,"h"),c.prototype={checkSignature:l((function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(t)+", expected "+o.pretty(e)+")")}}),"checkSignature"),isSignature:l((function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n}),"isSignature"),readBlockEndOfCentral:l((function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",r=o.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)}),"readBlockEndOfCentral"),readBlockZip64EndOfCentral:l((function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}}),"readBlockZip64EndOfCentral"),readBlockZip64EndOfCentralLocator:l((function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")}),"readBlockZip64EndOfCentralLocator"),readLocalFiles:l((function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()}),"readLocalFiles"),readCentralDir:l((function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new i({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)}),"readCentralDir"),readEndOfCentral:l((function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(0<n)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")}),"readEndOfCentral"),prepareReader:l((function(e){this.reader=n(e)}),"prepareReader"),load:l((function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}),"load")},t.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),o=e("./utils"),a=e("./compressedObject"),i=e("./crc32"),s=e("./utf8"),c=e("./compressions"),d=e("./support");function u(e,t){this.options=e,this.loadOptions=t}l(u,"l"),u.prototype={isEncrypted:l((function(){return!(1&~this.bitFlag)}),"isEncrypted"),useUTF8:l((function(){return!(2048&~this.bitFlag)}),"useUTF8"),readLocalPart:l((function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in c)if(Object.prototype.hasOwnProperty.call(c,t)&&c[t].magic===e)return c[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))}),"readLocalPart"),readCentralPart:l((function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)}),"readCentralPart"),processAttributes:l((function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)}),"processAttributes"),parseZIP64ExtraField:l((function(){if(this.extraFields[1]){var e=n(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}}),"parseZIP64ExtraField"),readExtraFields:l((function(e){var t,r,n,o=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<o;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n};e.setIndex(o)}),"readExtraFields"),handleUTF8:l((function(){var e=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=o.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var a=o.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}}),"handleUTF8"),findExtraFieldUnicodePath:l((function(){var e=this.extraFields[28789];if(e){var t=n(e.value);return 1!==t.readInt(1)||i(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}),"findExtraFieldUnicodePath"),findExtraFieldUnicodeComment:l((function(){var e=this.extraFields[25461];if(e){var t=n(e.value);return 1!==t.readInt(1)||i(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}),"findExtraFieldUnicodeComment")},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){"use strict";function n(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}l(n,"n");var o=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),i=e("./utf8"),s=e("./compressedObject"),c=e("./stream/GenericWorker");n.prototype={internalStream:l((function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!n&&(t=t.pipe(new i.Utf8EncodeWorker)),!a&&n&&(t=t.pipe(new i.Utf8DecodeWorker))}catch(e){(t=new c("error")).error(e)}return new o(t,r,"")}),"internalStream"),async:l((function(e,t){return this.internalStream(e).accumulate(t)}),"async"),nodeStream:l((function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)}),"nodeStream"),_compressWorker:l((function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new i.Utf8EncodeWorker)),s.createWorkerFrom(r,e,t)}),"_compressWorker"),_decompressWorker:l((function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof c?this._data:new a(this._data)}),"_decompressWorker")};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<d.length;h++)n.prototype[d[h]]=u;t.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var r,n,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var a=0,i=new o(u),s=e.document.createTextNode("");i.observe(s,{characterData:!0}),r=l((function(){s.data=a=++a%2}),"r")}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var c=new e.MessageChannel;c.port1.onmessage=u,r=l((function(){c.port2.postMessage(0)}),"r")}var d=[];function u(){var e,t;n=!0;for(var r=d.length;r;){for(t=d,d=[],e=-1;++e<r;)t[e]();r=d.length}n=!1}l(u,"u"),t.exports=function(e){1!==d.push(e)||n||r()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,t,r){"use strict";var n=e("immediate");function o(){}l(o,"u");var a={},i=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function d(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==o&&f(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function h(e,t,r){n((function(){var n;try{n=t(r)}catch(t){return a.reject(e,t)}n===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,n)}))}function p(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var r=!1;function n(t){r||(r=!0,a.reject(e,t))}function o(t){r||(r=!0,a.resolve(e,t))}l(n,"n"),l(o,"i");var i=m((function(){t(o,n)}));"error"===i.status&&n(i.value)}function m(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}l(d,"o"),l(u,"h"),l(h,"f"),l(p,"c"),l(f,"d"),l(m,"p"),(t.exports=d).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){throw r}))}))},d.prototype.catch=function(e){return this.then(null,e)},d.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===i)return this;var r=new this.constructor(o);return this.state!==c?h(r,this.state===s?e:t,this.outcome):this.queue.push(new u(r,e,t)),r},u.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){a.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},a.resolve=function(e,t){var r=m(p,t);if("error"===r.status)return a.reject(e,r.value);var n=r.value;if(n)f(e,n);else{e.state=s,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},a.reject=function(e,t){e.state=i,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},d.resolve=function(e){return e instanceof this?e:a.resolve(new this(o),e)},d.reject=function(e){var t=new this(o);return a.reject(t,e)},d.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i=new Array(r),s=0,l=-1,c=new this(o);++l<r;)d(e[l],l);return c;function d(e,o){t.resolve(e).then((function(e){i[o]=e,++s!==r||n||(n=!0,a.resolve(c,i))}),(function(e){n||(n=!0,a.reject(c,e))}))}},d.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t,r=e.length,n=!1;if(!r)return this.resolve([]);for(var i=-1,s=new this(o);++i<r;)t=e[i],this.resolve(t).then((function(e){n||(n=!0,a.resolve(s,e))}),(function(e){n||(n=!0,a.reject(s,e))}));return s}},{immediate:36}],38:[function(e,t,r){"use strict";var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){"use strict";var n=e("./zlib/deflate"),o=e("./utils/common"),a=e("./utils/strings"),i=e("./zlib/messages"),s=e("./zlib/zstream"),c=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=o.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==r)throw new Error(i[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var l;if(l="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(r=n.deflateSetDictionary(this.strm,l)))throw new Error(i[r]);this._dict_set=!0}}function u(e,t){var r=new d(t);if(r.push(e,!0),r.err)throw r.msg||i[r.err];return r.result}l(d,"p"),l(u,"n"),d.prototype.push=function(e,t){var r,i,s=this.strm,l=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=a.string2buf(e):"[object ArrayBuffer]"===c.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new o.Buf8(l),s.next_out=0,s.avail_out=l),1!==(r=n.deflate(s,i))&&0!==r)return this.onEnd(r),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(a.buf2binstring(o.shrinkBuf(s.output,s.next_out))):this.onData(o.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==r);return 4===i?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==i||(this.onEnd(0),!(s.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=d,r.deflate=u,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){"use strict";var n=e("./zlib/inflate"),o=e("./utils/common"),a=e("./utils/strings"),i=e("./zlib/constants"),s=e("./zlib/messages"),c=e("./zlib/zstream"),d=e("./zlib/gzheader"),u=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==i.Z_OK)throw new Error(s[r]);this.header=new d,n.inflateGetHeader(this.strm,this.header)}function p(e,t){var r=new h(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}l(h,"a"),l(p,"o"),h.prototype.push=function(e,t){var r,s,l,c,d,h,p=this.strm,f=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?i.Z_FINISH:i.Z_NO_FLUSH,"string"==typeof e?p.input=a.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new o.Buf8(f),p.next_out=0,p.avail_out=f),(r=n.inflate(p,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&m&&(h="string"==typeof m?a.string2buf(m):"[object ArrayBuffer]"===u.call(m)?new Uint8Array(m):m,r=n.inflateSetDictionary(this.strm,h)),r===i.Z_BUF_ERROR&&!0===g&&(r=i.Z_OK,g=!1),r!==i.Z_STREAM_END&&r!==i.Z_OK)return this.onEnd(r),!(this.ended=!0);p.next_out&&(0!==p.avail_out&&r!==i.Z_STREAM_END&&(0!==p.avail_in||s!==i.Z_FINISH&&s!==i.Z_SYNC_FLUSH)||("string"===this.options.to?(l=a.utf8border(p.output,p.next_out),c=p.next_out-l,d=a.buf2string(p.output,l),p.next_out=c,p.avail_out=f-c,c&&o.arraySet(p.output,p.output,l,c,0),this.onData(d)):this.onData(o.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(g=!0)}while((0<p.avail_in||0===p.avail_out)&&r!==i.Z_STREAM_END);return r===i.Z_STREAM_END&&(s=i.Z_FINISH),s===i.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===i.Z_OK):s!==i.Z_SYNC_FLUSH||(this.onEnd(i.Z_OK),!(p.avail_out=0))},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===i.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=h,r.inflate=p,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},r.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){"use strict";var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:l((function(e,t,r,n,o){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),o);else for(var a=0;a<n;a++)e[o+a]=t[r+a]}),"arraySet"),flattenChunks:l((function(e){var t,r,n,o,a,i;for(t=n=0,r=e.length;t<r;t++)n+=e[t].length;for(i=new Uint8Array(n),t=o=0,r=e.length;t<r;t++)a=e[t],i.set(a,o),o+=a.length;return i}),"flattenChunks")},a={arraySet:l((function(e,t,r,n,o){for(var a=0;a<n;a++)e[o+a]=t[r+a]}),"arraySet"),flattenChunks:l((function(e){return[].concat.apply([],e)}),"flattenChunks")};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,o)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,a))},r.setTyped(n)},{}],42:[function(e,t,r){"use strict";var n=e("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var i=new n.Buf8(256),s=0;s<256;s++)i[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function c(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&o))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",i=0;i<t;i++)r+=String.fromCharCode(e[i]);return r}l(c,"l"),i[254]=i[254]=1,r.string2buf=function(e){var t,r,o,a,i,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(o=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(o-56320),a++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(l),a=i=0;i<l;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(o=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(o-56320),a++),r<128?t[i++]=r:(r<2048?t[i++]=192|r>>>6:(r<65536?t[i++]=224|r>>>12:(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63),t[i++]=128|r>>>6&63),t[i++]=128|63&r);return t},r.buf2binstring=function(e){return c(e,e.length)},r.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,o=t.length;r<o;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,o,a,s=t||e.length,l=new Array(2*s);for(r=n=0;r<s;)if((o=e[r++])<128)l[n++]=o;else if(4<(a=i[o]))l[n++]=65533,r+=a-1;else{for(o&=2===a?31:3===a?15:7;1<a&&r<s;)o=o<<6|63&e[r++],a--;1<a?l[n++]=65533:o<65536?l[n++]=o:(o-=65536,l[n++]=55296|o>>10&1023,l[n++]=56320|1023&o)}return c(l,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+i[e[r]]>t?r:t}},{"./common":41}],43:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){for(var o=65535&e,a=e>>>16&65535,i=0;0!==r;){for(r-=i=2e3<r?2e3:r;a=a+(o=o+t[n++]|0)|0,--i;);o%=65521,a%=65521}return o|a<<16}},{}],44:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){"use strict";var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,o){var a=n,i=o+r;e^=-1;for(var s=o;s<i;s++)e=e>>>8^a[255&(e^t[s])];return~e}},{}],46:[function(e,t,r){"use strict";var n,o=e("../utils/common"),a=e("./trees"),i=e("./adler32"),s=e("./crc32"),c=e("./messages"),d=-2,u=258,h=262,p=113;function f(e,t){return e.msg=c[t],t}function m(e){return(e<<1)-(4<e?9:0)}function g(e){for(var t=e.length;0<=--t;)e[t]=0}function y(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(o.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function b(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,y(e.strm)}function v(e,t){e.pending_buf[e.pending++]=t}function w(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function _(e,t){var r,n,o=e.max_chain_length,a=e.strstart,i=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-h?e.strstart-(e.w_size-h):0,c=e.window,d=e.w_mask,p=e.prev,f=e.strstart+u,m=c[a+i-1],g=c[a+i];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+i]===g&&c[r+i-1]===m&&c[r]===c[a]&&c[++r]===c[a+1]){a+=2,r++;do{}while(c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&a<f);if(n=u-(f-a),a=f-u,i<n){if(e.match_start=t,s<=(i=n))break;m=c[a+i-1],g=c[a+i]}}}while((t=p[t&d])>l&&0!=--o);return i<=e.lookahead?i:e.lookahead}function x(e){var t,r,n,a,l,c,d,u,p,f,m=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-h)){for(o.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=r=e.hash_size;n=e.head[--t],e.head[t]=m<=n?n-m:0,--r;);for(t=r=m;n=e.prev[--t],e.prev[t]=m<=n?n-m:0,--r;);a+=m}if(0===e.strm.avail_in)break;if(c=e.strm,d=e.window,u=e.strstart+e.lookahead,f=void 0,(p=a)<(f=c.avail_in)&&(f=p),r=0===f?0:(c.avail_in-=f,o.arraySet(d,c.input,c.next_in,f,u),1===c.state.wrap?c.adler=i(c.adler,d,f,u):2===c.state.wrap&&(c.adler=s(c.adler,d,f,u)),c.next_in+=f,c.total_in+=f,f),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<h&&0!==e.strm.avail_in)}function k(e,t){for(var r,n;;){if(e.lookahead<h){if(x(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-h&&(e.match_length=_(e,r)),e.match_length>=3)if(n=a._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function S(e,t){for(var r,n,o;;){if(e.lookahead<h){if(x(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-h&&(e.match_length=_(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(o=e.strstart+e.lookahead-3,n=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(b(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=a._tr_tally(e,0,e.window[e.strstart-1]))&&b(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function C(e,t,r,n,o){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=o}function E(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(1146),this.dyn_dtree=new o.Buf16(122),this.bl_tree=new o.Buf16(78),g(this.dyn_ltree),g(this.dyn_dtree),g(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(16),this.heap=new o.Buf16(573),g(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(573),g(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function A(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:p,e.adler=2===t.wrap?0:1,t.last_flush=0,a._tr_init(t),0):f(e,d)}function P(e){var t,r=A(e);return 0===r&&((t=e.state).window_size=2*t.w_size,g(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function I(e,t,r,n,a,i){if(!e)return d;var s=1;if(-1===t&&(t=6),n<0?(s=0,n=-n):15<n&&(s=2,n-=16),a<1||9<a||8!==r||n<8||15<n||t<0||9<t||i<0||4<i)return f(e,d);8===n&&(n=9);var l=new E;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new o.Buf8(2*l.w_size),l.head=new o.Buf16(l.hash_size),l.prev=new o.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new o.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=i,l.method=r,P(e)}l(f,"R"),l(m,"T"),l(g,"D"),l(y,"F"),l(b,"N"),l(v,"U"),l(w,"P"),l(_,"L"),l(x,"j"),l(k,"Z"),l(S,"W"),l(C,"M"),l(E,"H"),l(A,"G"),l(P,"K"),l(I,"Y"),n=[new C(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(x(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,b(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-h&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(b(e,!1),e.strm.avail_out),1)})),new C(4,4,8,4,k),new C(4,5,16,8,k),new C(4,6,32,32,k),new C(4,4,16,16,S),new C(8,16,32,32,S),new C(8,16,128,128,S),new C(8,32,128,256,S),new C(32,128,258,1024,S),new C(32,258,258,4096,S)],r.deflateInit=function(e,t){return I(e,t,8,15,8,0)},r.deflateInit2=I,r.deflateReset=P,r.deflateResetKeep=A,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?d:(e.state.gzhead=t,0):d},r.deflate=function(e,t){var r,o,i,l;if(!e||!e.state||5<t||t<0)return e?f(e,d):d;if(o=e.state,!e.output||!e.input&&0!==e.avail_in||666===o.status&&4!==t)return f(e,0===e.avail_out?-5:d);if(o.strm=e,r=o.last_flush,o.last_flush=t,42===o.status)if(2===o.wrap)e.adler=0,v(o,31),v(o,139),v(o,8),o.gzhead?(v(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),v(o,255&o.gzhead.time),v(o,o.gzhead.time>>8&255),v(o,o.gzhead.time>>16&255),v(o,o.gzhead.time>>24&255),v(o,9===o.level?2:2<=o.strategy||o.level<2?4:0),v(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(v(o,255&o.gzhead.extra.length),v(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=s(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(v(o,0),v(o,0),v(o,0),v(o,0),v(o,0),v(o,9===o.level?2:2<=o.strategy||o.level<2?4:0),v(o,3),o.status=p);else{var c=8+(o.w_bits-8<<4)<<8;c|=(2<=o.strategy||o.level<2?0:o.level<6?1:6===o.level?2:3)<<6,0!==o.strstart&&(c|=32),c+=31-c%31,o.status=p,w(o,c),0!==o.strstart&&(w(o,e.adler>>>16),w(o,65535&e.adler)),e.adler=1}if(69===o.status)if(o.gzhead.extra){for(i=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>i&&(e.adler=s(e.adler,o.pending_buf,o.pending-i,i)),y(e),i=o.pending,o.pending!==o.pending_buf_size));)v(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>i&&(e.adler=s(e.adler,o.pending_buf,o.pending-i,i)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(73===o.status)if(o.gzhead.name){i=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>i&&(e.adler=s(e.adler,o.pending_buf,o.pending-i,i)),y(e),i=o.pending,o.pending===o.pending_buf_size)){l=1;break}l=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,v(o,l)}while(0!==l);o.gzhead.hcrc&&o.pending>i&&(e.adler=s(e.adler,o.pending_buf,o.pending-i,i)),0===l&&(o.gzindex=0,o.status=91)}else o.status=91;if(91===o.status)if(o.gzhead.comment){i=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>i&&(e.adler=s(e.adler,o.pending_buf,o.pending-i,i)),y(e),i=o.pending,o.pending===o.pending_buf_size)){l=1;break}l=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,v(o,l)}while(0!==l);o.gzhead.hcrc&&o.pending>i&&(e.adler=s(e.adler,o.pending_buf,o.pending-i,i)),0===l&&(o.status=103)}else o.status=103;if(103===o.status&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&y(e),o.pending+2<=o.pending_buf_size&&(v(o,255&e.adler),v(o,e.adler>>8&255),e.adler=0,o.status=p)):o.status=p),0!==o.pending){if(y(e),0===e.avail_out)return o.last_flush=-1,0}else if(0===e.avail_in&&m(t)<=m(r)&&4!==t)return f(e,-5);if(666===o.status&&0!==e.avail_in)return f(e,-5);if(0!==e.avail_in||0!==o.lookahead||0!==t&&666!==o.status){var h=2===o.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(x(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(o,t):3===o.strategy?function(e,t){for(var r,n,o,i,s=e.window;;){if(e.lookahead<=u){if(x(e),e.lookahead<=u&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(n=s[o=e.strstart-1])===s[++o]&&n===s[++o]&&n===s[++o]){i=e.strstart+u;do{}while(n===s[++o]&&n===s[++o]&&n===s[++o]&&n===s[++o]&&n===s[++o]&&n===s[++o]&&n===s[++o]&&n===s[++o]&&o<i);e.match_length=u-(i-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=a._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(o,t):n[o.level].func(o,t);if(3!==h&&4!==h||(o.status=666),1===h||3===h)return 0===e.avail_out&&(o.last_flush=-1),0;if(2===h&&(1===t?a._tr_align(o):5!==t&&(a._tr_stored_block(o,0,0,!1),3===t&&(g(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),y(e),0===e.avail_out))return o.last_flush=-1,0}return 4!==t?0:o.wrap<=0?1:(2===o.wrap?(v(o,255&e.adler),v(o,e.adler>>8&255),v(o,e.adler>>16&255),v(o,e.adler>>24&255),v(o,255&e.total_in),v(o,e.total_in>>8&255),v(o,e.total_in>>16&255),v(o,e.total_in>>24&255)):(w(o,e.adler>>>16),w(o,65535&e.adler)),y(e),0<o.wrap&&(o.wrap=-o.wrap),0!==o.pending?0:1)},r.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==p&&666!==t?f(e,d):(e.state=null,t===p?f(e,-3):0):d},r.deflateSetDictionary=function(e,t){var r,n,a,s,l,c,u,h,p=t.length;if(!e||!e.state||2===(s=(r=e.state).wrap)||1===s&&42!==r.status||r.lookahead)return d;for(1===s&&(e.adler=i(e.adler,t,p,0)),r.wrap=0,p>=r.w_size&&(0===s&&(g(r.head),r.strstart=0,r.block_start=0,r.insert=0),h=new o.Buf8(r.w_size),o.arraySet(h,t,p-r.w_size,r.w_size,0),t=h,p=r.w_size),l=e.avail_in,c=e.next_in,u=e.input,e.avail_in=p,e.next_in=0,e.input=t,x(r);r.lookahead>=3;){for(n=r.strstart,a=r.lookahead-2;r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++,--a;);r.strstart=n,r.lookahead=2,x(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=c,e.input=u,e.avail_in=l,r.wrap=s,0},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,o,a,i,s,l,c,d,u,h,p,f,m,g,y,b,v,w,_,x,k,S,C,E;r=e.state,n=e.next_in,C=e.input,o=n+(e.avail_in-5),a=e.next_out,E=e.output,i=a-(t-e.avail_out),s=a+(e.avail_out-257),l=r.dmax,c=r.wsize,d=r.whave,u=r.wnext,h=r.window,p=r.hold,f=r.bits,m=r.lencode,g=r.distcode,y=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;e:do{f<15&&(p+=C[n++]<<f,f+=8,p+=C[n++]<<f,f+=8),v=m[p&y];t:for(;;){if(p>>>=w=v>>>24,f-=w,0==(w=v>>>16&255))E[a++]=65535&v;else{if(!(16&w)){if(!(64&w)){v=m[(65535&v)+(p&(1<<w)-1)];continue t}if(32&w){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}_=65535&v,(w&=15)&&(f<w&&(p+=C[n++]<<f,f+=8),_+=p&(1<<w)-1,p>>>=w,f-=w),f<15&&(p+=C[n++]<<f,f+=8,p+=C[n++]<<f,f+=8),v=g[p&b];r:for(;;){if(p>>>=w=v>>>24,f-=w,!(16&(w=v>>>16&255))){if(!(64&w)){v=g[(65535&v)+(p&(1<<w)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(x=65535&v,f<(w&=15)&&(p+=C[n++]<<f,(f+=8)<w&&(p+=C[n++]<<f,f+=8)),l<(x+=p&(1<<w)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(p>>>=w,f-=w,(w=a-i)<x){if(d<(w=x-w)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(S=h,(k=0)===u){if(k+=c-w,w<_){for(_-=w;E[a++]=h[k++],--w;);k=a-x,S=E}}else if(u<w){if(k+=c+u-w,(w-=u)<_){for(_-=w;E[a++]=h[k++],--w;);if(k=0,u<_){for(_-=w=u;E[a++]=h[k++],--w;);k=a-x,S=E}}}else if(k+=u-w,w<_){for(_-=w;E[a++]=h[k++],--w;);k=a-x,S=E}for(;2<_;)E[a++]=S[k++],E[a++]=S[k++],E[a++]=S[k++],_-=3;_&&(E[a++]=S[k++],1<_&&(E[a++]=S[k++]))}else{for(k=a-x;E[a++]=E[k++],E[a++]=E[k++],E[a++]=E[k++],2<(_-=3););_&&(E[a++]=E[k++],1<_&&(E[a++]=E[k++]))}break}}break}}while(n<o&&a<s);n-=_=f>>3,p&=(1<<(f-=_<<3))-1,e.next_in=n,e.next_out=a,e.avail_in=n<o?o-n+5:5-(n-o),e.avail_out=a<s?s-a+257:257-(a-s),r.hold=p,r.bits=f}},{}],49:[function(e,t,r){"use strict";var n=e("../utils/common"),o=e("./adler32"),a=e("./crc32"),i=e("./inffast"),s=e("./inftrees"),c=-2;function d(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):c}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,h(e)):c}function f(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?c:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,p(e))):c}function m(e,t){var r,n;return e?(n=new u,(e.state=n).window=null,0!==(r=f(e,t))&&(e.state=null),r):c}l(d,"L"),l(u,"s"),l(h,"a"),l(p,"o"),l(f,"h"),l(m,"u");var g,y,b=!0;function v(e){if(b){var t;for(g=new n.Buf32(512),y=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,g,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,y,0,e.work,{bits:5}),b=!1}e.lencode=g,e.lenbits=9,e.distcode=y,e.distbits=5}function w(e,t,r,o){var a,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new n.Buf8(i.wsize)),o>=i.wsize?(n.arraySet(i.window,t,r-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):(o<(a=i.wsize-i.wnext)&&(a=o),n.arraySet(i.window,t,r-o,a,i.wnext),(o-=a)?(n.arraySet(i.window,t,r-o,o,0),i.wnext=o,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0}l(v,"j"),l(w,"Z"),r.inflateReset=p,r.inflateReset2=f,r.inflateResetKeep=h,r.inflateInit=function(e){return m(e,15)},r.inflateInit2=m,r.inflate=function(e,t){var r,l,u,h,p,f,m,g,y,b,_,x,k,S,C,E,A,P,I,R,T,N,D,$,B=0,M=new n.Buf8(4),z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return c;12===(r=e.state).mode&&(r.mode=13),p=e.next_out,u=e.output,m=e.avail_out,h=e.next_in,l=e.input,f=e.avail_in,g=r.hold,y=r.bits,b=f,_=m,N=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;y<16;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}if(2&r.wrap&&35615===g){M[r.check=0]=255&g,M[1]=g>>>8&255,r.check=a(r.check,M,2,0),y=g=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",r.mode=30;break}if(y-=4,T=8+(15&(g>>>=4)),0===r.wbits)r.wbits=T;else if(T>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<T,e.adler=r.check=1,r.mode=512&g?10:12,y=g=0;break;case 2:for(;y<16;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}if(r.flags=g,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=g>>8&1),512&r.flags&&(M[0]=255&g,M[1]=g>>>8&255,r.check=a(r.check,M,2,0)),y=g=0,r.mode=3;case 3:for(;y<32;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}r.head&&(r.head.time=g),512&r.flags&&(M[0]=255&g,M[1]=g>>>8&255,M[2]=g>>>16&255,M[3]=g>>>24&255,r.check=a(r.check,M,4,0)),y=g=0,r.mode=4;case 4:for(;y<16;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}r.head&&(r.head.xflags=255&g,r.head.os=g>>8),512&r.flags&&(M[0]=255&g,M[1]=g>>>8&255,r.check=a(r.check,M,2,0)),y=g=0,r.mode=5;case 5:if(1024&r.flags){for(;y<16;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}r.length=g,r.head&&(r.head.extra_len=g),512&r.flags&&(M[0]=255&g,M[1]=g>>>8&255,r.check=a(r.check,M,2,0)),y=g=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(f<(x=r.length)&&(x=f),x&&(r.head&&(T=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,l,h,x,T)),512&r.flags&&(r.check=a(r.check,l,x,h)),f-=x,h+=x,r.length-=x),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===f)break e;for(x=0;T=l[h+x++],r.head&&T&&r.length<65536&&(r.head.name+=String.fromCharCode(T)),T&&x<f;);if(512&r.flags&&(r.check=a(r.check,l,x,h)),f-=x,h+=x,T)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===f)break e;for(x=0;T=l[h+x++],r.head&&T&&r.length<65536&&(r.head.comment+=String.fromCharCode(T)),T&&x<f;);if(512&r.flags&&(r.check=a(r.check,l,x,h)),f-=x,h+=x,T)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;y<16;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}if(g!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}y=g=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;y<32;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}e.adler=r.check=d(g),y=g=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=p,e.avail_out=m,e.next_in=h,e.avail_in=f,r.hold=g,r.bits=y,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){g>>>=7&y,y-=7&y,r.mode=27;break}for(;y<3;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}switch(r.last=1&g,y-=1,3&(g>>>=1)){case 0:r.mode=14;break;case 1:if(v(r),r.mode=20,6!==t)break;g>>>=2,y-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}g>>>=2,y-=2;break;case 14:for(g>>>=7&y,y-=7&y;y<32;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&g,y=g=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(x=r.length){if(f<x&&(x=f),m<x&&(x=m),0===x)break e;n.arraySet(u,l,h,x,p),f-=x,h+=x,m-=x,p+=x,r.length-=x;break}r.mode=12;break;case 17:for(;y<14;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}if(r.nlen=257+(31&g),g>>>=5,y-=5,r.ndist=1+(31&g),g>>>=5,y-=5,r.ncode=4+(15&g),g>>>=4,y-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;y<3;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}r.lens[z[r.have++]]=7&g,g>>>=3,y-=3}for(;r.have<19;)r.lens[z[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,D={bits:r.lenbits},N=s(0,r.lens,0,19,r.lencode,0,r.work,D),r.lenbits=D.bits,N){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;E=(B=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,A=65535&B,!((C=B>>>24)<=y);){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}if(A<16)g>>>=C,y-=C,r.lens[r.have++]=A;else{if(16===A){for($=C+2;y<$;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}if(g>>>=C,y-=C,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}T=r.lens[r.have-1],x=3+(3&g),g>>>=2,y-=2}else if(17===A){for($=C+3;y<$;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}y-=C,T=0,x=3+(7&(g>>>=C)),g>>>=3,y-=3}else{for($=C+7;y<$;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}y-=C,T=0,x=11+(127&(g>>>=C)),g>>>=7,y-=7}if(r.have+x>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;x--;)r.lens[r.have++]=T}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,D={bits:r.lenbits},N=s(1,r.lens,0,r.nlen,r.lencode,0,r.work,D),r.lenbits=D.bits,N){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,D={bits:r.distbits},N=s(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,D),r.distbits=D.bits,N){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=f&&258<=m){e.next_out=p,e.avail_out=m,e.next_in=h,e.avail_in=f,r.hold=g,r.bits=y,i(e,_),p=e.next_out,u=e.output,m=e.avail_out,h=e.next_in,l=e.input,f=e.avail_in,g=r.hold,y=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;E=(B=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,A=65535&B,!((C=B>>>24)<=y);){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}if(E&&!(240&E)){for(P=C,I=E,R=A;E=(B=r.lencode[R+((g&(1<<P+I)-1)>>P)])>>>16&255,A=65535&B,!(P+(C=B>>>24)<=y);){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}g>>>=P,y-=P,r.back+=P}if(g>>>=C,y-=C,r.back+=C,r.length=A,0===E){r.mode=26;break}if(32&E){r.back=-1,r.mode=12;break}if(64&E){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&E,r.mode=22;case 22:if(r.extra){for($=r.extra;y<$;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}r.length+=g&(1<<r.extra)-1,g>>>=r.extra,y-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;E=(B=r.distcode[g&(1<<r.distbits)-1])>>>16&255,A=65535&B,!((C=B>>>24)<=y);){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}if(!(240&E)){for(P=C,I=E,R=A;E=(B=r.distcode[R+((g&(1<<P+I)-1)>>P)])>>>16&255,A=65535&B,!(P+(C=B>>>24)<=y);){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}g>>>=P,y-=P,r.back+=P}if(g>>>=C,y-=C,r.back+=C,64&E){e.msg="invalid distance code",r.mode=30;break}r.offset=A,r.extra=15&E,r.mode=24;case 24:if(r.extra){for($=r.extra;y<$;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}r.offset+=g&(1<<r.extra)-1,g>>>=r.extra,y-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===m)break e;if(x=_-m,r.offset>x){if((x=r.offset-x)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}k=x>r.wnext?(x-=r.wnext,r.wsize-x):r.wnext-x,x>r.length&&(x=r.length),S=r.window}else S=u,k=p-r.offset,x=r.length;for(m<x&&(x=m),m-=x,r.length-=x;u[p++]=S[k++],--x;);0===r.length&&(r.mode=21);break;case 26:if(0===m)break e;u[p++]=r.length,m--,r.mode=21;break;case 27:if(r.wrap){for(;y<32;){if(0===f)break e;f--,g|=l[h++]<<y,y+=8}if(_-=m,e.total_out+=_,r.total+=_,_&&(e.adler=r.check=r.flags?a(r.check,u,_,p-_):o(r.check,u,_,p-_)),_=m,(r.flags?g:d(g))!==r.check){e.msg="incorrect data check",r.mode=30;break}y=g=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;y<32;){if(0===f)break e;f--,g+=l[h++]<<y,y+=8}if(g!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}y=g=0}r.mode=29;case 29:N=1;break e;case 30:N=-3;break e;case 31:return-4;default:return c}return e.next_out=p,e.avail_out=m,e.next_in=h,e.avail_in=f,r.hold=g,r.bits=y,(r.wsize||_!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&w(e,e.output,e.next_out,_-e.avail_out)?(r.mode=31,-4):(b-=e.avail_in,_-=e.avail_out,e.total_in+=b,e.total_out+=_,r.total+=_,r.wrap&&_&&(e.adler=r.check=r.flags?a(r.check,u,_,e.next_out-_):o(r.check,u,_,e.next_out-_)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==b&&0===_||4===t)&&0===N&&(N=-5),N)},r.inflateEnd=function(e){if(!e||!e.state)return c;var t=e.state;return t.window&&(t.window=null),e.state=null,0},r.inflateGetHeader=function(e,t){var r;return e&&e.state&&2&(r=e.state).wrap?((r.head=t).done=!1,0):c},r.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?c:11===r.mode&&o(1,t,n,0)!==r.check?-3:w(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):c},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){"use strict";var n=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,l,c,d,u,h){var p,f,m,g,y,b,v,w,_,x=h.bits,k=0,S=0,C=0,E=0,A=0,P=0,I=0,R=0,T=0,N=0,D=null,$=0,B=new n.Buf16(16),M=new n.Buf16(16),z=null,U=0;for(k=0;k<=15;k++)B[k]=0;for(S=0;S<l;S++)B[t[r+S]]++;for(A=x,E=15;1<=E&&0===B[E];E--);if(E<A&&(A=E),0===E)return c[d++]=20971520,c[d++]=20971520,h.bits=1,0;for(C=1;C<E&&0===B[C];C++);for(A<C&&(A=C),k=R=1;k<=15;k++)if(R<<=1,(R-=B[k])<0)return-1;if(0<R&&(0===e||1!==E))return-1;for(M[1]=0,k=1;k<15;k++)M[k+1]=M[k]+B[k];for(S=0;S<l;S++)0!==t[r+S]&&(u[M[t[r+S]]++]=S);if(b=0===e?(D=z=u,19):1===e?(D=o,$-=257,z=a,U-=257,256):(D=i,z=s,-1),k=C,y=d,I=S=N=0,m=-1,g=(T=1<<(P=A))-1,1===e&&852<T||2===e&&592<T)return 1;for(;;){for(v=k-I,_=u[S]<b?(w=0,u[S]):u[S]>b?(w=z[U+u[S]],D[$+u[S]]):(w=96,0),p=1<<k-I,C=f=1<<P;c[y+(N>>I)+(f-=p)]=v<<24|w<<16|_,0!==f;);for(p=1<<k-1;N&p;)p>>=1;if(0!==p?(N&=p-1,N+=p):N=0,S++,0==--B[k]){if(k===E)break;k=t[r+u[S]]}if(A<k&&(N&g)!==m){for(0===I&&(I=A),y+=C,R=1<<(P=k-I);P+I<E&&!((R-=B[P+I])<=0);)P++,R<<=1;if(T+=1<<P,1===e&&852<T||2===e&&592<T)return 1;c[m=N&g]=A<<24|P<<16|y-d}}return 0!==N&&(c[y+N]=k-I<<24|64<<16),h.bits=A,0}},{"../utils/common":41}],51:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){"use strict";var n=e("../utils/common");function o(e){for(var t=e.length;0<=--t;)e[t]=0}l(o,"n");var a=256,i=286,s=30,c=15,d=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],p=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);o(f);var m=new Array(60);o(m);var g=new Array(512);o(g);var y=new Array(256);o(y);var b=new Array(29);o(b);var v,w,_,x=new Array(s);function k(e,t,r,n,o){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=o,this.has_stree=e&&e.length}function S(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function C(e){return e<256?g[e]:g[256+(e>>>7)]}function E(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function A(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,E(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function P(e,t,r){A(e,r[2*t],r[2*t+1])}function I(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function R(e,t,r){var n,o,a=new Array(16),i=0;for(n=1;n<=c;n++)a[n]=i=i+r[n-1]<<1;for(o=0;o<=t;o++){var s=e[2*o+1];0!==s&&(e[2*o]=I(a[s]++,s))}}function T(e){var t;for(t=0;t<i;t++)e.dyn_ltree[2*t]=0;for(t=0;t<s;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function N(e){8<e.bi_valid?E(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function D(e,t,r,n){var o=2*t,a=2*r;return e[o]<e[a]||e[o]===e[a]&&n[t]<=n[r]}function $(e,t,r){for(var n=e.heap[r],o=r<<1;o<=e.heap_len&&(o<e.heap_len&&D(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!D(t,n,e.heap[o],e.depth));)e.heap[r]=e.heap[o],r=o,o<<=1;e.heap[r]=n}function B(e,t,r){var n,o,i,s,l=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],o=e.pending_buf[e.l_buf+l],l++,0===n?P(e,o,t):(P(e,(i=y[o])+a+1,t),0!==(s=d[i])&&A(e,o-=b[i],s),P(e,i=C(--n),r),0!==(s=u[i])&&A(e,n-=x[i],s)),l<e.last_lit;);P(e,256,t)}function M(e,t){var r,n,o,a=t.dyn_tree,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,d=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<l;r++)0!==a[2*r]?(e.heap[++e.heap_len]=d=r,e.depth[r]=0):a[2*r+1]=0;for(;e.heap_len<2;)a[2*(o=e.heap[++e.heap_len]=d<2?++d:0)]=1,e.depth[o]=0,e.opt_len--,s&&(e.static_len-=i[2*o+1]);for(t.max_code=d,r=e.heap_len>>1;1<=r;r--)$(e,a,r);for(o=l;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],$(e,a,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,a[2*o]=a[2*r]+a[2*n],e.depth[o]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,a[2*r+1]=a[2*n+1]=o,e.heap[1]=o++,$(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,o,a,i,s,l=t.dyn_tree,d=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(a=0;a<=c;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)m<(a=l[2*l[2*(n=e.heap[r])+1]+1]+1)&&(a=m,g++),l[2*n+1]=a,d<n||(e.bl_count[a]++,i=0,f<=n&&(i=p[n-f]),s=l[2*n],e.opt_len+=s*(a+i),h&&(e.static_len+=s*(u[2*n+1]+i)));if(0!==g){do{for(a=m-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[m]--,g-=2}while(0<g);for(a=m;0!==a;a--)for(n=e.bl_count[a];0!==n;)d<(o=e.heap[--r])||(l[2*o+1]!==a&&(e.opt_len+=(a-l[2*o+1])*l[2*o],l[2*o+1]=a),n--)}}(e,t),R(a,d,e.bl_count)}function z(e,t,r){var n,o,a=-1,i=t[1],s=0,l=7,c=4;for(0===i&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)o=i,i=t[2*(n+1)+1],++s<l&&o===i||(s<c?e.bl_tree[2*o]+=s:0!==o?(o!==a&&e.bl_tree[2*o]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=o,c=(s=0)===i?(l=138,3):o===i?(l=6,3):(l=7,4))}function U(e,t,r){var n,o,a=-1,i=t[1],s=0,l=7,c=4;for(0===i&&(l=138,c=3),n=0;n<=r;n++)if(o=i,i=t[2*(n+1)+1],!(++s<l&&o===i)){if(s<c)for(;P(e,o,e.bl_tree),0!=--s;);else 0!==o?(o!==a&&(P(e,o,e.bl_tree),s--),P(e,16,e.bl_tree),A(e,s-3,2)):s<=10?(P(e,17,e.bl_tree),A(e,s-3,3)):(P(e,18,e.bl_tree),A(e,s-11,7));a=o,c=(s=0)===i?(l=138,3):o===i?(l=6,3):(l=7,4)}}l(k,"D"),l(S,"F"),l(C,"N"),l(E,"U"),l(A,"P"),l(P,"L"),l(I,"j"),l(R,"Z"),l(T,"W"),l(N,"M"),l(D,"H"),l($,"G"),l(B,"K"),l(M,"Y"),l(z,"X"),l(U,"V"),o(x);var O=!1;function F(e,t,r,o){var a,i,s;A(e,0+(o?1:0),3),i=t,s=r,N(a=e),E(a,s),E(a,~s),n.arraySet(a.pending_buf,a.window,i,s,a.pending),a.pending+=s}l(F,"J"),r._tr_init=function(e){O||(function(){var e,t,r,n,o,a=new Array(16);for(n=r=0;n<28;n++)for(b[n]=r,e=0;e<1<<d[n];e++)y[r++]=n;for(y[r-1]=n,n=o=0;n<16;n++)for(x[n]=o,e=0;e<1<<u[n];e++)g[o++]=n;for(o>>=7;n<s;n++)for(x[n]=o<<7,e=0;e<1<<u[n]-7;e++)g[256+o++]=n;for(t=0;t<=c;t++)a[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,a[8]++;for(;e<=255;)f[2*e+1]=9,e++,a[9]++;for(;e<=279;)f[2*e+1]=7,e++,a[7]++;for(;e<=287;)f[2*e+1]=8,e++,a[8]++;for(R(f,287,a),e=0;e<s;e++)m[2*e+1]=5,m[2*e]=I(e,5);v=new k(f,d,257,i,c),w=new k(m,u,0,s,c),_=new k(new Array(0),h,0,19,7)}(),O=!0),e.l_desc=new S(e.dyn_ltree,v),e.d_desc=new S(e.dyn_dtree,w),e.bl_desc=new S(e.bl_tree,_),e.bi_buf=0,e.bi_valid=0,T(e)},r._tr_stored_block=F,r._tr_flush_block=function(e,t,r,n){var o,i,s=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),M(e,e.l_desc),M(e,e.d_desc),s=function(e){var t;for(z(e,e.dyn_ltree,e.l_desc.max_code),z(e,e.dyn_dtree,e.d_desc.max_code),M(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*p[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=o&&(o=i)):o=i=r+5,r+4<=o&&-1!==t?F(e,t,r,n):4===e.strategy||i===o?(A(e,2+(n?1:0),3),B(e,f,m)):(A(e,4+(n?1:0),3),function(e,t,r,n){var o;for(A(e,t-257,5),A(e,r-1,5),A(e,n-4,4),o=0;o<n;o++)A(e,e.bl_tree[2*p[o]+1],3);U(e,e.dyn_ltree,t-1),U(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),B(e,e.dyn_ltree,e.dyn_dtree)),T(e),n&&N(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(y[r]+a+1)]++,e.dyn_dtree[2*C(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){var t;A(e,2,3),P(e,256,f),16===(t=e).bi_valid?(E(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,r){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e){"use strict";if(!e.setImmediate){var t,r,n,o,a=1,i={},s=!1,c=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,t="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick((function(){h(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(o="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",p,!1):e.attachEvent("onmessage",p),function(t){e.postMessage(o+t,"*")}):e.MessageChannel?((n=new MessageChannel).port1.onmessage=function(e){h(e.data)},function(e){n.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):function(e){setTimeout(h,0,e)},d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var r=new Array(arguments.length-1),n=0;n<r.length;n++)r[n]=arguments[n+1];var o={callback:e,args:r};return i[a]=o,t(a),a++},d.clearImmediate=u}function u(e){delete i[e]}function h(e){if(s)setTimeout(h,0,e);else{var t=i[e];if(t){s=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(undefined,r)}}(t)}finally{u(e),s=!1}}}}function p(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&h(+t.data.slice(o.length))}l(u,"f"),l(h,"c"),l(p,"d")}(typeof self>"u"?void 0===e?this:e:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)}))})),Zo=lr((()=>{})),Yo=lr(((e,t)=>{!function(){"use strict";var e="input is invalid type",r="object"==typeof window,n=r?window:{};n.JS_SHA256_NO_WINDOW&&(r=!1);var o=!r&&"object"==typeof self,a=!n.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;a?n=global:o&&(n=self);var i=!n.JS_SHA256_NO_COMMON_JS&&"object"==typeof t&&t.exports,s="function"==typeof define&&define.amd,c=!n.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",d="0123456789abcdef".split(""),u=[-2147483648,8388608,32768,128],h=[24,16,8,0],p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],f=["hex","array","digest","arrayBuffer"],m=[];(n.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),c&&(n.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var g=l((function(e,t){return function(r){return new _(t,!0).update(r)[e]()}}),"createOutputMethod"),y=l((function(e){var t=g("hex",e);a&&(t=b(t,e)),t.create=function(){return new _(e)},t.update=function(e){return t.create().update(e)};for(var r=0;r<f.length;++r){var n=f[r];t[n]=g(n,e)}return t}),"createMethod"),b=l((function(t,r){var o,a=to(),i=Zo().Buffer,s=r?"sha224":"sha256";return o=i.from&&!n.JS_SHA256_NO_BUFFER_FROM?i.from:l((function(e){return new i(e)}),"bufferFrom"),l((function(r){if("string"==typeof r)return a.createHash(s).update(r,"utf8").digest("hex");if(null==r)throw new Error(e);return r.constructor===ArrayBuffer&&(r=new Uint8Array(r)),Array.isArray(r)||ArrayBuffer.isView(r)||r.constructor===i?a.createHash(s).update(o(r)).digest("hex"):t(r)}),"nodeMethod")}),"nodeWrap"),v=l((function(e,t){return function(r,n){return new x(r,t,!0).update(n)[e]()}}),"createHmacOutputMethod"),w=l((function(e){var t=v("hex",e);t.create=function(t){return new x(t,e)},t.update=function(e,r){return t.create(e).update(r)};for(var r=0;r<f.length;++r){var n=f[r];t[n]=v(n,e)}return t}),"createHmacMethod");function _(e,t){t?(m[0]=m[16]=m[1]=m[2]=m[3]=m[4]=m[5]=m[6]=m[7]=m[8]=m[9]=m[10]=m[11]=m[12]=m[13]=m[14]=m[15]=0,this.blocks=m):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function x(t,r,n){var o,a=typeof t;if("string"===a){var i,s=[],l=t.length,d=0;for(o=0;o<l;++o)(i=t.charCodeAt(o))<128?s[d++]=i:i<2048?(s[d++]=192|i>>>6,s[d++]=128|63&i):i<55296||i>=57344?(s[d++]=224|i>>>12,s[d++]=128|i>>>6&63,s[d++]=128|63&i):(i=65536+((1023&i)<<10|1023&t.charCodeAt(++o)),s[d++]=240|i>>>18,s[d++]=128|i>>>12&63,s[d++]=128|i>>>6&63,s[d++]=128|63&i);t=s}else{if("object"!==a)throw new Error(e);if(null===t)throw new Error(e);if(c&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||c&&ArrayBuffer.isView(t)))throw new Error(e)}t.length>64&&(t=new _(r,!0).update(t).array());var u=[],h=[];for(o=0;o<64;++o){var p=t[o]||0;u[o]=92^p,h[o]=54^p}_.call(this,r,n),this.update(h),this.oKeyPad=u,this.inner=!0,this.sharedMemory=n}l(_,"Sha256"),_.prototype.update=function(t){if(!this.finalized){var r,n=typeof t;if("string"!==n){if("object"!==n)throw new Error(e);if(null===t)throw new Error(e);if(c&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||c&&ArrayBuffer.isView(t)))throw new Error(e);r=!0}for(var o,a,i=0,s=t.length,l=this.blocks;i<s;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,this.block=l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),r)for(a=this.start;i<s&&a<64;++i)l[a>>>2]|=t[i]<<h[3&a++];else for(a=this.start;i<s&&a<64;++i)(o=t.charCodeAt(i))<128?l[a>>>2]|=o<<h[3&a++]:o<2048?(l[a>>>2]|=(192|o>>>6)<<h[3&a++],l[a>>>2]|=(128|63&o)<<h[3&a++]):o<55296||o>=57344?(l[a>>>2]|=(224|o>>>12)<<h[3&a++],l[a>>>2]|=(128|o>>>6&63)<<h[3&a++],l[a>>>2]|=(128|63&o)<<h[3&a++]):(o=65536+((1023&o)<<10|1023&t.charCodeAt(++i)),l[a>>>2]|=(240|o>>>18)<<h[3&a++],l[a>>>2]|=(128|o>>>12&63)<<h[3&a++],l[a>>>2]|=(128|o>>>6&63)<<h[3&a++],l[a>>>2]|=(128|63&o)<<h[3&a++]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=l[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this}},_.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>>2]|=u[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},_.prototype.hash=function(){var e,t,r,n,o,a,i,s,l,c=this.h0,d=this.h1,u=this.h2,h=this.h3,f=this.h4,m=this.h5,g=this.h6,y=this.h7,b=this.blocks;for(e=16;e<64;++e)t=((o=b[e-15])>>>7|o<<25)^(o>>>18|o<<14)^o>>>3,r=((o=b[e-2])>>>17|o<<15)^(o>>>19|o<<13)^o>>>10,b[e]=b[e-16]+t+b[e-7]+r|0;for(l=d&u,e=0;e<64;e+=4)this.first?(this.is224?(a=300032,y=(o=b[0]-1413257819)-150054599|0,h=o+24177077|0):(a=704751109,y=(o=b[0]-210244248)-1521486534|0,h=o+143694565|0),this.first=!1):(t=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),n=(a=c&d)^c&u^l,y=h+(o=y+(r=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&m^~f&g)+p[e]+b[e])|0,h=o+(t+n)|0),t=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),n=(i=h&c)^h&d^a,g=u+(o=g+(r=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7))+(y&f^~y&m)+p[e+1]+b[e+1])|0,t=((u=o+(t+n)|0)>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),n=(s=u&h)^u&c^i,m=d+(o=m+(r=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&y^~g&f)+p[e+2]+b[e+2])|0,t=((d=o+(t+n)|0)>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),n=(l=d&u)^d&h^s,f=c+(o=f+(r=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&g^~m&y)+p[e+3]+b[e+3])|0,c=o+(t+n)|0,this.chromeBugWorkAround=!0;this.h0=this.h0+c|0,this.h1=this.h1+d|0,this.h2=this.h2+u|0,this.h3=this.h3+h|0,this.h4=this.h4+f|0,this.h5=this.h5+m|0,this.h6=this.h6+g|0,this.h7=this.h7+y|0},_.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,o=this.h4,a=this.h5,i=this.h6,s=this.h7,l=d[e>>>28&15]+d[e>>>24&15]+d[e>>>20&15]+d[e>>>16&15]+d[e>>>12&15]+d[e>>>8&15]+d[e>>>4&15]+d[15&e]+d[t>>>28&15]+d[t>>>24&15]+d[t>>>20&15]+d[t>>>16&15]+d[t>>>12&15]+d[t>>>8&15]+d[t>>>4&15]+d[15&t]+d[r>>>28&15]+d[r>>>24&15]+d[r>>>20&15]+d[r>>>16&15]+d[r>>>12&15]+d[r>>>8&15]+d[r>>>4&15]+d[15&r]+d[n>>>28&15]+d[n>>>24&15]+d[n>>>20&15]+d[n>>>16&15]+d[n>>>12&15]+d[n>>>8&15]+d[n>>>4&15]+d[15&n]+d[o>>>28&15]+d[o>>>24&15]+d[o>>>20&15]+d[o>>>16&15]+d[o>>>12&15]+d[o>>>8&15]+d[o>>>4&15]+d[15&o]+d[a>>>28&15]+d[a>>>24&15]+d[a>>>20&15]+d[a>>>16&15]+d[a>>>12&15]+d[a>>>8&15]+d[a>>>4&15]+d[15&a]+d[i>>>28&15]+d[i>>>24&15]+d[i>>>20&15]+d[i>>>16&15]+d[i>>>12&15]+d[i>>>8&15]+d[i>>>4&15]+d[15&i];return this.is224||(l+=d[s>>>28&15]+d[s>>>24&15]+d[s>>>20&15]+d[s>>>16&15]+d[s>>>12&15]+d[s>>>8&15]+d[s>>>4&15]+d[15&s]),l},_.prototype.toString=_.prototype.hex,_.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,o=this.h4,a=this.h5,i=this.h6,s=this.h7,l=[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n,o>>>24&255,o>>>16&255,o>>>8&255,255&o,a>>>24&255,a>>>16&255,a>>>8&255,255&a,i>>>24&255,i>>>16&255,i>>>8&255,255&i];return this.is224||l.push(s>>>24&255,s>>>16&255,s>>>8&255,255&s),l},_.prototype.array=_.prototype.digest,_.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},l(x,"HmacSha256"),x.prototype=new _,x.prototype.finalize=function(){if(_.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();_.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),_.prototype.finalize.call(this)}};var k=y();k.sha256=k,k.sha224=y(!0),k.sha256.hmac=w(),k.sha224.hmac=w(!0),i?t.exports=k:(n.sha256=k.sha256,n.sha224=k.sha224,s&&define((function(){return k})))}()})),Ue=crypto,yr=l((e=>e instanceof CryptoKey),"isCryptoKey"),ge=new TextEncoder,_e=new TextDecoder,Ca=2**32;function xr(...e){let t=e.reduce(((e,{length:t})=>e+t),0),r=new Uint8Array(t),n=0;for(let t of e)r.set(t,n),n+=t.length;return r}l(xr,"concat");var En=l((e=>{let t=e;"string"==typeof t&&(t=ge.encode(t));let r=[];for(let e=0;e<t.length;e+=32768)r.push(String.fromCharCode.apply(null,t.subarray(e,e+32768)));return btoa(r.join(""))}),"encodeBase64"),vr=l((e=>En(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")),"encode"),An=l((e=>{let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}),"decodeBase64"),Ce=l((e=>{let t=e;t instanceof Uint8Array&&(t=_e.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return An(t)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}}),"decode"),le=class extends Error{static{l(this,"JOSEError")}constructor(e,t){super(e,t),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}};le.code="ERR_JOSE_GENERIC";var ye=class extends le{static{l(this,"JWTClaimValidationFailed")}constructor(e,t,r="unspecified",n="unspecified"){super(e,{cause:{claim:r,reason:n,payload:t}}),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=r,this.reason=n,this.payload=t}};ye.code="ERR_JWT_CLAIM_VALIDATION_FAILED";var er=class extends le{static{l(this,"JWTExpired")}constructor(e,t,r="unspecified",n="unspecified"){super(e,{cause:{claim:r,reason:n,payload:t}}),this.code="ERR_JWT_EXPIRED",this.claim=r,this.reason=n,this.payload=t}};er.code="ERR_JWT_EXPIRED";var cr=class extends le{static{l(this,"JOSEAlgNotAllowed")}constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}};cr.code="ERR_JOSE_ALG_NOT_ALLOWED";var me=class extends le{static{l(this,"JOSENotSupported")}constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}};me.code="ERR_JOSE_NOT_SUPPORTED";var Mr=class extends le{static{l(this,"JWEDecryptionFailed")}constructor(e="decryption operation failed",t){super(e,t),this.code="ERR_JWE_DECRYPTION_FAILED"}};Mr.code="ERR_JWE_DECRYPTION_FAILED";var Lr=class extends le{static{l(this,"JWEInvalid")}constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}};Lr.code="ERR_JWE_INVALID";var Qt=class extends le{static{l(this,"JWSInvalid")}constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}};Qt.code="ERR_JWS_INVALID";var De=class extends le{static{l(this,"JWTInvalid")}constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}};De.code="ERR_JWT_INVALID";var Wr=class extends le{static{l(this,"JWKInvalid")}constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}};Wr.code="ERR_JWK_INVALID";var Hr=class extends le{static{l(this,"JWKSInvalid")}constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}};Hr.code="ERR_JWKS_INVALID";var jr=class extends le{static{l(this,"JWKSNoMatchingKey")}constructor(e="no applicable key found in the JSON Web Key Set",t){super(e,t),this.code="ERR_JWKS_NO_MATCHING_KEY"}};jr.code="ERR_JWKS_NO_MATCHING_KEY";var Kr=class extends le{static{l(this,"JWKSMultipleMatchingKeys")}constructor(e="multiple matching keys found in the JSON Web Key Set",t){super(e,t),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS"}};Kr.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";var Vr=class extends le{static{l(this,"JWKSTimeout")}constructor(e="request timed out",t){super(e,t),this.code="ERR_JWKS_TIMEOUT"}};Vr.code="ERR_JWKS_TIMEOUT";var fr=class extends le{static{l(this,"JWSSignatureVerificationFailed")}constructor(e="signature verification failed",t){super(e,t),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}};function Ee(e,t="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function dr(e,t){return e.name===t}function Jr(e){return parseInt(e.name.slice(4),10)}function Rn(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function In(e,t){if(t.length&&!t.some((t=>e.usages.includes(t)))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw new TypeError(e)}}function bo(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!dr(e.algorithm,"HMAC"))throw Ee("HMAC");let r=parseInt(t.slice(2),10);if(Jr(e.algorithm.hash)!==r)throw Ee(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!dr(e.algorithm,"RSASSA-PKCS1-v1_5"))throw Ee("RSASSA-PKCS1-v1_5");let r=parseInt(t.slice(2),10);if(Jr(e.algorithm.hash)!==r)throw Ee(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!dr(e.algorithm,"RSA-PSS"))throw Ee("RSA-PSS");let r=parseInt(t.slice(2),10);if(Jr(e.algorithm.hash)!==r)throw Ee(`SHA-${r}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw Ee("Ed25519 or Ed448");break;case"Ed25519":if(!dr(e.algorithm,"Ed25519"))throw Ee("Ed25519");break;case"ES256":case"ES384":case"ES512":{if(!dr(e.algorithm,"ECDSA"))throw Ee("ECDSA");let r=Rn(t);if(e.algorithm.namedCurve!==r)throw Ee(r,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}In(e,r)}function go(e,t,...r){if((r=r.filter(Boolean)).length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}fr.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",l(Ee,"unusable"),l(dr,"isAlgorithm"),l(Jr,"getHashLength"),l(Rn,"getNamedCurve"),l(In,"checkUsage"),l(bo,"checkSigCryptoKey"),l(go,"message");var Gr=l(((e,...t)=>go("Key must be ",e,...t)),"default");function Zr(e,t,...r){return go(`Key for the ${e} algorithm must be `,t,...r)}l(Zr,"withAlg");var Yr=l((e=>!!yr(e)||"KeyObject"===e?.[Symbol.toStringTag]),"default"),rr=["CryptoKey"],Tn=l(((...e)=>{let t,r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(t&&0!==t.size)for(let e of r){if(t.has(e))return!1;t.add(e)}else t=new Set(r)}return!0}),"isDisjoint"),wr=Tn;function Dn(e){return"object"==typeof e&&null!==e}function we(e){if(!Dn(e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}l(Dn,"isObjectLike"),l(we,"isObject");var _r=l(((e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){let{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}}),"default");function Ne(e){return we(e)&&"string"==typeof e.kty}function yo(e){return"oct"!==e.kty&&"string"==typeof e.d}function xo(e){return"oct"!==e.kty&&typeof e.d>"u"}function vo(e){return Ne(e)&&"oct"===e.kty&&"string"==typeof e.k}function Bn(e){let t,r;switch(e.kty){case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new me('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new me('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(e.alg){case"Ed25519":t={name:"Ed25519"},r=e.d?["sign"]:["verify"];break;case"EdDSA":t={name:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new me('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new me('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}l(Ne,"isJWK"),l(yo,"isPrivateJWK"),l(xo,"isPublicJWK"),l(vo,"isSecretJWK"),l(Bn,"subtleMapping");var or,nr,Fn=l((async e=>{if(!e.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:t,keyUsages:r}=Bn(e),n=[t,e.ext??!1,e.key_ops??r],o={...e};return delete o.alg,delete o.use,Ue.subtle.importKey("jwk",o,...n)}),"parse"),Sr=Fn,wo=l((e=>Ce(e)),"exportKeyValue"),_o=l((e=>"KeyObject"===e?.[Symbol.toStringTag]),"isKeyObject"),kr=l((async(e,t,r,n,o=!1)=>{let a=e.get(t);if(a?.[n])return a[n];let i=await Sr({...r,alg:n});return o&&Object.freeze(t),a?a[n]=i:e.set(t,{[n]:i}),i}),"importAndCache"),$n=l(((e,t)=>{if(_o(e)){let r=e.export({format:"jwk"});return delete r.d,delete r.dp,delete r.dq,delete r.p,delete r.q,delete r.qi,r.k?wo(r.k):(nr||(nr=new WeakMap),kr(nr,e,r,t))}return Ne(e)?e.k?Ce(e.k):(nr||(nr=new WeakMap),kr(nr,e,e,t,!0)):e}),"normalizePublicKey"),Un=l(((e,t)=>{if(_o(e)){let r=e.export({format:"jwk"});return r.k?wo(r.k):(or||(or=new WeakMap),kr(or,e,r,t))}return Ne(e)?e.k?Ce(e.k):(or||(or=new WeakMap),kr(or,e,e,t,!0)):e}),"normalizePrivateKey"),Xr={normalizePublicKey:$n,normalizePrivateKey:Un};async function So(e,t){if(!we(e))throw new TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return Ce(e.k);case"RSA":if("oth"in e&&void 0!==e.oth)throw new me('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return Sr({...e,alg:t});default:throw new me('Unsupported "kty" (Key Type) Parameter value')}}l(So,"importJWK");var ar=l((e=>e?.[Symbol.toStringTag]),"tag"),Qr=l(((e,t,r)=>{if(void 0!==t.use&&"sig"!==t.use)throw new TypeError("Invalid key for this operation, when present its use must be sig");if(void 0!==t.key_ops&&!0!==t.key_ops.includes?.(r))throw new TypeError(`Invalid key for this operation, when present its key_ops must include ${r}`);if(void 0!==t.alg&&t.alg!==e)throw new TypeError(`Invalid key for this operation, when present its alg must be ${e}`);return!0}),"jwkMatchesOp"),On=l(((e,t,r,n)=>{if(!(t instanceof Uint8Array)){if(n&&Ne(t)){if(vo(t)&&Qr(e,t,r))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!Yr(t))throw new TypeError(Zr(e,t,...rr,"Uint8Array",n?"JSON Web Key":null));if("secret"!==t.type)throw new TypeError(`${ar(t)} instances for symmetric algorithms must be of type "secret"`)}}),"symmetricTypeCheck"),zn=l(((e,t,r,n)=>{if(n&&Ne(t))switch(r){case"sign":if(yo(t)&&Qr(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(xo(t)&&Qr(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!Yr(t))throw new TypeError(Zr(e,t,...rr,n?"JSON Web Key":null));if("secret"===t.type)throw new TypeError(`${ar(t)} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw new TypeError(`${ar(t)} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw new TypeError(`${ar(t)} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw new TypeError(`${ar(t)} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw new TypeError(`${ar(t)} instances for asymmetric algorithm encryption must be of type "public"`)}),"asymmetricTypeCheck");function ko(e,t,r,n){t.startsWith("HS")||"dir"===t||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t)?On(t,r,n,e):zn(t,r,n,e)}l(ko,"checkKeyType");var fs=ko.bind(void 0,!1),ur=ko.bind(void 0,!0);function Mn(e,t,r,n,o){if(void 0!==o.crit&&void 0===n?.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some((e=>"string"!=typeof e||0===e.length)))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let a;a=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t;for(let t of n.crit){if(!a.has(t))throw new me(`Extension Header Parameter "${t}" is not recognized`);if(void 0===o[t])throw new e(`Extension Header Parameter "${t}" is missing`);if(a.get(t)&&void 0===n[t])throw new e(`Extension Header Parameter "${t}" MUST be integrity protected`)}return new Set(n.crit)}l(Mn,"validateCrit");var Cr=Mn,Ln=l(((e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some((e=>"string"!=typeof e))))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}),"validateAlgorithms"),Co=Ln;function hr(e,t){let r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"Ed25519":return{name:"Ed25519"};case"EdDSA":return{name:t.name};default:throw new me(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}async function pr(e,t,r){if("sign"===r&&(t=await Xr.normalizePrivateKey(t,e)),"verify"===r&&(t=await Xr.normalizePublicKey(t,e)),yr(t))return bo(t,e,r),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(Gr(t,...rr));return Ue.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}throw new TypeError(Gr(t,...rr,"Uint8Array","JSON Web Key"))}l(hr,"subtleDsa"),l(pr,"getCryptoKey");var Wn=l((async(e,t,r,n)=>{let o=await pr(e,t,"verify");_r(e,o);let a=hr(e,o.algorithm);try{return await Ue.subtle.verify(a,o,r,n)}catch{return!1}}),"verify"),Eo=Wn;async function Ao(e,t,r){if(!we(e))throw new Qt("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new Qt('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new Qt("JWS Protected Header incorrect type");if(void 0===e.payload)throw new Qt("JWS Payload missing");if("string"!=typeof e.signature)throw new Qt("JWS Signature missing or incorrect type");if(void 0!==e.header&&!we(e.header))throw new Qt("JWS Unprotected Header incorrect type");let n={};if(e.protected)try{let t=Ce(e.protected);n=JSON.parse(_e.decode(t))}catch{throw new Qt("JWS Protected Header is invalid")}if(!wr(n,e.header))throw new Qt("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let o={...n,...e.header},a=!0;if(Cr(Qt,new Map([["b64",!0]]),r?.crit,n,o).has("b64")&&(a=n.b64,"boolean"!=typeof a))throw new Qt('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:i}=o;if("string"!=typeof i||!i)throw new Qt('JWS "alg" (Algorithm) Header Parameter missing or invalid');let s=r&&Co("algorithms",r.algorithms);if(s&&!s.has(i))throw new cr('"alg" (Algorithm) Header Parameter value not allowed');if(a){if("string"!=typeof e.payload)throw new Qt("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new Qt("JWS Payload must be a string or an Uint8Array instance");let l=!1;"function"==typeof t?(t=await t(n,e),l=!0,ur(i,t,"verify"),Ne(t)&&(t=await So(t,i))):ur(i,t,"verify");let c,d,u=xr(ge.encode(e.protected??""),ge.encode("."),"string"==typeof e.payload?ge.encode(e.payload):e.payload);try{c=Ce(e.signature)}catch{throw new Qt("Failed to base64url decode the signature")}if(!await Eo(i,t,c,u))throw new fr;if(a)try{d=Ce(e.payload)}catch{throw new Qt("Failed to base64url decode the payload")}else d="string"==typeof e.payload?ge.encode(e.payload):e.payload;let h={payload:d};return void 0!==e.protected&&(h.protectedHeader=n),void 0!==e.header&&(h.unprotectedHeader=e.header),l?{...h,key:t}:h}async function Po(e,t,r){if(e instanceof Uint8Array&&(e=_e.decode(e)),"string"!=typeof e)throw new Qt("Compact JWS must be a string or Uint8Array");let{0:n,1:o,2:a,length:i}=e.split(".");if(3!==i)throw new Qt("Invalid Compact JWS");let s=await Ao({payload:o,protected:n,signature:a},t,r),l={payload:s.payload,protectedHeader:s.protectedHeader};return"function"==typeof t?{...l,key:s.key}:l}l(Ao,"flattenedVerify"),l(Po,"compactVerify");var Ae=l((e=>Math.floor(e.getTime()/1e3)),"default"),Hn=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,Je=l((e=>{let t=Hn.exec(e);if(!t||t[4]&&t[1])throw new TypeError("Invalid time period format");let r,n=parseFloat(t[2]);switch(t[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":r=Math.round(n);break;case"minute":case"minutes":case"min":case"mins":case"m":r=Math.round(60*n);break;case"hour":case"hours":case"hr":case"hrs":case"h":r=Math.round(3600*n);break;case"day":case"days":case"d":r=Math.round(86400*n);break;case"week":case"weeks":case"w":r=Math.round(604800*n);break;default:r=Math.round(31557600*n)}return"-"===t[1]||"ago"===t[4]?-r:r}),"default"),Ro=l((e=>e.toLowerCase().replace(/^application\//,"")),"normalizeTyp"),jn=l(((e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)))),"checkAudiencePresence"),Io=l(((e,t,r={})=>{let n;try{n=JSON.parse(_e.decode(t))}catch{}if(!we(n))throw new De("JWT Claims Set must be a top-level JSON object");let{typ:o}=r;if(o&&("string"!=typeof e.typ||Ro(e.typ)!==Ro(o)))throw new ye('unexpected "typ" JWT header value',n,"typ","check_failed");let a,{requiredClaims:i=[],issuer:s,subject:l,audience:c,maxTokenAge:d}=r,u=[...i];void 0!==d&&u.push("iat"),void 0!==c&&u.push("aud"),void 0!==l&&u.push("sub"),void 0!==s&&u.push("iss");for(let e of new Set(u.reverse()))if(!(e in n))throw new ye(`missing required "${e}" claim`,n,e,"missing");if(s&&!(Array.isArray(s)?s:[s]).includes(n.iss))throw new ye('unexpected "iss" claim value',n,"iss","check_failed");if(l&&n.sub!==l)throw new ye('unexpected "sub" claim value',n,"sub","check_failed");if(c&&!jn(n.aud,"string"==typeof c?[c]:c))throw new ye('unexpected "aud" claim value',n,"aud","check_failed");switch(typeof r.clockTolerance){case"string":a=Je(r.clockTolerance);break;case"number":a=r.clockTolerance;break;case"undefined":a=0;break;default:throw new TypeError("Invalid clockTolerance option type")}let{currentDate:h}=r,p=Ae(h||new Date);if((void 0!==n.iat||d)&&"number"!=typeof n.iat)throw new ye('"iat" claim must be a number',n,"iat","invalid");if(void 0!==n.nbf){if("number"!=typeof n.nbf)throw new ye('"nbf" claim must be a number',n,"nbf","invalid");if(n.nbf>p+a)throw new ye('"nbf" claim timestamp check failed',n,"nbf","check_failed")}if(void 0!==n.exp){if("number"!=typeof n.exp)throw new ye('"exp" claim must be a number',n,"exp","invalid");if(n.exp<=p-a)throw new er('"exp" claim timestamp check failed',n,"exp","check_failed")}if(d){let e=p-n.iat;if(e-a>("number"==typeof d?d:Je(d)))throw new er('"iat" claim timestamp check failed (too far in the past)',n,"iat","check_failed");if(e<0-a)throw new ye('"iat" claim timestamp check failed (it should be in the past)',n,"iat","check_failed")}return n}),"default");async function qr(e,t,r){let n=await Po(e,t,r);if(n.protectedHeader.crit?.includes("b64")&&!1===n.protectedHeader.b64)throw new De("JWTs MUST NOT use unencoded payload");let o={payload:Io(n.protectedHeader,n.payload,r),protectedHeader:n.protectedHeader};return"function"==typeof t?{...o,key:n.key}:o}l(qr,"jwtVerify");var Kn=l((async(e,t,r)=>{let n=await pr(e,t,"sign");_r(e,n);let o=await Ue.subtle.sign(hr(e,n.algorithm),n,r);return new Uint8Array(o)}),"sign"),To=Kn,Er=class{static{l(this,"FlattenedSign")}constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){if(!this._protectedHeader&&!this._unprotectedHeader)throw new Qt("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!wr(this._protectedHeader,this._unprotectedHeader))throw new Qt("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let r={...this._protectedHeader,...this._unprotectedHeader},n=!0;if(Cr(Qt,new Map([["b64",!0]]),t?.crit,this._protectedHeader,r).has("b64")&&(n=this._protectedHeader.b64,"boolean"!=typeof n))throw new Qt('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:o}=r;if("string"!=typeof o||!o)throw new Qt('JWS "alg" (Algorithm) Header Parameter missing or invalid');ur(o,e,"sign");let a,i=this._payload;n&&(i=ge.encode(vr(i))),a=this._protectedHeader?ge.encode(vr(JSON.stringify(this._protectedHeader))):ge.encode("");let s=xr(a,ge.encode("."),i),l=await To(o,e,s),c={signature:vr(l),payload:""};return n&&(c.payload=_e.decode(i)),this._unprotectedHeader&&(c.header=this._unprotectedHeader),this._protectedHeader&&(c.protected=_e.decode(a)),c}},Ar=class{static{l(this,"CompactSign")}constructor(e){this._flattened=new Er(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){let r=await this._flattened.sign(e,t);if(void 0===r.payload)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}};function Ge(e,t){if(!Number.isFinite(t))throw new TypeError(`Invalid ${e} input`);return t}l(Ge,"validateInput");var Pr=class{static{l(this,"ProduceJWT")}constructor(e={}){if(!we(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:Ge("setNotBefore",e)}:e instanceof Date?this._payload={...this._payload,nbf:Ge("setNotBefore",Ae(e))}:this._payload={...this._payload,nbf:Ae(new Date)+Je(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:Ge("setExpirationTime",e)}:e instanceof Date?this._payload={...this._payload,exp:Ge("setExpirationTime",Ae(e))}:this._payload={...this._payload,exp:Ae(new Date)+Je(e)},this}setIssuedAt(e){return typeof e>"u"?this._payload={...this._payload,iat:Ae(new Date)}:e instanceof Date?this._payload={...this._payload,iat:Ge("setIssuedAt",Ae(e))}:this._payload="string"==typeof e?{...this._payload,iat:Ge("setIssuedAt",Ae(new Date)+Je(e))}:{...this._payload,iat:Ge("setIssuedAt",e)},this}},mr=class extends Pr{static{l(this,"SignJWT")}setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){let r=new Ar(ge.encode(JSON.stringify(this._payload)));if(r.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new De("JWTs MUST NOT use unencoded payload");return r.sign(e,t)}},No=gr(eo());async function Do(){let e=`\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>${atob("QlBC")} Login</title>\n    <style>\n        :root {\n            --color: black;\n            --primary-color: #09639f;\n            --header-color: #09639f; \n            --background-color: #fff;\n            --form-background-color: #f9f9f9;\n            --lable-text-color: #333;\n            --h2-color: #3b3b3b;\n            --border-color: #ddd;\n            --input-background-color: white;\n            --header-shadow: 2px 2px 4px rgba(0, 0, 0, 0.25);\n        }\n        html, body { height: 100%; margin: 0; }\n        body {\n            font-family: system-ui;\n            background-color: var(--background-color);\n            position: relative;\n            overflow: hidden;\n        }\n        body.dark-mode {\n            --color: white;\n            --primary-color: #09639F;\n            --header-color: #3498DB; \n            --background-color: #121212;\n            --form-background-color: #121212;\n            --lable-text-color: #DFDFDF;\n            --h2-color: #D5D5D5;\n            --border-color: #353535;\n            --input-background-color: #252525;\n            --header-shadow: 2px 2px 4px rgba(255, 255, 255, 0.25);\n        }\n        html, body { height: 100%; margin: 0; }\n        .container {\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            width: 90%;\n        }\n        h1 { font-size: 2.5rem; text-align: center; color: var(--header-color); margin: 0 auto 30px; text-shadow: var(--header-shadow); }        \n        h2 { text-align: center; color: var(--h2-color) }\n        .form-container {\n            background: var(--form-background-color);\n            border: 1px solid var(--border-color);\n            border-radius: 10px;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n            padding: 20px;\n        }\n        .form-control { margin-bottom: 15px; display: flex; align-items: center; }\n        label {\n            display: block;\n            margin-bottom: 5px;\n            padding-right: 20px;\n            font-size: 110%;\n            font-weight: 600;\n            color: var(--lable-text-color);\n        }\n        input[type="text"],\n        input[type="password"] {\n            width: 100%;\n            padding: 10px;\n            border: 1px solid var(--border-color);\n            border-radius: 5px;\n            color: var(--lable-text-color);\n            background-color: var(--input-background-color);\n        }\n        button {\n            display: block;\n            width: 100%;\n            padding: 10px;\n            font-size: 16px;\n            font-weight: 600;\n            border: none;\n            border-radius: 5px;\n            color: white;\n            background-color: var(--primary-color);\n            cursor: pointer;\n            transition: background-color 0.3s ease;\n        }\n        .button:hover,\n        button:focus {\n            background-color: #2980b9;\n            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);\n            transform: translateY(-2px);\n        }\n        button.button:hover { color: white; }\n        .button:active { transform: translateY(1px); box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3); }\n        @media only screen and (min-width: 768px) {\n            .container { width: 30%; }\n        }\n    </style>\n    </head>\n    <body>\n        <div class="container">\n            <h1>${atob("QlBC")} Panel <span style="font-size: smaller;">${globalThis.panelVersion}</span> </h1>\n            <div class="form-container">\n                <h2>User Login</h2>\n                <form id="loginForm">\n                    <div class="form-control">\n                        <label for="password">Password</label>\n                        <input type="password" id="password" name="password" required>\n                    </div>\n                    <div id="passwordError" style="color: red; margin-bottom: 10px;"></div>\n                    <button type="submit" class="button">Login</button>\n                </form>\n            </div>\n        </div>\n    <script>\n        localStorage.getItem('darkMode') === 'enabled' && document.body.classList.add('dark-mode');\n        document.getElementById('loginForm').addEventListener('submit', async (event) => {\n            event.preventDefault();\n            const password = document.getElementById('password').value;\n\n            try {\n                const response = await fetch('/login', {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'text/plain'\n                    },\n                    body: password\n                });\n            \n                if (!response.ok) {\n                    passwordError.textContent = ' Wrong Password!';\n                    const errorMessage = await response.text();\n                    console.error('Login failed:', errorMessage);\n                    return;\n                }\n                window.location.href = '/panel';\n            } catch (error) {\n                console.error('Error during login:', error);\n            }\n        });\n    <\/script>\n    </body>\n    </html>`;return new Response(e,{status:200,headers:{"Content-Type":"text/html;charset=utf-8","Access-Control-Allow-Origin":globalThis.urlOrigin,"Access-Control-Allow-Methods":"GET, POST","Access-Control-Allow-Headers":"Content-Type, Authorization","X-Content-Type-Options":"nosniff","X-Frame-Options":"DENY","Referrer-Policy":"strict-origin-when-cross-origin","Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate, no-transform","CDN-Cache-Control":"no-store"}})}async function Vn(e,t){if(await e.text()!==await t.kv.get("pwd"))return new Response("Method Not Allowed",{status:405});let r=await t.kv.get("secretKey");r||(r=Jn(),await t.kv.put("secretKey",r));let n=(new TextEncoder).encode(r),o=await new mr({userID:globalThis.userID}).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("24h").sign(n);return new Response("Success",{status:200,headers:{"Set-Cookie":`jwtToken=${o}; HttpOnly; Secure; Max-Age=604800; Path=/; SameSite=Strict`,"Content-Type":"text/plain"}})}function Jn(){let e=No.default.randomBytes(32);return Array.from(e,(e=>e.toString(16).padStart(2,"0"))).join("")}async function Ze(e,t){try{let r=await t.kv.get("secretKey"),n=(new TextEncoder).encode(r),o=e.headers.get("Cookie")?.match(/(^|;\s*)jwtToken=([^;]*)/),a=o?o[2]:null;if(!a)return console.log("Unauthorized: Token not available!"),!1;let{payload:i}=await qr(a,n);return console.log(`Successfully authenticated, User ID: ${i.userID}`),!0}catch(e){return console.log(e),!1}}function Bo(){return new Response("Success",{status:200,headers:{"Set-Cookie":"jwtToken=; Secure; SameSite=None; Expires=Thu, 01 Jan 1970 00:00:00 GMT","Content-Type":"text/plain"}})}async function Fo(e,t){let r=await Ze(e,t),n=await t.kv.get("pwd");if(n&&!r)return new Response("Unauthorized!",{status:401});let o=await e.text();return o===n?new Response("Please enter a new Password!",{status:400}):(await t.kv.put("pwd",o),new Response("Success",{status:200,headers:{"Set-Cookie":"jwtToken=; Path=/; Secure; SameSite=None; Expires=Thu, 01 Jan 1970 00:00:00 GMT","Content-Type":"text/plain"}}))}async function $o(e,t){return await Ze(e,t)?Response.redirect(`${globalThis.urlOrigin}/panel`,302):"POST"===e.method?await Vn(e,t):await Do()}async function Oe(e,t){let r=await br(globalThis.hostName),n=t?r.ipv6.map((e=>`[${e}]`)):[];return[globalThis.hostName,"www.speedtest.net",...r.ipv4,...n,...e?e.split(","):[]]}function ze(e,t){let r=t?1:0,n=e[r].account.config;return{warpIPv6:`${n.interface.addresses.v6}/128`,reserved:n.client_id,publicKey:n.peers[0].public_key,privateKey:e[r].privateKey}}function Be(e,t,r,n,o,a){let i,s=a?` ${a}`:"";return i=n.includes(r)?"Clean IP":qt(r)?"Domain":Tr(r)?"IPv4":Ye(r)?"IPv6":"",` ${e} - ${o}${s} - ${i} : ${t}`}function Me(e){let t="";for(let r=0;r<e.length;r++)t+=Math.random()<.5?e[r].toUpperCase():e[r];return t}function Se(e){let t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<e;n++)t+=r.charAt(Math.floor(62*Math.random()));return t}function Ir(e){let t=atob(e);return Array.from(t).map((e=>e.charCodeAt(0).toString(16).padStart(2,"0"))).join("").match(/.{2}/g).map((e=>parseInt(e,16)))}function Tr(e){return/^(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\/([0-9]|[1-2][0-9]|3[0-2]))?$/.test(e)}function Ye(e){return/^\[(?:(?:[a-fA-F0-9]{1,4}:){7}[a-fA-F0-9]{1,4}|(?:[a-fA-F0-9]{1,4}:){1,7}:|::(?:[a-fA-F0-9]{1,4}:){0,7}|(?:[a-fA-F0-9]{1,4}:){1,6}:[a-fA-F0-9]{1,4}|(?:[a-fA-F0-9]{1,4}:){1,5}(?::[a-fA-F0-9]{1,4}){1,2}|(?:[a-fA-F0-9]{1,4}:){1,4}(?::[a-fA-F0-9]{1,4}){1,3}|(?:[a-fA-F0-9]{1,4}:){1,3}(?::[a-fA-F0-9]{1,4}){1,4}|(?:[a-fA-F0-9]{1,4}:){1,2}(?::[a-fA-F0-9]{1,4}){1,5}|[a-fA-F0-9]{1,4}:(?::[a-fA-F0-9]{1,4}){1,6})\](?:\/(1[0-1][0-9]|12[0-8]|[0-9]?[0-9]))?$/.test(e)}function sr(e){let t=new URL(e).hostname;return{host:t,isHostDomain:qt(t)}}l(Do,"renderLoginPage"),l(Vn,"generateJWTToken"),l(Jn,"generateSecretKey"),l(Ze,"Authenticate"),l(Bo,"logout"),l(Fo,"resetPassword"),l($o,"login"),l(Oe,"getConfigAddresses"),l(ze,"extractWireguardParams"),l(Be,"generateRemark"),l(Me,"randomUpperCase"),l(Se,"getRandomPath"),l(Ir,"base64ToDecimal"),l(Tr,"isIPv4"),l(Ye,"isIPv6"),l(sr,"getDomain");var ro=gr(eo());async function oo(e){let t=[],r=[Uo(),Uo()],n={install_id:"",fcm_token:"",tos:(new Date).toISOString(),type:"Android",model:"PC",locale:"en_US",warp_enabled:!0},o=l((async e=>await(await fetch("https://api.cloudflareclient.com/v0a4005/reg",{method:"POST",headers:{"User-Agent":"insomnia/8.6.1","Content-Type":"application/json"},body:JSON.stringify({...n,key:e.publicKey})})).json()),"fetchAccount");for(let e of r){let r=await o(e);t.push({privateKey:e.privateKey,account:r})}let a=JSON.stringify(t);return await e.kv.put("warpConfigs",a),{error:null,configs:a}}l(oo,"fetchWarpConfigs");var Uo=l((()=>{let e=l((e=>btoa(String.fromCharCode.apply(null,e))),"base64Encode"),t=ro.default.randomBytes(32);return t[0]&=248,t[31]&=127,t[31]|=64,{publicKey:e(ro.default.scalarMult.base(t)),privateKey:e(t)}}),"generateKeyPair");async function be(e,t){let r,n;try{r=await t.kv.get("proxySettings",{type:"json"}),n=await t.kv.get("warpConfigs",{type:"json"})}catch(e){throw console.log(e),new Error(`An error occurred while getting KV - ${e}`)}if(!r){r=await Dr(e,t);let{error:o,configs:a}=await oo(t,r);if(o)throw new Error(`An error occurred while getting Warp configs - ${o}`);n=a}return globalThis.panelVersion!==r.panelVersion&&(r=await Dr(e,t)),{proxySettings:r,warpConfigs:n}}async function Dr(e,t){let r,n="POST"===e.method?await e.formData():null,o="true"===n?.get("resetSettings"),a=[];if(o)n=null;else{try{r=await t.kv.get("proxySettings",{type:"json"})}catch(e){throw console.log(e),new Error(`An error occurred while getting current KV settings - ${e}`)}let e=n?.getAll("udpXrayNoiseMode")||[],o=n?.getAll("udpXrayNoisePacket")||[],i=n?.getAll("udpXrayNoiseDelayMin")||[],s=n?.getAll("udpXrayNoiseDelayMax")||[],l=n?.getAll("udpXrayNoiseCount")||[];a.push(...e.map(((e,t)=>({type:e,packet:o[t],delay:`${i[t]}-${s[t]}`,count:l[t]}))))}let i=l((e=>{let t=n?.get(e);return void 0===t?null:"true"===t||"false"!==t&&t}),"validateField"),s={remoteDNS:i("remoteDNS")??r?.remoteDNS??"https://8.8.8.8/dns-query",localDNS:i("localDNS")??r?.localDNS??"8.8.8.8",VLTRFakeDNS:i("VLTRFakeDNS")??r?.VLTRFakeDNS??!1,proxyIP:i("proxyIP")?.replaceAll(" ","")??r?.proxyIP??"",outProxy:i("outProxy")??r?.outProxy??"",outProxyParams:Gn(i("outProxy"))??r?.outProxyParams??{},cleanIPs:i("cleanIPs")?.replaceAll(" ","")??r?.cleanIPs??"",enableIPv6:i("enableIPv6")??r?.enableIPv6??!0,customCdnAddrs:i("customCdnAddrs")?.replaceAll(" ","")??r?.customCdnAddrs??"",customCdnHost:i("customCdnHost")?.trim()??r?.customCdnHost??"",customCdnSni:i("customCdnSni")?.trim()??r?.customCdnSni??"",bestVLTRInterval:i("bestVLTRInterval")??r?.bestVLTRInterval??"30",VLConfigs:i("VLConfigs")??r?.VLConfigs??!0,TRConfigs:i("TRConfigs")??r?.TRConfigs??!1,ports:i("ports")?.split(",")??r?.ports??["443"],lengthMin:i("fragmentLengthMin")??r?.lengthMin??"100",lengthMax:i("fragmentLengthMax")??r?.lengthMax??"200",intervalMin:i("fragmentIntervalMin")??r?.intervalMin??"1",intervalMax:i("fragmentIntervalMax")??r?.intervalMax??"1",fragmentPackets:i("fragmentPackets")??r?.fragmentPackets??"tlshello",bypassLAN:i("bypass-lan")??r?.bypassLAN??!1,bypassIran:i("bypass-iran")??r?.bypassIran??!1,bypassChina:i("bypass-china")??r?.bypassChina??!1,bypassRussia:i("bypass-russia")??r?.bypassRussia??!1,blockAds:i("block-ads")??r?.blockAds??!1,blockPorn:i("block-porn")??r?.blockPorn??!1,blockUDP443:i("block-udp-443")??r?.blockUDP443??!1,customBypassRules:i("customBypassRules")?.replaceAll(" ","")??r?.customBypassRules??"",customBlockRules:i("customBlockRules")?.replaceAll(" ","")??r?.customBlockRules??"",warpEndpoints:i("warpEndpoints")?.replaceAll(" ","")??r?.warpEndpoints??"engage.cloudflareclient.com:2408",warpFakeDNS:i("warpFakeDNS")??r?.warpFakeDNS??!1,warpEnableIPv6:i("warpEnableIPv6")??r?.warpEnableIPv6??!0,bestWarpInterval:i("bestWarpInterval")??r?.bestWarpInterval??"30",xrayUdpNoises:(a.length?JSON.stringify(a):r?.xrayUdpNoises)??JSON.stringify([{type:"base64",packet:btoa(globalThis.userID),delay:"1-1",count:"1"}]),hiddifyNoiseMode:i("hiddifyNoiseMode")??r?.hiddifyNoiseMode??"m4",nikaNGNoiseMode:i("nikaNGNoiseMode")??r?.nikaNGNoiseMode??"quic",noiseCountMin:i("noiseCountMin")??r?.noiseCountMin??"10",noiseCountMax:i("noiseCountMax")??r?.noiseCountMax??"15",noiseSizeMin:i("noiseSizeMin")??r?.noiseSizeMin??"5",noiseSizeMax:i("noiseSizeMax")??r?.noiseSizeMax??"10",noiseDelayMin:i("noiseDelayMin")??r?.noiseDelayMin??"1",noiseDelayMax:i("noiseDelayMax")??r?.noiseDelayMax??"1",amneziaNoiseCount:i("amneziaNoiseCount")??r?.amneziaNoiseCount??"5",amneziaNoiseSizeMin:i("amneziaNoiseSizeMin")??r?.amneziaNoiseSizeMin??"50",amneziaNoiseSizeMax:i("amneziaNoiseSizeMax")??r?.amneziaNoiseSizeMax??"100",panelVersion:globalThis.panelVersion};try{await t.kv.put("proxySettings",JSON.stringify(s)),o&&await no(e,t)}catch(e){throw console.log(e),new Error(`An error occurred while updating KV - ${e}`)}return s}function Gn(e){let t={};if(!e)return{};let r=new URL(e),n=r.protocol.slice(0,-1);if(n===atob("dmxlc3M=")){let e=new URLSearchParams(r.search);t={protocol:n,uuid:r.username,server:r.hostname,port:r.port},e.forEach(((e,r)=>{t[r]=e}))}else t={protocol:n,user:r.username,pass:r.password,server:r.host,port:r.port};return JSON.stringify(t)}async function no(e,t){if(!await Ze(e,t))return new Response("Unauthorized",{status:401});if("POST"!==e.method)return new Response("Unsupported request",{status:405});try{let{error:e}=await oo(t);return e?new Response(e,{status:400}):new Response("Warp configs updated successfully",{status:200})}catch(e){return console.log(e),new Response(`An error occurred while updating Warp configs! - ${e}`,{status:500})}}async function Oo(e,t){let{remoteDNS:r,localDNS:n,VLTRFakeDNS:o,proxyIP:a,outProxy:i,cleanIPs:s,enableIPv6:c,customCdnAddrs:d,customCdnHost:u,customCdnSni:h,bestVLTRInterval:p,VLConfigs:f,TRConfigs:m,ports:g,lengthMin:y,lengthMax:b,intervalMin:v,intervalMax:w,fragmentPackets:_,warpEndpoints:x,warpFakeDNS:k,warpEnableIPv6:S,bestWarpInterval:C,xrayUdpNoises:E,hiddifyNoiseMode:A,nikaNGNoiseMode:P,noiseCountMin:I,noiseCountMax:R,noiseSizeMin:T,noiseSizeMax:N,noiseDelayMin:D,noiseDelayMax:$,amneziaNoiseCount:B,amneziaNoiseSizeMin:M,amneziaNoiseSizeMax:z,bypassLAN:U,bypassIran:O,bypassChina:F,bypassRussia:L,blockAds:W,blockPorn:H,blockUDP443:j,customBypassRules:J,customBlockRules:V}=e,K=(f?1:0)+(m?1:0),q="",G="";[...globalThis.hostName.includes("workers.dev")?globalThis.defaultHttpPorts:[],...globalThis.defaultHttpsPorts].forEach((e=>{let t=`port-${e}`,r=`\n            <div class="routing" style="grid-template-columns: 1fr 2fr; margin-right: 10px;">\n                <input type="checkbox" id=${t} name=${e} onchange="handlePortChange(event)" value="true" ${g.includes(e)?"checked":""}>\n                <label style="margin-bottom: 3px;" for=${t}>${e}</label>\n            </div>`;globalThis.defaultHttpsPorts.includes(e)?G+=r:q+=r}));let Z="";JSON.parse(E).forEach(((e,t)=>{Z+=`\n            <div id="udp-noise-container-${t}" class="udp-noise">\n                <div class="header-container">\n                    <h4 style="margin: 0 5px;">Noise ${t+1}</h4>\n                    <button type="button" onclick="deleteUdpNoise(this)" style="background: none; margin: 0; border: none; cursor: pointer;">\n                        <i class="fa fa-minus-circle fa-2x" style="color: var(--button-color);" aria-hidden="true"></i>\n                    </button>      \n                </div>\n                <div class="form-control">\n                    <label for="udpXrayNoiseMode-${t}"> v2ray Mode</label>\n                    <div class="input-with-select">\n                        <select id="udpXrayNoiseMode-${t}" name="udpXrayNoiseMode">\n                            <option value="base64" ${"base64"===e.type?"selected":""}>Base64</option>\n                            <option value="rand" ${"rand"===e.type?"selected":""}>Random</option>\n                            <option value="str" ${"str"===e.type?"selected":""}>String</option>\n                            <option value="hex" ${"hex"===e.type?"selected":""}>Hex</option>\n                        </select>\n                    </div>\n                </div>\n                <div class="form-control">\n                    <label for="udpXrayNoisePacket-${t}"> Noise Packet</label>\n                    <input type="text" id="udpXrayNoisePacket-${t}" name="udpXrayNoisePacket" value="${e.packet}">\n                </div>\n                <div class="form-control">\n                    <label for="udpXrayNoiseDelayMin-${t}"> Noise Delay</label>\n                    <div class="min-max">\n                        <input type="number" id="udpXrayNoiseDelayMin-${t}" name="udpXrayNoiseDelayMin"\n                            value="${e.delay.split("-")[0]}" min="1" required>\n                        <span> - </span>\n                        <input type="number" id="udpXrayNoiseDelayMax-${t}" name="udpXrayNoiseDelayMax"\n                            value="${e.delay.split("-")[1]}" min="1" required>\n                    </div>\n                </div>\n                <div class="form-control">\n                    <label for="udpXrayNoiseCount-${t}"> Noise Count</label>\n                    <input type="number" id="udpXrayNoiseCount-${t}" name="udpXrayNoiseCount" value="${e.count}" min="1" required>\n                </div>\n            </div>`}));let Q=l((e=>e.map((e=>`\n        <div>\n            <span class="material-symbols-outlined symbol">verified</span>\n            <span>${e}</span>\n        </div>`)).join("")),"supportedApps"),X=l(((e,t,r,n,o,a)=>{let i=`${o?"sing-box://import-remote-profile?url=":""}${a?"hiddify://import/":""}https://${globalThis.hostName}/${e}/${globalThis.subPath}${t?`?app=${t}`:""}#${r}`;return`\n            <button onclick="openQR('${encodeURI(i)}', '${n}')">\n                QR Code&nbsp;<span class="material-symbols-outlined">qr_code</span>\n            </button>`}),"subQR"),Y=l(((e,t,r,n)=>{let o=`${n?"hiddify://import/":""}https://${globalThis.hostName}/${e}/${globalThis.subPath}${t?`?app=${t}`:""}#${r}`;return`\n            <button onclick="copyToClipboard('${encodeURI(o)}')">\n                Copy Sub<span class="material-symbols-outlined">format_list_bulleted</span>\n            </button>`}),"subURL"),ee=l(((e,t)=>`\n            <button onclick="dlURL('https://${globalThis.hostName}/${e}/${globalThis.subPath}${t?`?app=${t}`:""}')">\n                Get config<span class="material-symbols-outlined">download</span>\n            </button>`),"dlConfig"),te=`\n    const defaultHttpsPorts = ['443', '8443', '2053', '2083', '2087', '2096'];\n    let activePortsNo = ${g.length};\n    let activeHttpsPortsNo = ${g.filter((e=>globalThis.defaultHttpsPorts.includes(e))).length};\n    let activeProtocols = ${K};\n    localStorage.getItem('darkMode') === 'enabled' && document.body.classList.add('dark-mode');\n\n    document.addEventListener('DOMContentLoaded', async () => {\n        const configForm = document.getElementById('configForm');            \n        const changePass = document.getElementById('openModalBtn');\n        const closeBtn = document.querySelector(".close");\n        const passwordChangeForm = document.getElementById('passwordChangeForm');                    \n        const initialFormData = new FormData(configForm);\n        const modal = document.getElementById('myModal');\n        const closeQR = document.getElementById('closeQRModal');\n        const resetSettings = document.getElementById('resetSettings');\n        let modalQR = document.getElementById('myQRModal');\n        let qrcodeContainer = document.getElementById('qrcode-container');\n        let forcedPassChange = false;\n        const darkModeToggle = document.getElementById('darkModeToggle');\n                \n        const hasFormDataChanged = () => {\n            const currentFormData = new FormData(configForm);\n            const currentFormDataEntries = [...currentFormData.entries()];\n\n            const nonCheckboxFieldsChanged = currentFormDataEntries.some(\n                ([key, value]) => !initialFormData.has(key) || initialFormData.get(key) !== value\n            );\n\n            const checkboxFieldsChanged = Array.from(configForm.elements)\n                .filter((element) => element.type === 'checkbox')\n                .some((checkbox) => {\n                const initialValue = initialFormData.has(checkbox.name)\n                    ? initialFormData.get(checkbox.name)\n                    : false;\n                const currentValue = currentFormDataEntries.find(([key]) => key === checkbox.name)?.[1] || false;\n                return initialValue !== currentValue;\n            });\n\n            return nonCheckboxFieldsChanged || checkboxFieldsChanged;\n        };\n        \n        const enableApplyButton = () => {\n            const isChanged = hasFormDataChanged();\n            applyButton.disabled = !isChanged;\n            applyButton.classList.toggle('disabled', !isChanged);\n        };\n                    \n        passwordChangeForm.addEventListener('submit', event => resetPassword(event));\n        document.getElementById('logout').addEventListener('click', event => logout(event));\n        configForm.addEventListener('submit', (event) => applySettings(event, configForm));\n        configForm.addEventListener('input', enableApplyButton);\n        configForm.addEventListener('change', enableApplyButton);\n        changePass.addEventListener('click', () => {\n            forcedPassChange ? closeBtn.style.display = 'none' : closeBtn.style.display = '';\n            modal.style.display = "block";\n            document.body.style.overflow = "hidden";\n            forcedPassChange = false;\n        });        \n        closeBtn.addEventListener('click', () => {\n            modal.style.display = "none";\n            document.body.style.overflow = "";\n        });\n        closeQR.addEventListener('click', () => {\n            modalQR.style.display = "none";\n            qrcodeContainer.lastElementChild.remove();\n        });\n        resetSettings.addEventListener('click', async () => {\n            const confirmReset = confirm(' This will reset all panel settings.\\nAre you sure?');\n            if(!confirmReset) return;\n            const formData = new FormData();\n            formData.append('resetSettings', 'true');\n            try {\n                document.body.style.cursor = 'wait';\n                const refreshButtonVal = refreshBtn.innerHTML;\n                refreshBtn.innerHTML = ' Loading...';\n\n                const response = await fetch('/panel', {\n                    method: 'POST',\n                    body: formData,\n                    credentials: 'include'\n                });\n\n                document.body.style.cursor = 'default';\n                refreshBtn.innerHTML = refreshButtonVal;\n                if (!response.ok) {\n                    const errorMessage = await response.text();\n                    console.error(errorMessage, response.status);\n                    alert(' An error occured, Please try again!\\n ' + errorMessage);\n                    return;\n                }       \n                alert(' Panel settings reset to default successfully! ');\n                window.location.reload(true);\n            } catch (error) {\n                console.error('Error:', error);\n            }\n        });\n        window.onclick = (event) => {\n            if (event.target == modalQR) {\n                modalQR.style.display = "none";\n                qrcodeContainer.lastElementChild.remove();\n            }\n        }\n        darkModeToggle.addEventListener('click', () => {\n            const isDarkMode = document.body.classList.toggle('dark-mode');\n            localStorage.setItem('darkMode', isDarkMode ? 'enabled' : 'disabled');\n        });\n\n        const isPassSet = ${t};\n        if (!isPassSet) {\n            forcedPassChange = true;\n            changePass.click();\n        }\n\n        await fetchIPInfo();\n    });\n\n    const downloadWarpConfigs = async (isAmnezia) => {\n        const client = isAmnezia ? "?app=amnezia" : "";\n        window.location.href = "/get-warp-configs" + client;\n    }\n\n    const dlURL = async (url) => {\n        try {\n            const response = await fetch(url);\n            if (!response.ok) {\n                throw new Error('Network response was not ok');\n            }\n            const data = await response.json();\n            const blob = new Blob([JSON.stringify(data, null, 4)], { type: 'application/json' });\n            const link = document.createElement('a');\n            link.href = URL.createObjectURL(blob);\n            link.download = 'config.json';\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n        } catch (error) {\n            console.error('There was a problem with the fetch operation:', error);\n        }\n    };\n\n    const fetchIPInfo = async () => {\n        const updateUI = (ip = '-', country = '-', countryCode = '-', city = '-', isp = '-', cfIP) => {\n            const flag = countryCode !== '-' ? String.fromCodePoint(...[...countryCode].map(c => 0x1F1E6 + c.charCodeAt(0) - 65)) : '';\n            document.getElementById(cfIP ? 'cf-ip' : 'ip').textContent = ip;\n            document.getElementById(cfIP ? 'cf-country' : 'country').textContent = country + ' ' + flag;\n            document.getElementById(cfIP ? 'cf-city' : 'city').textContent = city;\n            document.getElementById(cfIP ? 'cf-isp' : 'isp').textContent = isp;\n        };\n\n        const refreshIcon = document.getElementById("refresh-geo-location").querySelector('i');\n        refreshIcon.classList.add('fa-spin');\n        document.body.style.cursor = 'wait';\n\n        try {\n            const ipResponse = await fetch('https://ipwho.is/' + '?nocache=' + Date.now(), { cache: "no-store" });\n            const ipResponseObj = await ipResponse.json();\n            const geoResponse = await fetch('/my-ip', { \n                method: 'POST',\n                body: ipResponseObj.ip\n            });\n            const ipGeoLocation = await geoResponse.json();\n            updateUI(ipResponseObj.ip, ipGeoLocation.country, ipGeoLocation.countryCode, ipGeoLocation.city, ipGeoLocation.isp);\n            const cfIPresponse = await fetch('https://ipv4.icanhazip.com/?nocache=' + Date.now(), { cache: "no-store" });\n            const cfIP = await cfIPresponse.text();\n            const cfGeoResponse = await fetch('/my-ip', { \n                method: 'POST',\n                body: cfIP.trim()\n            });\n            const cfIPGeoLocation = await cfGeoResponse.json();\n            updateUI(cfIP, cfIPGeoLocation.country, cfIPGeoLocation.countryCode, cfIPGeoLocation.city, cfIPGeoLocation.isp, true);\n            refreshIcon.classList.remove('fa-spin');\n            document.body.style.cursor = 'default';\n        } catch (error) {\n            console.error('Error fetching IP address:', error);\n        }\n    }\n\n    const addUdpNoise = () => {\n        const container = document.getElementById("udp-noise-container");\n        const noiseBlock = document.getElementById("udp-noise-container-0");\n        const index = container.children.length;\n        const clone = noiseBlock.cloneNode(true);\n        clone.querySelector("h4").textContent = "Noise " + String(index + 1);\n        container.appendChild(clone);\n        document.getElementById("configForm").dispatchEvent(new Event("change"));\n    }\n    \n    const deleteUdpNoise = (button) => {\n        const container = document.getElementById("udp-noise-container");\n        if (container.children.length === 1) {\n            alert(' You cannot delete all noises!');\n            return;\n        }   \n        const confirmReset = confirm(' This will delete the noise.\\nAre you sure?');\n        if(!confirmReset) return;\n        button.closest(".udp-noise").remove();\n        document.getElementById("configForm").dispatchEvent(new Event("change"));\n    }\n\n    const getWarpConfigs = async () => {\n        const confirmReset = confirm(' Are you sure?');\n        if(!confirmReset) return;\n        const refreshBtn = document.getElementById('refreshBtn');\n\n        try {\n            document.body.style.cursor = 'wait';\n            const refreshButtonVal = refreshBtn.innerHTML;\n            refreshBtn.innerHTML = ' Loading...';\n\n            const response = await fetch('/update-warp', {\n                method: 'POST',\n                credentials: 'include'\n            });\n\n            document.body.style.cursor = 'default';\n            refreshBtn.innerHTML = refreshButtonVal;\n            if (!response.ok) {\n                const errorMessage = await response.text();\n                console.error(errorMessage, response.status);\n                alert(' An error occured, Please try again!\\n ' + errorMessage);\n                return;\n            }          \n            alert(' Warp configs updated successfully! ');\n        } catch (error) {\n            console.error('Error:', error);\n        } \n    }\n\n    const handlePortChange = (event) => {\n        \n        if(event.target.checked) { \n            activePortsNo++ \n            defaultHttpsPorts.includes(event.target.name) && activeHttpsPortsNo++;\n        } else {\n            activePortsNo--;\n            defaultHttpsPorts.includes(event.target.name) && activeHttpsPortsNo--;\n        }\n\n        if (activePortsNo === 0) {\n            event.preventDefault();\n            event.target.checked = !event.target.checked;\n            alert(" At least one port should be selected! ");\n            activePortsNo = 1;\n            defaultHttpsPorts.includes(event.target.name) && activeHttpsPortsNo++;\n            return false;\n        }\n            \n        if (activeHttpsPortsNo === 0) {\n            event.preventDefault();\n            event.target.checked = !event.target.checked;\n            alert(" At least one TLS(https) port should be selected! ");\n            activeHttpsPortsNo = 1;\n            return false;\n        }\n    }\n    \n    const handleProtocolChange = (event) => {\n        \n        if(event.target.checked) { \n            activeProtocols++ \n        } else {\n            activeProtocols--;\n        }\n\n        if (activeProtocols === 0) {\n            event.preventDefault();\n            event.target.checked = !event.target.checked;\n            alert(" At least one Protocol should be selected! ");\n            activeProtocols = 1;\n            return false;\n        }\n    }\n\n    const openQR = (url, title) => {\n        let qrcodeContainer = document.getElementById("qrcode-container");\n        let qrcodeTitle = document.getElementById("qrcodeTitle");\n        const modalQR = document.getElementById("myQRModal");\n        qrcodeTitle.textContent = title;\n        modalQR.style.display = "block";\n        let qrcodeDiv = document.createElement("div");\n        qrcodeDiv.className = "qrcode";\n        qrcodeDiv.style.padding = "2px";\n        qrcodeDiv.style.backgroundColor = "#ffffff";\n        new QRCode(qrcodeDiv, {\n            text: url,\n            width: 256,\n            height: 256,\n            colorDark: "#000000",\n            colorLight: "#ffffff",\n            correctLevel: QRCode.CorrectLevel.H\n        });\n        qrcodeContainer.appendChild(qrcodeDiv);\n    }\n\n    const copyToClipboard = (text) => {\n        const textarea = document.createElement('textarea');\n        textarea.value = text;\n        document.body.appendChild(textarea);\n        textarea.select();\n        document.execCommand('copy');\n        document.body.removeChild(textarea);\n        alert(' Copied to clipboard:\\n\\n' +  text);\n    }\n\n    const applySettings = async (event, configForm) => {\n        event.preventDefault();\n        event.stopPropagation();\n        const applyButton = document.getElementById('applyButton');\n        const getValue = (id) => parseInt(document.getElementById(id).value, 10);              \n        const lengthMin = getValue('fragmentLengthMin');\n        const lengthMax = getValue('fragmentLengthMax');\n        const intervalMin = getValue('fragmentIntervalMin');\n        const intervalMax = getValue('fragmentIntervalMax');\n        const customCdnAddrs = document.getElementById('customCdnAddrs').value?.split(',').filter(addr => addr !== '');\n        const customCdnHost = document.getElementById('customCdnHost').value;\n        const customCdnSni = document.getElementById('customCdnSni').value;\n        const isCustomCdn = customCdnAddrs.length || customCdnHost !== '' || customCdnSni !== '';\n        const warpEndpoints = document.getElementById('warpEndpoints').value?.replaceAll(' ', '').split(',');\n        const noiseCountMin = getValue('noiseCountMin');\n        const noiseCountMax = getValue('noiseCountMax');\n        const noiseSizeMin = getValue('noiseSizeMin');\n        const noiseSizeMax = getValue('noiseSizeMax');\n        const noiseDelayMin = getValue('noiseDelayMin');\n        const noiseDelayMax = getValue('noiseDelayMax');\n        const cleanIPs = document.getElementById('cleanIPs').value?.split(',');\n        const proxyIPs = document.getElementById('proxyIP').value?.split(',');\n        const chainProxy = document.getElementById('outProxy').value?.trim();\n        const customBypassRules = document.getElementById('customBypassRules').value?.split(',');                    \n        const customBlockRules = document.getElementById('customBlockRules').value?.split(',');                    \n        const formData = new FormData(configForm);\n        const is${atob("Vmxlc3M=")} = /${atob("dmxlc3M=")}:\\/\\/[^s@]+@[^\\s:]+:[^\\s]+/.test(chainProxy);\n        const isSocksHttp = /^(http|socks):\\/\\/(?:([^:@]+):([^:@]+)@)?([^:@]+):(\\d+)$/.test(chainProxy);\n        const hasSecurity = /security=/.test(chainProxy);\n        const securityRegex = /security=(tls|none|reality)/;\n        const validSecurityType = securityRegex.test(chainProxy);\n        let match = chainProxy.match(securityRegex);\n        const securityType = match ? match[1] : null;\n        match = chainProxy.match(/:(\\d+)\\?/);\n        const ${atob("dmxlc3M=")}Port = match ? match[1] : null;\n        const validTransmission = /type=(tcp|grpc|ws)/.test(chainProxy);\n        const validIPDomain = /^((?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\\.)+[a-zA-Z]{2,})|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(?:\\/(?:\\d|[12]\\d|3[0-2]))?|\\[(?:(?:[a-fA-F0-9]{1,4}:){7}[a-fA-F0-9]{1,4}|(?:[a-fA-F0-9]{1,4}:){1,7}:|(?:[a-fA-F0-9]{1,4}:){1,6}:[a-fA-F0-9]{1,4}|(?:[a-fA-F0-9]{1,4}:){1,5}(?::[a-fA-F0-9]{1,4}){1,2}|(?:[a-fA-F0-9]{1,4}:){1,4}(?::[a-fA-F0-9]{1,4}){1,3}|(?:[a-fA-F0-9]{1,4}:){1,3}(?::[a-fA-F0-9]{1,4}){1,4}|(?:[a-fA-F0-9]{1,4}:){1,2}(?::[a-fA-F0-9]{1,4}){1,5}|[a-fA-F0-9]{1,4}:(?::[a-fA-F0-9]{1,4}){1,6}|:(?::[a-fA-F0-9]{1,4}){1,7})\\](?:\\/(?:12[0-8]|1[0-1]\\d|[0-9]?\\d))?)$/i;\n        const validEndpoint = /^(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\\.)+[a-zA-Z]{2,}|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|\\[(?:[a-fA-F0-9]{1,4}:){7}[a-fA-F0-9]{1,4}\\]|\\[(?:[a-fA-F0-9]{1,4}:){1,7}:\\]|\\[(?:[a-fA-F0-9]{1,4}:){1,6}:[a-fA-F0-9]{1,4}\\]|\\[(?:[a-fA-F0-9]{1,4}:){1,5}(?::[a-fA-F0-9]{1,4}){1,2}\\]|\\[(?:[a-fA-F0-9]{1,4}:){1,4}(?::[a-fA-F0-9]{1,4}){1,3}\\]|\\[(?:[a-fA-F0-9]{1,4}:){1,3}(?::[a-fA-F0-9]{1,4}){1,4}\\]|\\[(?:[a-fA-F0-9]{1,4}:){1,2}(?::[a-fA-F0-9]{1,4}){1,5}\\]|\\[[a-fA-F0-9]{1,4}:(?::[a-fA-F0-9]{1,4}){1,6}\\]|\\[:(?::[a-fA-F0-9]{1,4}){1,7}\\]|\\[::(?::[a-fA-F0-9]{1,4}){0,7}\\]):(?:[0-9]{1,5})$/;\n        const checkedPorts = Array.from(document.querySelectorAll('input[id^="port-"]:checked')).map(input => input.id.split('-')[1]);\n        formData.append('ports', checkedPorts);\n        configForm.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {\n            !formData.has(checkbox.name) && formData.append(checkbox.name, 'false');    \n        });\n        const base64Regex = /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/;\n        const udpNoiseModes = formData.getAll('udpXrayNoiseMode') || [];\n        const udpNoisePackets = formData.getAll('udpXrayNoisePacket') || [];\n        const udpNoiseDelaysMin = formData.getAll('udpXrayNoiseDelayMin') || [];\n        const udpNoiseDelaysMax = formData.getAll('udpXrayNoiseDelayMax') || [];\n\n        const invalidIPs = [...cleanIPs, ...proxyIPs, ...customCdnAddrs, ...customBypassRules, ...customBlockRules, customCdnHost, customCdnSni]?.filter(value => {\n            if (value) {\n                const trimmedValue = value.trim();\n                return !validIPDomain.test(trimmedValue);\n            }\n        });\n\n        const invalidEndpoints = warpEndpoints?.filter(value => {\n            if (value) {\n                const trimmedValue = value.trim();\n                return !validEndpoint.test(trimmedValue);\n            }\n        });\n\n        if (invalidIPs.length) {\n            alert(' Invalid IPs or Domains \\n\\n' + invalidIPs.map(ip => ' ' + ip).join('\\n'));\n            return false;\n        }\n        \n        if (invalidEndpoints.length) {\n            alert(' Invalid endpoint \\n\\n' + invalidEndpoints.map(endpoint => ' ' + endpoint).join('\\n'));\n            return false;\n        }\n\n        if (lengthMin >= lengthMax || intervalMin > intervalMax || noiseCountMin > noiseCountMax || noiseSizeMin > noiseSizeMax || noiseDelayMin > noiseDelayMax) {\n            alert(' Minimum should be smaller or equal to Maximum! ');               \n            return false;\n        }\n\n        if (!(is${atob("Vmxlc3M=")} && (hasSecurity && validSecurityType || !hasSecurity) && validTransmission) && !isSocksHttp && chainProxy) {\n            alert(' Invalid Config!  \\n - The chain proxy should be ${atob("VkxFU1M=")}, Socks or Http!\\n - ${atob("VkxFU1M=")} transmission should be GRPC,WS or TCP\\n - ${atob("VkxFU1M=")} security should be TLS,Reality or None\\n - socks or http should be like:\\n + (socks or http)://user:pass@host:port\\n + (socks or http)://host:port');               \n            return false;\n        }\n\n        if (is${atob("Vmxlc3M=")} && securityType === 'tls' && ${atob("dmxlc3M=")}Port !== '443') {\n            alert(' ${atob("VkxFU1M=")} TLS port can be only 443 to be used as a proxy chain! ');               \n            return false;\n        }\n\n        if (isCustomCdn && !(customCdnAddrs.length && customCdnHost && customCdnSni)) {\n            alert(' All "Custom" fields should be filled or deleted together! ');               \n            return false;\n        }\n        \n        let submisionError = false;\n        for (const [index, mode] of udpNoiseModes.entries()) {\n            if (udpNoiseDelaysMin[index] > udpNoiseDelaysMax[index]) {\n                alert(' The minimum noise delay should be smaller or equal to maximum! ');\n                submisionError = true;\n                break;\n            }\n            \n            switch (mode) {\n                case 'base64':\n                    if (!base64Regex.test(udpNoisePackets[index])) {\n                        alert(' The Base64 noise packet is not a valid base64 value! ');\n                        submisionError = true;\n                    }\n                    break;\n\n                case 'rand':\n                    if (!(/^\\d+-\\d+$/.test(udpNoisePackets[index]))) {\n                        alert(' The Random noise packet should be a range like 0-10 or 10-30! ');\n                        submisionError = true;\n                    }\n                    const [min, max] = udpNoisePackets[index].split("-").map(Number);\n                    if (min > max) {\n                        alert(' The minimum Random noise packet should be smaller or equal to maximum! ');\n                        submisionError = true;\n                    }\n                    break;\n\n                case 'hex':\n                    if (!(/^(?=(?:[0-9A-Fa-f]{2})*$)[0-9A-Fa-f]+$/.test(udpNoisePackets[index]))) {\n                        alert(' The Hex noise packet is not a valid hex value! It should have even length and consisted of 0-9, a-f and A-F. ');\n                        submisionError = true;\n                    }\n                    break;\n            }\n        }\n        if (submisionError) return false;\n\n        try {\n            document.body.style.cursor = 'wait';\n            const applyButtonVal = applyButton.value;\n            applyButton.value = ' Loading...';\n\n            const response = await fetch('/panel', {\n                method: 'POST',\n                body: formData,\n                credentials: 'include'\n            });\n\n            document.body.style.cursor = 'default';\n            applyButton.value = applyButtonVal;\n\n            if (!response.ok) {\n                const errorMessage = await response.text();\n                console.error(errorMessage, response.status);\n                alert(' Session expired! Please login again.');\n                window.location.href = '/login';\n                return;\n            }                \n            alert(' Parameters applied successfully ');\n            window.location.reload();\n        } catch (error) {\n            console.error('Error:', error);\n        }\n    }\n\n    const logout = async (event) => {\n        event.preventDefault();\n\n        try {\n            const response = await fetch('/logout', {\n                method: 'GET',\n                credentials: 'same-origin'\n            });\n        \n            if (!response.ok) {\n                console.error('Failed to log out:', response.status);\n                return;\n            }\n            window.location.href = '/login';\n        } catch (error) {\n            console.error('Error:', error);\n        }\n    }\n\n    const resetPassword = async (event) => {\n        event.preventDefault();\n        const modal = document.getElementById('myModal');\n        const newPasswordInput = document.getElementById('newPassword');\n        const confirmPasswordInput = document.getElementById('confirmPassword');\n        const passwordError = document.getElementById('passwordError');             \n        const newPassword = newPasswordInput.value;\n        const confirmPassword = confirmPasswordInput.value;\n\n        if (newPassword !== confirmPassword) {\n            passwordError.textContent = "Passwords do not match";\n            return false;\n        }\n\n        const hasCapitalLetter = /[A-Z]/.test(newPassword);\n        const hasNumber = /[0-9]/.test(newPassword);\n        const isLongEnough = newPassword.length >= 8;\n\n        if (!(hasCapitalLetter && hasNumber && isLongEnough)) {\n            passwordError.textContent = ' Password must contain at least one capital letter, one number, and be at least 8 characters long.';\n            return false;\n        }\n                \n        try {\n            const response = await fetch('/panel/password', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'text/plain'\n                },\n                body: newPassword,\n                credentials: 'same-origin'\n            });\n        \n            if (response.ok) {\n                modal.style.display = "none";\n                document.body.style.overflow = "";\n                alert(" Password changed successfully! ");\n                window.location.href = '/login';\n            } else if (response.status === 401) {\n                const errorMessage = await response.text();\n                passwordError.textContent = ' ' + errorMessage;\n                console.error(errorMessage, response.status);\n                alert(' Session expired! Please login again.');\n                window.location.href = '/login';\n            } else {\n                const errorMessage = await response.text();\n                passwordError.textContent = ' ' + errorMessage;\n                console.error(errorMessage, response.status);\n                return false;\n            }\n        } catch (error) {\n            console.error('Error:', error);\n        }\n    }`,re=`\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <meta name="timestamp" content=${Date.now()}>\n        <title>${atob("QlBC")} Panel ${globalThis.panelVersion}</title>\n        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">\n        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />\n        <title>Collapsible Sections</title>\n        <style>\n            \n    :root {\n        --color: black;\n        --primary-color: #09639f;\n        --secondary-color: #3498db;\n        --header-color: #09639f; \n        --background-color: #fff;\n        --form-background-color: #f9f9f9;\n        --table-active-color: #f2f2f2;\n        --hr-text-color: #3b3b3b;\n        --lable-text-color: #333;\n        --border-color: #ddd;\n        --button-color: #09639f;\n        --input-background-color: white;\n        --header-shadow: 2px 2px 4px rgba(0, 0, 0, 0.25);\n    }\n    body { font-family: Twemoji Country Flags, system-ui; background-color: var(--background-color); color: var(--color) }\n    body.dark-mode {\n        --color: white;\n        --primary-color: #09639F;\n        --secondary-color: #3498DB;\n        --header-color: #3498DB; \n        --background-color: #121212;\n        --form-background-color: #121212;\n        --table-active-color: #252525;\n        --hr-text-color: #D5D5D5;\n        --lable-text-color: #DFDFDF;\n        --border-color: #353535;\n        --button-color: #3498DB;\n        --input-background-color: #252525;\n        --header-shadow: 2px 2px 4px rgba(255, 255, 255, 0.25);\n    }\n    .material-symbols-outlined {\n        margin-left: 5px;\n        font-variation-settings:\n        'FILL' 0,\n        'wght' 400,\n        'GRAD' 0,\n        'opsz' 24\n    }\n    details { border-bottom: 1px solid var(--border-color); }\n    summary {\n        font-weight: bold;\n        cursor: pointer;\n        text-align: center;\n        text-wrap: nowrap;\n    }\n    summary::marker { font-size: 1.5rem; color: var(--secondary-color); }\n    summary h2 { display: inline-flex; }\n    h1 { font-size: 2.5em; text-align: center; color: var(--header-color); text-shadow: var(--header-shadow); }\n    h2,h3 { margin: 30px 0; text-align: center; color: var(--hr-text-color); }\n    hr { border: 1px solid var(--border-color); margin: 20px 0; }\n    .footer {\n        display: flex;\n        font-weight: 600;\n        margin: 10px auto 0 auto;\n        justify-content: center;\n        align-items: center;\n    }\n    .footer button {margin: 0 20px; background: #212121; max-width: fit-content;}\n    .footer button:hover, .footer button:focus { background: #3b3b3b;}\n    .form-control a, a.link { text-decoration: none; }\n    .form-control {\n        margin: 20px auto;\n        font-family: Arial, sans-serif;\n        display: flex;\n        flex-direction: column;\n    }\n    .form-control button {\n        background-color: var(--form-background-color);\n        font-size: 1.1rem;\n        font-weight: 600;\n        color: var(--button-color);\n        border-color: var(--primary-color);\n        border: 1px solid;\n        width: 100%;\n    }\n    label {\n        display: block;\n        margin-bottom: 5px;\n        font-size: 110%;\n        font-weight: 600;\n        color: var(--lable-text-color);\n    }\n    input[type="text"],\n    input[type="number"],\n    input[type="url"],\n    textarea,\n    select {\n        width: 100%;\n        text-align: center;\n        padding: 10px;\n        border: 1px solid var(--border-color);\n        border-radius: 5px;\n        font-size: 16px;\n        color: var(--lable-text-color);\n        background-color: var(--input-background-color);\n        box-sizing: border-box;\n        transition: border-color 0.3s ease;\n    }\t\n    input[type="text"]:focus,\n    input[type="number"]:focus,\n    input[type="url"]:focus,\n    textarea:focus,\n    select:focus { border-color: var(--secondary-color); outline: none; }\n    .button,\n    table button {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 135px;\n        white-space: nowrap;\n        padding: 10px 0;\n        font-size: 16px;\n        font-weight: 600;\n        letter-spacing: 1px;\n        border: none;\n        border-radius: 5px;\n        color: white;\n        background-color: var(--primary-color);\n        cursor: pointer;\n        outline: none;\n        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);\n        transition: all 0.3s ease;\n    }\n    .button {font-weight: 600; padding: 15px 15px; font-size: 1.1rem; width: max-content; }\n    input[type="checkbox"] { \n        background-color: var(--input-background-color);\n        style="margin: 0; \n        grid-column: 2;"\n    }\n    .button.disabled {\n        background-color: #ccc;\n        cursor: not-allowed;\n        box-shadow: none;\n        pointer-events: none;\n    }\n    .button:hover,\n    table button:hover,\n    table button:focus {\n        background-color: #2980b9;\n        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);\n        transform: translateY(-2px);\n    }\n    .header-container button:hover {\n        transform: scale(1.1);\n    }\n    button.button:hover { color: white; }\n    .button:active,\n    table button:active { transform: translateY(1px); box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3); }\n    .form-container {\n        max-width: 90%;\n        margin: 0 auto;\n        padding: 20px;\n        background: var(--form-background-color);\n        border: 1px solid var(--border-color);\n        border-radius: 10px;\n        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n        margin-bottom: 100px;\n    }\n    .table-container { overflow-x: auto; }\n    table { \n        width: 100%;\n        border: 1px solid var(--border-color);\n        border-collapse: separate;\n        border-spacing: 0; \n        border-radius: 10px;\n        margin-bottom: 20px;\n        overflow: hidden;\n    }\n    tbody { display: flex; flex-direction: column; }\n    tr { display: flex; flex-direction: row; }\n    th, td { \n        display: flex; \n        flex-direction: column;\n        justify-content: center; \n        padding: 10px; \n        width: 100%;\n        gap: 10px;\n        border-bottom: 1px solid var(--border-color); \n    }\n    td div { display: flex; align-items: center; }\n    th { background-color: var(--secondary-color); color: white; font-weight: bold; font-size: 1.1rem; width: 50%;}\n    td:last-child { \n        background-color: var(--table-active-color); \n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-direction: column;\n        gap: 10px;\n    }               \n    tr:hover { background-color: var(--table-active-color); }\n    .modal {\n        display: none;\n        position: fixed;\n        z-index: 1;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        overflow: auto;\n        background-color: rgba(0, 0, 0, 0.4);\n    }\n    .modal-content {\n        background-color: var(--form-background-color);\n        margin: auto;\n        padding: 10px 20px 20px;\n        border: 1px solid var(--border-color);\n        border-radius: 10px;\n        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n        width: 80%;\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n    }\n    .close { color: var(--color); float: right; font-size: 28px; font-weight: bold; }\n    .close:hover,\n    .close:focus { color: black; text-decoration: none; cursor: pointer; }\n    .form-control label {\n        display: block;\n        margin-bottom: 8px;\n        font-size: 110%;\n        font-weight: 600;\n        color: var(--lable-text-color);\n        line-height: 1.3em;\n    }\n    .form-control input[type="password"] {\n        width: 100%;\n        padding: 10px;\n        border: 1px solid var(--border-color);\n        border-radius: 5px;\n        font-size: 16px;\n        color: var(--lable-text-color);\n        background-color: var(--input-background-color);\n        box-sizing: border-box;\n        margin-bottom: 15px;\n        transition: border-color 0.3s ease;\n    }\n    .routing { \n        display: grid;\n        justify-content: flex-start;\n        grid-template-columns: 1fr 1fr 10fr 1fr;\n        margin-bottom: 15px;\n    }\n    .form-control .routing input { grid-column: 2 / 3; }\n    #routing-rules.form-control { display: grid; grid-template-columns: 1fr 1fr; }\n    .routing label {\n        text-align: left;\n        margin: 0 0 0 10px;\n        font-weight: 400;\n        font-size: 100%;\n        text-wrap: nowrap;\n    }\n    .form-control input[type="password"]:focus { border-color: var(--secondary-color); outline: none; }\n    #passwordError { color: red; margin-bottom: 10px; }\n    .symbol { margin-right: 8px; }\n    .modalQR {\n        display: none;\n        position: fixed;\n        z-index: 1;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        overflow: auto;\n        background-color: rgba(0, 0, 0, 0.4);\n    }\n    .floating-button {\n        position: fixed;\n        bottom: 20px;\n        left: 20px;\n        background-color: var(--color);\n        color: white;\n        border: none;\n        border-radius: 50%;\n        width: 60px;\n        height: 60px;\n        font-size: 24px;\n        cursor: pointer;\n        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\n        transition: background-color 0.3s, transform 0.3s;\n    }\n    .floating-button:hover { transform: scale(1.1); }\n    .min-max { display: grid; grid-template-columns: 1fr auto 1fr; align-items: baseline; width: 100%; }\n    .min-max span { text-align: center; white-space: pre; }\n    .input-with-select { width: 100%; }\n    body.dark-mode .floating-button { background-color: var(--color); }\n    body.dark-mode .floating-button:hover { transform: scale(1.1); }\n    #ips th { \n        background-color: var(--hr-text-color);\n        color: var(--background-color);\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        flex: 1; \n    }\n    #ips td { \n        background-color: unset; \n        overflow: hidden;\n        flex: 1;\n        text-overflow: clip;\n        white-space: nowrap;\n    }\n    #ips tr { flex-wrap: wrap; }\n    #ips td:first-child { background-color: var(--table-active-color); }\n    .header-container { display: flex; justify-content: center; margin-bottom: 20px; }\n    .udp-noise { border: 1px solid var(--border-color); border-radius: 15px; padding: 20px; margin-bottom: 10px;}\n    @media only screen and (min-width: 768px) {\n        .form-container { max-width: 70%; }\n        .form-control { \n            margin-bottom: 15px;\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            align-items: baseline;\n            justify-content: flex-end;\n            font-family: Arial, sans-serif;\n        }\n        #apply { display: block; margin: 20px auto; max-width: 50%; }\n        .modal-content { width: 30% }\n        .routing { display: grid; grid-template-columns: 4fr 1fr 3fr 4fr; }\n    }\n        </style>\n    </head>\n    <body>\n        <h1>${atob("QlBC")} Panel <span style="font-size: smaller;">${globalThis.panelVersion}</span> </h1>\n        <div class="form-container">\n            <form id="configForm">\n                <details open>\n                    <summary><h2>${atob("VkxFU1M=")} - ${atob("VFJPSkFO")} </h2></summary>\n                    <div class="form-control">\n                        <label for="remoteDNS"> Remote DNS</label>\n                        <input type="url" id="remoteDNS" name="remoteDNS" value="${r}" required>\n                    </div>\n                    <div class="form-control">\n                        <label for="localDNS"> Local DNS</label>\n                        <input type="text" id="localDNS" name="localDNS" value="${n}"\n                            pattern="^(localhost|(?:\\d{1,3}\\.){3}\\d{1,3})$"\n                            title="Please enter a valid DNS IP Address!"  required>\n                    </div>\n                    <div class="form-control">\n                        <label for="VLTRFakeDNS"> Fake DNS</label>\n                        <div class="input-with-select">\n                            <select id="VLTRFakeDNS" name="VLTRFakeDNS">\n                                <option value="true" ${o?"selected":""}>Enabled</option>\n                                <option value="false" ${o?"":"selected"}>Disabled</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div class="form-control">\n                        <label for="proxyIP"> Proxy IPs / Domains</label>\n                        <input type="text" id="proxyIP" name="proxyIP" value="${a.replaceAll(","," , ")}">\n                    </div>\n                    <div class="form-control">\n                        <label for="outProxy"> Chain Proxy</label>\n                        <input type="text" id="outProxy" name="outProxy" value="${i}">\n                    </div>\n                    <div class="form-control">\n                        <label for="cleanIPs"> Clean IPs / Domains</label>\n                        <input type="text" id="cleanIPs" name="cleanIPs" value="${s.replaceAll(","," , ")}">\n                    </div>\n                    <div class="form-control">\n                        <label for="scanner"> Clean IP Scanner</label>\n                        <a href="https://github.com/bia-pain-bache/Cloudflare-Clean-IP-Scanner/releases/tag/v2.2.5" name="scanner" target="_blank" style="width: 100%;">\n                            <button type="button" id="scanner" class="button">\n                                Download Scanner\n                                <span class="material-symbols-outlined">open_in_new</span>\n                            </button>\n                        </a>\n                    </div>\n                    <div class="form-control">\n                        <label for="enableIPv6"> IPv6</label>\n                        <div class="input-with-select">\n                            <select id="enableIPv6" name="enableIPv6">\n                                <option value="true" ${c?"selected":""}>Enabled</option>\n                                <option value="false" ${c?"":"selected"}>Disabled</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div class="form-control">\n                        <label for="customCdnAddrs"> Custom CDN Addrs</label>\n                        <input type="text" id="customCdnAddrs" name="customCdnAddrs" value="${d.replaceAll(","," , ")}">\n                    </div>\n                    <div class="form-control">\n                        <label for="customCdnHost"> Custom CDN Host</label> \n                        <input type="text" id="customCdnHost" name="customCdnHost" value="${u}">\n                    </div>\n                    <div class="form-control">\n                        <label for="customCdnSni"> Custom CDN SNI</label>\n                        <input type="text" id="customCdnSni" name="customCdnSni" value="${h}">\n                    </div>\n                    <div class="form-control">\n                        <label for="bestVLTRInterval"> Best Interval</label>\n                        <input type="number" id="bestVLTRInterval" name="bestVLTRInterval" min="10" max="90" value="${p}">\n                    </div>\n                    <div class="form-control" style="padding-top: 10px;">\n                        <label for="VLConfigs"> Protocols</label>\n                        <div style="width: 100%; display: grid; grid-template-columns: 1fr 1fr; align-items: baseline; margin-top: 10px;">\n                            <div style = "display: flex; justify-content: center; align-items: center;">\n                                <input type="checkbox" id="VLConfigs" name="VLConfigs" onchange="handleProtocolChange(event)" value="true" ${f?"checked":""}>\n                                <label for="VLConfigs" style="margin: 0 5px; font-weight: normal; font-size: unset;">${atob("VkxFU1M=")}</label>\n                            </div>\n                            <div style = "display: flex; justify-content: center; align-items: center;">\n                                <input type="checkbox" id="TRConfigs" name="TRConfigs" onchange="handleProtocolChange(event)" value="true" ${m?"checked":""}>\n                                <label for="TRConfigs" style="margin: 0 5px; font-weight: normal; font-size: unset;">${atob("VHJvamFu")}</label>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="table-container">\n                        <table id="ports-block">\n                            <tr>\n                                <th style="text-wrap: nowrap; background-color: gray;">Config type</th>\n                                <th style="text-wrap: nowrap; background-color: gray;">Ports</th>\n                            </tr>\n                            <tr>\n                                <td style="text-align: center; font-size: larger;"><b>TLS</b></td>\n                                <td>\n                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr;">${G}</div>\n                                </td>    \n                            </tr>\n                            ${q?`<tr>\n                                <td style="text-align: center; font-size: larger;"><b>Non TLS</b></td>\n                                <td>\n                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr;">${q}</div>\n                                </td>    \n                            </tr>`:""}        \n                        </table>\n                    </div>\n                </details>\n                <details>\n                    <summary><h2>FRAGMENT </h2></summary>\t\n                    <div class="form-control">\n                        <label for="fragmentLengthMin"> Length</label>\n                        <div class="min-max">\n                            <input type="number" id="fragmentLengthMin" name="fragmentLengthMin" value="${y}" min="10" required>\n                            <span> - </span>\n                            <input type="number" id="fragmentLengthMax" name="fragmentLengthMax" value="${b}" max="500" required>\n                        </div>\n                    </div>\n                    <div class="form-control">\n                        <label for="fragmentIntervalMin"> Interval</label>\n                        <div class="min-max">\n                            <input type="number" id="fragmentIntervalMin" name="fragmentIntervalMin"\n                                value="${v}" min="1" max="30" required>\n                            <span> - </span>\n                            <input type="number" id="fragmentIntervalMax" name="fragmentIntervalMax"\n                                value="${w}" min="1" max="30" required>\n                        </div>\n                    </div>\n                    <div class="form-control">\n                        <label for="fragmentPackets"> Packets</label>\n                        <div class="input-with-select">\n                            <select id="fragmentPackets" name="fragmentPackets">\n                                <option value="tlshello" ${"tlshello"===_?"selected":""}>tlshello</option>\n                                <option value="1-1" ${"1-1"===_?"selected":""}>1-1</option>\n                                <option value="1-2" ${"1-2"===_?"selected":""}>1-2</option>\n                                <option value="1-3" ${"1-3"===_?"selected":""}>1-3</option>\n                                <option value="1-5" ${"1-5"===_?"selected":""}>1-5</option>\n                            </select>\n                        </div>\n                    </div>\n                </details>\n                <details>\n                    <summary><h2>WARP GENERAL </h2></summary>\n                    <div class="form-control">\n                        <label for="warpEndpoints"> Endpoints</label>\n                        <input type="text" id="warpEndpoints" name="warpEndpoints" value="${x.replaceAll(","," , ")}" required>\n                    </div>\n                    <div class="form-control">\n                        <label for="endpointScanner" style="line-height: 1.5;"> Scan Endpoint</label>\n                        <button type="button" id="endpointScanner" class="button" style="padding: 10px 0;" onclick="copyToClipboard('bash <(curl -fsSL https://raw.githubusercontent.com/bia-pain-bache/warp-script/refs/heads/main/endip/install.sh)', false)">\n                            Copy Script<span class="material-symbols-outlined">terminal</span>\n                        </button>\n                    </div>\n                    <div class="form-control">\n                        <label for="warpFakeDNS"> Fake DNS</label>\n                        <div class="input-with-select">\n                            <select id="warpFakeDNS" name="warpFakeDNS">\n                                <option value="true" ${k?"selected":""}>Enabled</option>\n                                <option value="false" ${k?"":"selected"}>Disabled</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div class="form-control">\n                        <label for="warpEnableIPv6"> IPv6</label>\n                        <div class="input-with-select">\n                            <select id="warpEnableIPv6" name="warpEnableIPv6">\n                                <option value="true" ${S?"selected":""}>Enabled</option>\n                                <option value="false" ${S?"":"selected"}>Disabled</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div class="form-control">\n                        <label for="refreshBtn"> Warp Configs</label>\n                        <button id="refreshBtn" type="button" class="button" style="padding: 10px 0;" onclick="getWarpConfigs()">\n                            Update<span class="material-symbols-outlined">autorenew</span>\n                        </button>\n                    </div>\n                    <div class="form-control">\n                        <label for="bestWarpInterval"> Best Interval</label>\n                        <input type="number" id="bestWarpInterval" name="bestWarpInterval" min="10" max="90" value="${C}">\n                    </div>\n                </details>\n                <details>\n                    <summary><h2>WARP PRO </h2></summary>\n                    <div class="header-container">\n                        <h3 style="margin: 0 5px;">V2RAYNG - V2RAYN</h3>\n                        <button type="button" id="add-udp-noise" onclick="addUdpNoise()" style="background: none; margin: 0; border: none; cursor: pointer;">\n                            <i class="fa fa-plus-circle fa-2x" style="color: var(--button-color);" aria-hidden="true"></i>\n                        </button>       \n                    </div>\n                    <div id="udp-noise-container">\n                        ${Z}\n                    </div>\n                    <h3>MAHSANG - NIKANG - HIDDIFY </h3>\n                    <div class="form-control">\n                        <label for="hiddifyNoiseMode"> Hiddify Mode</label>\n                        <input type="text" id="hiddifyNoiseMode" name="hiddifyNoiseMode" \n                            pattern="^(m[1-6]|h_[0-9A-Fa-f]{2}|g_([0-9A-Fa-f]{2}_){2}[0-9A-Fa-f]{2})$" \n                            title="Enter 'm1-m6', 'h_HEX', 'g_HEX_HEX_HEX' which HEX can be between 00 to ff"\n                            value="${A}" required>\n                    </div>\n                    <div class="form-control">\n                        <label for="nikaNGNoiseMode"> NikaNG Mode</label>\n                        <input type="text" id="nikaNGNoiseMode" name="nikaNGNoiseMode" \n                            pattern="^(none|quic|random|[0-9A-Fa-f]+)$" \n                            title="Enter 'none', 'quic', 'random', or any HEX string like 'ee0000000108aaaa'"\n                            value="${P}" required>\n                    </div>\n                    <div class="form-control">\n                        <label for="noiseCountMin"> Noise Count</label>\n                        <div class="min-max">\n                            <input type="number" id="noiseCountMin" name="noiseCountMin"\n                                value="${I}" min="1" required>\n                            <span> - </span>\n                            <input type="number" id="noiseCountMax" name="noiseCountMax"\n                                value="${R}" min="1" required>\n                        </div>\n                    </div>\n                    <div class="form-control">\n                        <label for="noiseSizeMin"> Noise Size</label>\n                        <div class="min-max">\n                            <input type="number" id="noiseSizeMin" name="noiseSizeMin"\n                                value="${T}" min="1" required>\n                            <span> - </span>\n                            <input type="number" id="noiseSizeMax" name="noiseSizeMax"\n                                value="${N}" min="1" required>\n                        </div>\n                    </div>\n                    <div class="form-control">\n                        <label for="noiseDelayMin"> Noise Delay</label>\n                        <div class="min-max">\n                            <input type="number" id="noiseDelayMin" name="noiseDelayMin"\n                                value="${D}" min="1" required>\n                            <span> - </span>\n                            <input type="number" id="noiseDelayMax" name="noiseDelayMax"\n                                value="${$}" min="1" required>\n                        </div>\n                    </div>\n                    <h3>CLASH - AMNEZIA </h3>\n                    <div class="form-control">\n                        <label for="amneziaNoiseCount"> Noise Count</label>\n                        <input type="number" id="amneziaNoiseCount" name="amneziaNoiseCount"\n                            value="${B}" min="1" required>\n                    </div>\n                    <div class="form-control">\n                        <label for="amneziaNoiseSizeMin"> Noise Size</label>\n                        <div class="min-max">\n                            <input type="number" id="amneziaNoiseSizeMin" name="amneziaNoiseSizeMin"\n                                value="${M}" min="1" required>\n                            <span> - </span>\n                            <input type="number" id="amneziaNoiseSizeMax" name="amneziaNoiseSizeMax"\n                                value="${z}" min="1" required>\n                        </div>\n                    </div>\n                </details>\n                <details>\n                    <summary><h2>ROUTING RULES </h2></summary>\n                    <div id="routing-rules" class="form-control" style="margin-bottom: 20px;">\t\t\t\n                        <div class="routing">\n                            <input type="checkbox" id="bypass-lan" name="bypass-lan" value="true" ${U?"checked":""}>\n                            <label for="bypass-lan">Bypass LAN</label>\n                        </div>\n                        <div class="routing">\n                            <input type="checkbox" id="block-ads" name="block-ads" value="true" ${W?"checked":""}>\n                            <label for="block-ads">Block Ads.</label>\n                        </div>\n                        <div class="routing">\n                            <input type="checkbox" id="bypass-iran" name="bypass-iran" value="true" ${O?"checked":""}>\n                            <label for="bypass-iran">Bypass Iran</label>\n                        </div>\n                        <div class="routing">\n                            <input type="checkbox" id="block-porn" name="block-porn" value="true" ${H?"checked":""}>\n                            <label for="block-porn">Block Porn</label>\n                        </div>\n                        <div class="routing">\n                            <input type="checkbox" id="bypass-china" name="bypass-china" value="true" ${F?"checked":""}>\n                            <label for="bypass-china">Bypass China</label>\n                        </div>\n                        <div class="routing">\n                            <input type="checkbox" id="block-udp-443" name="block-udp-443" value="true" ${j?"checked":""}>\n                            <label for="block-udp-443">Block QUIC</label>\n                        </div>\n                        <div class="routing">\n                            <input type="checkbox" id="bypass-russia" name="bypass-russia" value="true" ${L?"checked":""}>\n                            <label for="bypass-russia">Bypass Russia</label>\n                        </div>\n                    </div>\n                    <h3>CUSTOM RULES </h3>\n                    <div class="form-control">\n                        <label for="customBypassRules"> Bypass IPs / Domains</label>\n                        <input type="text" id="customBypassRules" name="customBypassRules" value="${J.replaceAll(","," , ")}">\n                    </div>\n                    <div class="form-control">\n                        <label for="customBlockRules"> Block IPs / Domains</label>\n                        <input type="text" id="customBlockRules" name="customBlockRules" value="${V.replaceAll(","," , ")}">\n                    </div>\n                </details>\n                <div id="apply" class="form-control">\n                    <div style="grid-column: 2; width: 100%; display: flex; justify-content: center; gap: 10px;">\n                        <input type="submit" id="applyButton" style="margin-right: 10px;" class="button disabled" value="APPLY SETTINGS " form="configForm">\n                        <button type="button" id="resetSettings" style="background: none; margin: 0; border: none; cursor: pointer; width: max-content;">\n                            <i class="fa fa-refresh fa-2x fa-border" style="border-radius: .2em; border-color: var(--border-color);" aria-hidden="true"></i>\n                        </button>\n                    </div>\n                </div>\n            </form>\n            <hr>            \n            <h2> NORMAL SUB</h2>\n            <div class="table-container">\n                <table id="normal-configs-table">\n                    <tr>\n                        <th>Application</th>\n                        <th>Subscription</th>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["v2rayNG","NikaNG","MahsaNG","v2rayN","v2rayN-PRO","Shadowrocket","Streisand","Hiddify"])}\n                        </td>\n                        <td>\n                            ${X("sub","",`${atob("QlBC")}-Normal`,"Normal Subscription")}\n                            ${Y("sub","",`${atob("QlBC")}-Normal`)}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["husi","Nekobox","Nekoray","Karing"])}\n                        </td>\n                        <td>\n                            ${X("sub","singbox",`${atob("QlBC")}-Normal`,"Normal Subscription",!0)}\n                            ${Y("sub","singbox",`${atob("QlBC")}-Normal`)}\n                        </td>\n                    </tr>\n                </table>\n            </div>\n            <h2> FULL NORMAL SUB</h2>\n            <div class="table-container">\n                <table id="full-normal-configs-table">\n                    <tr>\n                        <th>Application</th>\n                        <th>Subscription</th>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["v2rayNG","NikaNG","MahsaNG","v2rayN","v2rayN-PRO","Streisand"])}\n                        </td>\n                        <td>\n                            ${X("sub","xray",`${atob("QlBC")}-Full-Normal`,"Full normal Subscription")}\n                            ${Y("sub","xray",`${atob("QlBC")}-Full-Normal`)}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["sing-box","v2rayN (sing-box)"])}\n                        </td>\n                        <td>\n                            ${X("sub","sfa",`${atob("QlBC")}-Full-Normal`,"Full normal Subscription",!0)}\n                            ${Y("sub","sfa",`${atob("QlBC")}-Full-Normal`)}\n                            ${ee("sub","sfa")}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["Clash Meta","Clash Verge","FlClash","Stash","v2rayN (mihomo)"])}\n                        </td>\n                        <td>\n                            ${X("sub","clash",`${atob("QlBC")}-Full-Normal`,"Full normal Subscription")}\n                            ${Y("sub","clash",`${atob("QlBC")}-Full-Normal`)}\n                            ${ee("sub","clash")}\n                        </td>\n                    </tr>\n                </table>\n            </div>\n            <h2> FRAGMENT SUB</h2>\n            <div class="table-container">\n                <table id="frag-sub-table">\n                    <tr>\n                        <th style="text-wrap: nowrap;">Application</th>\n                        <th style="text-wrap: nowrap;">Subscription</th>\n                    </tr>\n                    <tr>\n                        <td style="text-wrap: nowrap;">\n                            ${Q(["v2rayNG","NikaNG","MahsaNG","v2rayN","v2rayN-PRO","Streisand"])}\n                        </td>\n                        <td>\n                            ${X("fragsub","",`${atob("QlBC")}-Fragment`,"Fragment Subscription")}\n                            ${Y("fragsub","",`${atob("QlBC")}-Fragment`)}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style="text-wrap: nowrap;">\n                            ${Q(["Hiddify"])}\n                        </td>\n                        <td>\n                            ${X("fragsub","hiddify-frag",`${atob("QlBC")}-Fragment`,"Fragment Subscription",!1,!0)}\n                            ${Y("fragsub","hiddify-frag",`${atob("QlBC")}-Fragment`,!0)}\n                        </td>\n                    </tr>\n                </table>\n            </div>\n            <h2> WARP SUB</h2>\n            <div class="table-container">\n                <table id="normal-configs-table">\n                    <tr>\n                        <th>Application</th>\n                        <th>Subscription</th>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["v2rayNG","v2rayN","Streisand"])}\n                        </td>\n                        <td>\n                            ${X("warpsub","xray",`${atob("QlBC")}-Warp`,"Warp Subscription")}\n                            ${Y("warpsub","xray",`${atob("QlBC")}-Warp`)}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["sing-box","v2rayN (sing-box)"])}\n                        </td>\n                        <td>\n                            ${X("warpsub","singbox",`${atob("QlBC")}-Warp`,"Warp Subscription",!0)}\n                            ${Y("warpsub","singbox",`${atob("QlBC")}-Warp`)}\n                            ${ee("sub","singbox")}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["Hiddify"])}\n                        </td>\n                        <td>\n                            ${X("warpsub","hiddify",`${atob("QlBC")}-Warp`,"Warp Subscription",!1,!0)}\n                            ${Y("warpsub","hiddify",`${atob("QlBC")}-Warp`,!0)}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["Clash Meta","Clash Verge","FlClash","Stash","v2rayN (mihomo)"])}\n                        </td>\n                        <td>\n                            ${X("warpsub","clash",`${atob("QlBC")}-Warp`,"Warp Subscription")}\n                            ${Y("warpsub","clash",`${atob("QlBC")}-Warp`)}\n                            ${ee("warpsub","clash")}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["Wireguard"])}\n                        </td>\n                        <td>\n                            <button id="dlConfigsBtn" type="button" onclick="downloadWarpConfigs()">\n                                Download<span class="material-symbols-outlined">download</span>\n                            </button>\n                        </td>\n                    </tr>\n                </table>\n            </div>\n            <h2> WARP PRO SUB</h2>\n            <div class="table-container">\n                <table id="warp-pro-configs-table">\n                    <tr>\n                        <th>Application</th>\n                        <th>Subscription</th>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["v2rayNG","v2rayN","Streisand"])}\n                        </td>\n                        <td>\n                            ${X("warpsub","xray-pro",`${atob("QlBC")}-Warp-Pro`,"Warp Pro Subscription")}\n                            ${Y("warpsub","xray-pro",`${atob("QlBC")}-Warp-Pro`)}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["NikaNG","MahsaNG","v2rayN-PRO"])}\n                        </td>\n                        <td>\n                            ${X("warpsub","nikang",`${atob("QlBC")}-Warp-Pro`,"Warp Pro Subscription")}\n                            ${Y("warpsub","nikang",`${atob("QlBC")}-Warp-Pro`)}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["Clash Meta","Clash Verge","FlClash","Stash","v2rayN (mihomo)"])}\n                        </td>\n                        <td>\n                            ${X("warpsub","clash-pro",`${atob("QlBC")}-Warp-Pro`,"Warp Pro Subscription")}\n                            ${Y("warpsub","clash-pro",`${atob("QlBC")}-Warp-Pro`)}\n                            ${ee("warpsub","clash-pro")}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["Hiddify"])}\n                        </td>\n                        <td>\n                            ${X("warpsub","hiddify-pro",`${atob("QlBC")}-Warp-Pro`,"Warp Pro Subscription",!1,!0)}\n                            ${Y("warpsub","hiddify-pro",`${atob("QlBC")}-Warp-Pro`,!0)}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            ${Q(["Amnezia","WG Tunnel"])}\n                        </td>\n                        <td>\n                            <button id="dlAmneziaConfigsBtn" type="button" onclick="downloadWarpConfigs('amnezia')">\n                                Download<span class="material-symbols-outlined">download</span>\n                            </button>\n                        </td>\n                    </tr>\n                </table>\n            </div>\n            <div id="myModal" class="modal">\n                <div class="modal-content">\n                    <span class="close">&times;</span>\n                    <form id="passwordChangeForm">\n                        <h2>Change Password</h2>\n                        <div class="form-control">\n                            <label for="newPassword">New Password</label>\n                            <input type="password" id="newPassword" name="newPassword" required>\n                            </div>\n                        <div class="form-control">\n                            <label for="confirmPassword">Confirm Password</label>\n                            <input type="password" id="confirmPassword" name="confirmPassword" required>\n                        </div>\n                        <div id="passwordError" style="color: red; margin-bottom: 10px;"></div>\n                        <button id="changePasswordBtn" type="submit" class="button">Change Password</button>\n                    </form>\n                </div>\n            </div>\n            <div id="myQRModal" class="modalQR">\n                <div class="modal-content" style="width: auto; text-align: center;">\n                    <div style="display: flex; flex-direction: column; align-items: center; margin-bottom: 10px;">\n                        <span id="closeQRModal" class="close" style="align-self: flex-end;">&times;</span>\n                        <span id="qrcodeTitle" style="align-self: center; font-weight: bold;"></span>\n                    </div>\n                    <div id="qrcode-container"></div>\n                </div>\n            </div>\n            <hr>\n            <div class="header-container">\n                <h2 style="margin: 0 5px;"> MY IP</h2>\n                <button type="button" id="refresh-geo-location" onclick="fetchIPInfo()" style="background: none; margin: 0; border: none; cursor: pointer;">\n                    <i class="fa fa-refresh fa-2x" style="color: var(--button-color);" aria-hidden="true"></i>\n                </button>       \n            </div>\n            <div class="table-container">\n                <table id="ips" style="text-align: center; margin-bottom: 15px; text-wrap-mode: nowrap;">\n                    <tr>\n                        <th>Target Address</th>\n                        <th>IP</th>\n                        <th>Country</th>\n                        <th>City</th>\n                        <th>ISP</th>\n                    </tr>\n                    <tr>\n                        <td>Cloudflare CDN</td>\n                        <td id="cf-ip"></td>\n                        <td><b id="cf-country"></b></td>\n                        <td><b id="cf-city"></b></td>\n                        <td><b id="cf-isp"></b></td>\n                    </tr>\n                    <tr>\n                        <td>Others</td>\n                        <td id="ip"></td>\n                        <td><b id="country"></b></td>\n                        <td><b id="city"></b></td>\n                        <td><b id="isp"></b></td>\n                    </tr>\n                </table>\n            </div>\n            <hr>\n            <div class="footer">\n                <i class="fa fa-github" style="font-size:36px; margin-right: 10px;"></i>\n                <a class="link" href="https://github.com/bia-pain-bache/${atob("QlBC")}-Worker-Panel" style="color: var(--color); text-decoration: underline;" target="_blank">Github</a>\n                <button id="openModalBtn" class="button">Change Password</button>\n                <button type="button" id="logout" style="background: none; color: var(--color); margin: 0; border: none; cursor: pointer;">\n                    <i class="fa fa-power-off fa-2x" aria-hidden="true"></i>\n                </button>\n            </div>\n        </div>\n        <button id="darkModeToggle" class="floating-button">\n            <i id="modeIcon" class="fa fa-2x fa-adjust" style="color: var(--background-color);" aria-hidden="true"></i>\n        </button>\n    <script type="module" defer>\n        import { polyfillCountryFlagEmojis } from "https://cdn.skypack.dev/country-flag-emoji-polyfill";\n        polyfillCountryFlagEmojis();\n    <\/script>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"><\/script>\n    <script>\n        ${te}\n    <\/script>\n    </body>\t\n    </html>`;return new Response(re,{status:200,headers:{"Content-Type":"text/html;charset=utf-8","Access-Control-Allow-Origin":globalThis.urlOrigin,"Access-Control-Allow-Methods":"GET, POST","Access-Control-Allow-Headers":"Content-Type, Authorization","X-Content-Type-Options":"nosniff","X-Frame-Options":"DENY","Referrer-Policy":"strict-origin-when-cross-origin","Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate, no-transform","CDN-Cache-Control":"no-store"}})}l(be,"getDataset"),l(Dr,"updateDataset"),l(Gn,"extractChainProxyParams"),l(no,"updateWarpConfigs"),l(Oo,"renderHomePage");var Lo=gr(Mo());function Nr(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}async function br(e){let t="https://cloudflare-dns.com/dns-query",r=`${t}?name=${encodeURIComponent(e)}&type=A`,n=`${t}?name=${encodeURIComponent(e)}&type=AAAA`;try{let[e,t]=await Promise.all([fetch(r,{headers:{accept:"application/dns-json"}}),fetch(n,{headers:{accept:"application/dns-json"}})]),o=await e.json(),a=await t.json();return{ipv4:o.Answer?o.Answer.map((e=>e.data)):[],ipv6:a.Answer?a.Answer.map((e=>e.data)):[]}}catch(e){throw console.error("Error resolving DNS:",e),new Error(`An error occurred while resolving DNS - ${e}`)}}function qt(e){return/^(?!\-)(?:[A-Za-z0-9\-]{1,63}\.)+[A-Za-z]{2,}$/.test(e)}async function Wo(e,t){let r=await Ze(e,t);if("POST"===e.method)return r?(await Dr(e,t),new Response("Success",{status:200})):new Response("Unauthorized or expired session!",{status:401});let{proxySettings:n}=await be(e,t),o=await t.kv.get("pwd");if(o&&!r)return Response.redirect(`${globalThis.urlOrigin}/login`,302);let a=o?.length>=8;return await Oo(n,a)}async function Ho(e){let t=new URL(e.url);t.hostname=globalThis.fallbackDomain,t.protocol="https:";let r=new Request(t.toString(),{method:e.method,headers:e.headers,body:e.body,redirect:"manual"});return await fetch(r)}async function jo(e){let t=await e.text();try{let e=await(await fetch(`http://ip-api.com/json/${t}?nocache=${Date.now()}`)).json();return new Response(JSON.stringify(e),{status:200,headers:{"Content-Type":"text/plain;charset=utf-8"}})}catch(e){console.error("Error fetching IP address:",e)}}async function so(e,t,r){if(!await Ze(e,t))return new Response("Unauthorized or expired session!",{status:401});let{warpConfigs:n,proxySettings:o}=await be(e,t),{warpEndpoints:a,amneziaNoiseCount:i,amneziaNoiseSizeMin:s,amneziaNoiseSizeMax:c}=o,d=ze(n,!1),{warpIPv6:u,publicKey:h,privateKey:p}=d,f=new Lo.default,m=l((e=>e.split("\n").map((e=>e.trim())).join("\n")),"trimLines"),g=r?m(`Jc = ${i}\n        Jmin = ${s}\n        Jmax = ${c}\n        S1 = 0\n        S2 = 0\n        H1 = 0\n        H2 = 0\n        H3 = 0\n        H4 = 0`):"";try{a.split(",").forEach(((e,t)=>{f.file(`BPB-Warp-${t+1}.conf`,m(`[Interface]\n                PrivateKey = ${p}\n                Address = 172.16.0.2/32, ${u}\n                DNS = 1.1.1.1, 1.0.0.1\n                MTU = 1280\n                ${g}\n                [Peer]\n                PublicKey = ${h}\n                AllowedIPs = 0.0.0.0/0, ::/0\n                Endpoint = ${e}\n                PersistentKeepalive = 25`))}));let e=await(await f.generateAsync({type:"blob"})).arrayBuffer();return new Response(e,{headers:{"Content-Type":"application/zip","Content-Disposition":`attachment; filename="BPB-Warp-${r?"Pro-":""}configs.zip"`}})}catch{return new Response("Error generating ZIP file.",{status:500})}}function Ko(e,t){let r=t.PROXYIP?.split(",").map((e=>e.trim())),n=new URL(e.url),o=new URLSearchParams(n.search);if(globalThis.panelVersion="3.1.3",globalThis.defaultHttpPorts=["80","8080","2052","2082","2086","2095","8880"],globalThis.defaultHttpsPorts=["443","8443","2053","2083","2087","2096"],globalThis.userID=t.UUID,globalThis.TRPassword=t.TR_PASS,globalThis.proxyIP=r?r[Math.floor(Math.random()*r.length)]:atob("YnBiLnlvdXNlZi5pc2VnYXJvLmNvbQ=="),globalThis.hostName=e.headers.get("Host"),globalThis.pathName=n.pathname,globalThis.client=o.get("app"),globalThis.urlOrigin=n.origin,globalThis.dohURL=t.DOH_URL||"https://cloudflare-dns.com/dns-query",globalThis.fallbackDomain=t.FALLBACK||"speed.cloudflare.com",globalThis.subPath=t.SUB_PATH||userID,"/secrets"!==pathName){if(!userID||!globalThis.TRPassword)throw new Error(`Please set UUID and ${atob("VHJvamFu")} password first. Please visit <a href="https://${hostName}/secrets" target="_blank">here</a> to generate them.`,{cause:"init"});if(userID&&!Nr(userID))throw new Error(`Invalid UUID: ${userID}`,{cause:"init"});if("object"!=typeof t.kv)throw new Error("KV Dataset is not properly set! Please refer to tutorials.",{cause:"init"})}}l(Nr,"isValidUUID"),l(br,"resolveDNS"),l(qt,"isDomain"),l(Wo,"handlePanel"),l(Ho,"fallback"),l(jo,"getMyIP"),l(so,"getWarpConfigs"),l(Ko,"initializeParams");import{connect as Zn}from"cloudflare:sockets";async function Go(e){let t=new WebSocketPair,[r,n]=Object.values(t);n.accept();let o="",a="",i=l(((e,t)=>{console.log(`[${o}:${a}] ${e}`,t||"")}),"log"),s=e.headers.get("sec-websocket-protocol")||"",c=Xn(n,s,i),d={value:null},u=null,h=!1;return c.pipeTo(new WritableStream({async write(e,t){if(h&&u)return u(e);if(d.value){let t=d.value.writable.getWriter();return await t.write(e),void t.releaseLock()}let{hasError:r,message:s,portRemote:l=443,addressRemote:c="",rawDataIndex:p,VLVersion:f=new Uint8Array([0,0]),isUDP:m}=await Qn(e,globalThis.userID);if(o=c,a=`${l}--${Math.random()} ${m?"udp ":"tcp "} `,r)throw new Error(s);if(m){if(53!==l)throw new Error("UDP proxy only enable for DNS which is port 53");h=!0}let g=new Uint8Array([f[0],0]),y=e.slice(p);if(h){let{write:e}=await oa(n,g,i);return u=e,void u(y)}Yn(d,c,l,y,n,g,i)},close(){i("readableWebSocketStream is close")},abort(e){i("readableWebSocketStream is abort",JSON.stringify(e))}})).catch((e=>{i("readableWebSocketStream pipeTo error",e)})),new Response(null,{status:101,webSocket:r})}async function Vo(e){try{let t=await getApiResponse();return!!t&&t.users.some((t=>t.uuid===e))}catch(e){return console.error("Error:",e),!1}}async function Yn(e,t,r,n,o,a,i){async function s(t,r){/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(t)&&(t=`${atob("d3d3Lg==")}${t}${atob("LnNzbGlwLmlv")}`);let o=Zn({hostname:t,port:r});e.value=o,i(`connected to ${t}:${r}`);let a=o.writable.getWriter();return await a.write(n),a.releaseLock(),o}async function c(){let e=globalThis.pathName.split("/")[2],n=e?atob(e).split(","):void 0,l=n?n[Math.floor(Math.random()*n.length)]:globalThis.proxyIP||t,c=await s(l,r);c.closed.catch((e=>{console.log("retry tcpSocket closed error",e)})).finally((()=>{Br(o)})),Jo(c,o,a,null,i)}l(s,"connectAndWrite"),l(c,"retry"),Jo(await s(t,r),o,a,c,i)}function Xn(e,t,r){let n=!1;return new ReadableStream({start(o){e.addEventListener("message",(e=>{if(n)return;let t=e.data;o.enqueue(t)})),e.addEventListener("close",(()=>{Br(e),!n&&o.close()})),e.addEventListener("error",(e=>{r("webSocketServer has error"),o.error(e)}));let{earlyData:a,error:i}=qn(t);i?o.error(i):a&&o.enqueue(a)},pull(e){},cancel(t){n||(r(`ReadableStream was canceled, due to ${t}`),n=!0,Br(e))}})}async function Qn(e,t){if(e.byteLength<24)return{hasError:!0,message:"invalid data"};let r=new Uint8Array(e.slice(0,1)),n=!1,o=!1,a=ra(new Uint8Array(e.slice(1,17))),i=t.includes(",")?t.split(","):[t],s=await Vo(a);if(n=i.some((e=>s||a===e.trim())),console.log(`checkUuidInApi: ${await Vo(a)}, userID: ${a}`),!n)return{hasError:!0,message:"invalid user"};let l=new Uint8Array(e.slice(17,18))[0],c=new Uint8Array(e.slice(18+l,18+l+1))[0];if(1!==c){if(2!==c)return{hasError:!0,message:`command ${c} is not support, command 01-tcp,02-udp,03-mux`};o=!0}let d=18+l+1,u=e.slice(d,d+2),h=new DataView(u).getUint16(0),p=d+2,f=new Uint8Array(e.slice(p,p+1))[0],m=0,g=p+1,y="";switch(f){case 1:m=4,y=new Uint8Array(e.slice(g,g+m)).join(".");break;case 2:m=new Uint8Array(e.slice(g,g+1))[0],g+=1,y=(new TextDecoder).decode(e.slice(g,g+m));break;case 3:m=16;let t=new DataView(e.slice(g,g+m)),r=[];for(let e=0;e<8;e++)r.push(t.getUint16(2*e).toString(16));y=r.join(":");break;default:return{hasError:!0,message:`invild  addressType is ${f}`}}return y?{hasError:!1,addressRemote:y,addressType:f,portRemote:h,rawDataIndex:g+m,VLVersion:r,isUDP:o}:{hasError:!0,message:`addressValue is empty, addressType is ${f}`}}async function Jo(e,t,r,n,o){let a=r,i=!1;await e.readable.pipeTo(new WritableStream({start(){},async write(e,r){i=!0,t.readyState!==io&&r.error("webSocket.readyState is not open, maybe close"),a?(t.send(await new Blob([a,e]).arrayBuffer()),a=null):t.send(e)},close(){o(`remoteConnection!.readable is close with hasIncomingData is ${i}`)},abort(e){console.error("remoteConnection!.readable abort",e)}})).catch((e=>{console.error(`${atob("dmxlc3M=")}RemoteSocketToWS has exception `,e.stack||e),Br(t)})),!1===i&&n&&(o("retry"),n())}function qn(e){if(!e)return{earlyData:null,error:null};try{e=e.replace(/-/g,"+").replace(/_/g,"/");let t=atob(e);return{earlyData:Uint8Array.from(t,(e=>e.charCodeAt(0))).buffer,error:null}}catch(e){return{earlyData:null,error:e}}}l(Go,"VLOverWSHandler"),l(Vo,"checkUuidInApiResponse"),l(Yn,"handleTCPOutBound"),l(Xn,"makeReadableWebSocketStream"),l(Qn,"processVLHeader"),l(Jo,"VLRemoteSocketToWS"),l(qn,"base64ToArrayBuffer");var io=1,ta=2;function Br(e){try{(e.readyState===io||e.readyState===ta)&&e.close()}catch(e){console.error("safeCloseWebSocket error",e)}}l(Br,"safeCloseWebSocket");var ce=[];for(let e=0;e<256;++e)ce.push((e+256).toString(16).slice(1));function ea(e,t=0){return(ce[e[t+0]]+ce[e[t+1]]+ce[e[t+2]]+ce[e[t+3]]+"-"+ce[e[t+4]]+ce[e[t+5]]+"-"+ce[e[t+6]]+ce[e[t+7]]+"-"+ce[e[t+8]]+ce[e[t+9]]+"-"+ce[e[t+10]]+ce[e[t+11]]+ce[e[t+12]]+ce[e[t+13]]+ce[e[t+14]]+ce[e[t+15]]).toLowerCase()}function ra(e,t=0){let r=ea(e,t);if(!Nr(r))throw TypeError("Stringified UUID is invalid");return r}async function oa(e,t,r){let n=!1,o=new TransformStream({start(e){},transform(e,t){for(let r=0;r<e.byteLength;){let n=e.slice(r,r+2),o=new DataView(n).getUint16(0),a=new Uint8Array(e.slice(r+2,r+2+o));r=r+2+o,t.enqueue(a)}},flush(e){}});o.readable.pipeTo(new WritableStream({async write(o){let a=await(await fetch(globalThis.dohURL,{method:"POST",headers:{"content-type":"application/dns-message"},body:o})).arrayBuffer(),i=a.byteLength,s=new Uint8Array([i>>8&255,255&i]);e.readyState===io&&(r(`doh success and dns message length is ${i}`),n?e.send(await new Blob([s,a]).arrayBuffer()):(e.send(await new Blob([t,s,a]).arrayBuffer()),n=!0))}})).catch((e=>{r("dns udp has error"+e)}));let a=o.writable.getWriter();return{write(e){a.write(e)}}}l(ea,"unsafeStringify"),l(ra,"stringify"),l(oa,"handleUDPOutBound");var Qo=gr(Yo());import{connect as na}from"cloudflare:sockets";async function qo(e){let t=new WebSocketPair,[r,n]=Object.values(t);n.accept();let o="",a="",i=l(((e,t)=>{console.log(`[${o}:${a}] ${e}`,t||"")}),"log"),s=e.headers.get("sec-websocket-protocol")||"",c=ia(n,s,i),d={value:null};return c.pipeTo(new WritableStream({async write(e,t){if(d.value){let t=d.value.writable.getWriter();return await t.write(e),void t.releaseLock()}let{hasError:r,message:s,portRemote:l=443,addressRemote:c="",rawClientData:u}=await aa(e);if(o=c,a=`${l}--${Math.random()} tcp`,r)throw new Error(s);sa(d,c,l,u,n,i)},close(){i("readableWebSocketStream is closed")},abort(e){i("readableWebSocketStream is aborted",JSON.stringify(e))}})).catch((e=>{i("readableWebSocketStream pipeTo error",e)})),new Response(null,{status:101,webSocket:r})}async function aa(e){if(e.byteLength<56)return{hasError:!0,message:"invalid data"};if(13!==new Uint8Array(e.slice(56,57))[0]||10!==new Uint8Array(e.slice(57,58))[0])return{hasError:!0,message:"invalid header format (missing CR LF)"};if((new TextDecoder).decode(e.slice(0,56))!==Qo.default.sha224(globalThis.TRPassword))return{hasError:!0,message:"invalid password"};let t=e.slice(58);if(t.byteLength<6)return{hasError:!0,message:"invalid SOCKS5 request data"};let r=new DataView(t);if(1!==r.getUint8(0))return{hasError:!0,message:"unsupported command, only TCP (CONNECT) is allowed"};let n=r.getUint8(1),o=0,a=2,i="";switch(n){case 1:o=4,i=new Uint8Array(t.slice(a,a+o)).join(".");break;case 3:o=new Uint8Array(t.slice(a,a+1))[0],a+=1,i=(new TextDecoder).decode(t.slice(a,a+o));break;case 4:o=16;let e=new DataView(t.slice(a,a+o)),r=[];for(let t=0;t<8;t++)r.push(e.getUint16(2*t).toString(16));i=r.join(":");break;default:return{hasError:!0,message:`invalid addressType is ${n}`}}if(!i)return{hasError:!0,message:`address is empty, addressType is ${n}`};let s=a+o,l=t.slice(s,s+2);return{hasError:!1,addressRemote:i,portRemote:new DataView(l).getUint16(0),rawClientData:t.slice(s+4)}}async function sa(e,t,r,n,o,a){async function i(t,r){/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(t)&&(t=`${atob("d3d3Lg==")}${t}${atob("LnNzbGlwLmlv")}`);let o=na({hostname:t,port:r});e.value=o,a(`connected to ${t}:${r}`);let i=o.writable.getWriter();return await i.write(n),i.releaseLock(),o}async function s(){let e=globalThis.pathName.split("/")[2],n=e?atob(e).split(","):void 0,s=n?n[Math.floor(Math.random()*n.length)]:globalThis.proxyIP||t,l=await i(s,r);l.closed.catch((e=>{console.log("retry tcpSocket closed error",e)})).finally((()=>{$r(o)})),Xo(l,o,null,a)}l(i,"connectAndWrite"),l(s,"retry"),Xo(await i(t,r),o,s,a)}function ia(e,t,r){let n=!1;return new ReadableStream({start(o){e.addEventListener("message",(e=>{if(n)return;let t=e.data;o.enqueue(t)})),e.addEventListener("close",(()=>{$r(e),!n&&o.close()})),e.addEventListener("error",(e=>{r("webSocketServer has error"),o.error(e)}));let{earlyData:a,error:i}=la(t);i?o.error(i):a&&o.enqueue(a)},pull(e){},cancel(t){n||(r(`ReadableStream was canceled, due to ${t}`),n=!0,$r(e))}})}async function Xo(e,t,r,n){let o=!1;await e.readable.pipeTo(new WritableStream({start(){},async write(e,r){o=!0,t.readyState!==tn&&r.error("webSocket connection is not open"),t.send(e)},close(){n(`remoteSocket.readable is closed, hasIncomingData: ${o}`)},abort(e){console.error("remoteSocket.readable abort",e)}})).catch((e=>{console.error(`${atob("dHJvamFu")}RemoteSocketToWS error:`,e.stack||e),$r(t)})),!1===o&&r&&(n("retry"),r())}function la(e){if(!e)return{earlyData:null,error:null};try{e=e.replace(/-/g,"+").replace(/_/g,"/");let t=atob(e);return{earlyData:Uint8Array.from(t,(e=>e.charCodeAt(0))).buffer,error:null}}catch(e){return{earlyData:null,error:e}}}l(qo,"TROverWSHandler"),l(aa,"parseTRHeader"),l(sa,"handleTCPOutBound"),l(ia,"makeReadableWebSocketStream"),l(Xo,"TRRemoteSocketToWS"),l(la,"base64ToArrayBuffer");var tn=1,ca=2;function $r(e){try{(e.readyState===tn||e.readyState===ca)&&e.close()}catch(e){console.error("safeCloseWebSocket error",e)}}async function en(e){let t=`\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title>${atob("QlBC")} Error</title>\n        <style>\n            :root {\n                --color: black;\n                --header-color: #09639f; \n                --background-color: #fff;\n                --border-color: #ddd;\n                --header-shadow: 2px 2px 4px rgba(0, 0, 0, 0.25);\n            }\n            body, html {\n                height: 100%;\n                width: 100%;\n                margin: 0;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                font-family: system-ui;\n                color: var(--color);\n                background-color: var(--background-color);\n            }\n            body.dark-mode {\n                --color: white;\n                --header-color: #3498DB; \n                --background-color: #121212;\n                --header-shadow: 2px 2px 4px rgba(255, 255, 255, 0.25);          \n            }\n            h1 { font-size: 2.5rem; text-align: center; color: var(--header-color); text-shadow: var(--header-shadow); }\n            #error-container { text-align: center; }\n        </style>\n    </head>\n    <body>\n        <div id="error-container">\n            <h1>${atob("QlBC")} Panel <span style="font-size: smaller;">${globalThis.panelVersion}</span> </h1>\n            <div id="error-message">\n                <h2> Something went wrong!</h2>\n                <p><b>${e?` ${e.cause?e.message.toString():e.stack.toString()}`:""}</b></p>\n            </div>\n        </div>\n    <script>\n        localStorage.getItem('darkMode') === 'enabled' && document.body.classList.add('dark-mode');\n    <\/script>\n    </body>\n    </html>`;return new Response(t,{status:200,headers:{"Content-Type":"text/html"}})}async function ir(e,t,r,n,o){let{remoteDNS:a,localDNS:i,VLTRFakeDNS:s,enableIPv6:l,warpFakeDNS:c,warpEnableIPv6:d,blockAds:u,bypassIran:h,bypassChina:p,blockPorn:f,bypassRussia:m,customBypassRules:g,customBlockRules:y}=e,b=[{rule:h,domain:"geosite:category-ir",ip:"geoip:ir"},{rule:p,domain:"geosite:cn",ip:"geoip:cn"},{rule:m,domain:"geosite:category-ru",ip:"geoip:ru"}],v=[{rule:u,host:"geosite:category-ads-all"},{rule:u,host:"geosite:category-ads-ir"},{rule:f,host:"geosite:category-porn"}],w=s&&!o||c&&o,_=l&&!o||d&&o,x=t.filter((e=>qt(e))),k=g.split(",").filter((e=>qt(e))),S=y.split(",").filter((e=>qt(e))),C=[...new Set(x)],E=[...C,...k].length>0,A=h||p||m,P=u||f||S.length>0,I=n?["https://cloudflare-dns.com/dns-query"]:o?d?["1.1.1.1","1.0.0.1","2606:4700:4700::1111","2606:4700:4700::1001"]:["1.1.1.1","1.0.0.1"]:[a],R={};P&&(v.forEach((({rule:e,host:t})=>{e&&(R[t]=["127.0.0.1"])})),S.forEach((e=>{R[`domain:${e}`]=["127.0.0.1"]})));let T=r?await br(r):void 0;if(T&&(R[r]=l?[...T.ipv4,...T.ipv6]:T.ipv4),n){let e=["cloudflare-dns.com","cloudflare.com","dash.cloudflare.com"],t=await Promise.all(e.map(br)),r=t.flatMap((e=>e.ipv4)),n=l?t.flatMap((e=>e.ipv6)):[];R["cloudflare-dns.com"]=[...r,...n]}let N={...Object.keys(R).length?{hosts:R}:{},servers:I,queryStrategy:_?"UseIP":"UseIPv4",tag:"dns"},D=sr(a);if(D.isHostDomain&&!n&&!o&&N.servers.push({address:"https://8.8.8.8/dns-query",domains:[`full:${D.host}`],skipFallback:!0}),E){let e=C.map((e=>`full:${e}`)),t=k.map((e=>`domain:${e}`));N.servers.push({address:i,domains:[...e,...t],skipFallback:!0})}let $={address:i,domains:[],expectIPs:[],skipFallback:!0};if(!n&&A&&(b.forEach((({rule:e,domain:t,ip:r})=>{e&&($.domains.push(t),$.expectIPs.push(r))})),N.servers.push($)),w){let e=A&&!n?{address:"fakedns",domains:$.domains}:"fakedns";N.servers.unshift(e)}return N}function Le(e,t,r,n,o){let{localDNS:a,bypassLAN:i,bypassIran:s,bypassChina:c,bypassRussia:d,blockAds:u,blockPorn:h,blockUDP443:p,customBypassRules:f,customBlockRules:m}=e,g=[{rule:i,type:"direct",domain:"geosite:private",ip:"geoip:private"},{rule:s,type:"direct",domain:"geosite:category-ir",ip:"geoip:ir"},{rule:c,type:"direct",domain:"geosite:cn",ip:"geoip:cn"},{rule:u,type:"block",domain:"geosite:category-ads-all"},{rule:u,type:"block",domain:"geosite:category-ads-ir"},{rule:h,type:"block",domain:"geosite:category-porn"}],y=t.filter((e=>qt(e))),b=f?f.split(","):[],v=m?m.split(","):[],w=[...y,...b.filter((e=>qt(e)))].length>0,_=u||h||v.length>0,x=s||c||d||b.length>0,k=r?"chain":o?"fragment":"proxy",S=[{inboundTag:["dns-in"],outboundTag:"dns-out",type:"field"},{inboundTag:["socks-in"],port:"53",outboundTag:"dns-out",type:"field"}];if(!o&&(w||x)&&"localhost"!==a&&S.push({inboundTag:["dns"],ip:[a],port:"53",outboundTag:"direct",type:"field"}),o||S.push({inboundTag:["dns"],[n?"balancerTag":"outboundTag"]:n?"all":k,type:"field"}),p&&S.push({network:"udp",port:"443",outboundTag:"block",type:"field"}),x||_){let e,t,r=l(((e,t)=>({[e]:[],outboundTag:t,type:"field"})),"createRule");o||(e=r("domain","direct"),t=r("ip","direct"));let n=r("domain","block"),a=r("ip","block");g.forEach((({rule:r,type:o,domain:a,ip:i})=>{r&&("direct"===o?(e?.domain.push(a),t?.ip?.push(i)):n.domain.push(a))})),b.forEach((r=>{qt(r)?e?.domain.push(`domain:${r}`):t?.ip.push(r)})),v.forEach((e=>{qt(e)?n.domain.push(`domain:${e}`):a.ip.push(e)})),n.domain.length&&S.push(n),a.ip.length&&S.push(a),o||(e.domain.length&&S.push(e),t.ip.length&&S.push(t))}return n?S.push({network:"tcp,udp",balancerTag:"all",type:"field"}):S.push({network:"tcp,udp",outboundTag:k,type:"field"}),S}function on(e,t,r,n,o,a,i,s,l){let{userID:c,defaultHttpsPorts:d}=globalThis,u={protocol:atob("dmxlc3M="),settings:{vnext:[{address:t,port:+r,users:[{id:c,encryption:"none",level:8}]}]},streamSettings:{network:"ws",security:"none",sockopt:{},wsSettings:{host:n,path:`/${Se(16)}${a?`/${btoa(a)}`:""}?ed=2560`}},tag:e};d.includes(r)&&(u.streamSettings.security="tls",u.streamSettings.tlsSettings={allowInsecure:s,fingerprint:"randomized",alpn:["http/1.1"],serverName:o});let h=u.streamSettings.sockopt;return i?h.dialerProxy="fragment":h.domainStrategy=l?"UseIPv4v6":"UseIPv4",u}function fa(e,t,r,n,o,a,i,s,l){let{TRPassword:c,defaultHttpsPorts:d}=globalThis,u={protocol:atob("dHJvamFu"),settings:{servers:[{address:t,port:+r,password:c,level:8}]},streamSettings:{network:"ws",security:"none",sockopt:{},wsSettings:{host:n,path:`/tr${Se(16)}${a?`/${btoa(a)}`:""}?ed=2560`}},tag:e};d.includes(r)&&(u.streamSettings.security="tls",u.streamSettings.tlsSettings={allowInsecure:s,fingerprint:"randomized",alpn:["http/1.1"],serverName:o});let h=u.streamSettings.sockopt;return i?h.dialerProxy="fragment":h.domainStrategy=l?"UseIPv4v6":"UseIPv4",u}function rn(e,t,r,n,o){let{nikaNGNoiseMode:a,noiseCountMin:i,noiseCountMax:s,noiseSizeMin:l,noiseSizeMax:c,noiseDelayMin:d,noiseDelayMax:u}=e,h="proxy"===n,{warpIPv6:p,reserved:f,publicKey:m,privateKey:g}=ze(t,h),y={protocol:"wireguard",settings:{address:["172.16.0.2/32",p],mtu:1280,peers:[{endpoint:h?"162.159.192.1:2408":r,publicKey:m,keepAlive:5}],reserved:Ir(f),secretKey:g},streamSettings:{sockopt:{dialerProxy:n}},tag:h?"chain":"proxy"};return!n&&delete y.streamSettings,"nikang"===o&&!h&&delete y.streamSettings&&Object.assign(y.settings,{wnoise:a,wnoisecount:i===s?i:`${i}-${s}`,wpayloadsize:l===c?l:`${l}-${c}`,wnoisedelay:d===u?d:`${d}-${u}`}),y}function da(e,t){if(["socks","http"].includes(e.protocol)){let{protocol:r,server:n,port:o,user:a,pass:i}=e;return{protocol:r,settings:{servers:[{address:n,port:+o,users:[{user:a,pass:i,level:8}]}]},streamSettings:{network:"tcp",sockopt:{dialerProxy:"proxy",domainStrategy:t?"UseIPv4v6":"UseIPv4"}},mux:{enabled:!0,concurrency:8,xudpConcurrency:16,xudpProxyUDP443:"reject"},tag:"chain"}}let{server:r,port:n,uuid:o,flow:a,security:i,type:s,sni:l,fp:c,alpn:d,pbk:u,sid:h,spx:p,headerType:f,host:m,path:g,authority:y,serviceName:b,mode:v}=e,w={mux:{concurrency:8,enabled:!0,xudpConcurrency:16,xudpProxyUDP443:"reject"},protocol:atob("dmxlc3M="),settings:{vnext:[{address:r,port:+n,users:[{encryption:"none",flow:a,id:o,level:8,security:"auto"}]}]},streamSettings:{network:s,security:i,sockopt:{dialerProxy:"proxy",domainStrategy:t?"UseIPv4v6":"UseIPv4"}},tag:"chain"};if("tls"===i){let e=d?d?.split(","):[];w.streamSettings.tlsSettings={allowInsecure:!1,fingerprint:c,alpn:e,serverName:l}}if("reality"===i&&(delete w.mux,w.streamSettings.realitySettings={fingerprint:c,publicKey:u,serverName:l,shortId:h,spiderX:p}),"http"===f){let e=g?.split(","),t=m?.split(",");w.streamSettings.tcpSettings={header:{request:{headers:{Host:t},method:"GET",path:e,version:"1.1"},response:{headers:{"Content-Type":["application/octet-stream"]},reason:"OK",status:"200",version:"1.1"},type:"http"}}}return"tcp"===s&&"reality"!==i&&!f&&(w.streamSettings.tcpSettings={header:{type:"none"}}),"ws"===s&&(w.streamSettings.wsSettings={headers:{Host:m},path:g}),"grpc"===s&&(delete w.mux,w.streamSettings.grpcSettings={authority:y,multiMode:"multi"===v,serviceName:b}),w}function lo(e,t,r,n){let{xrayUdpNoises:o,fragmentPackets:a,lengthMin:i,lengthMax:s,intervalMin:l,intervalMax:c,enableIPv6:d,warpEnableIPv6:u}=e,h={tag:n,protocol:"freedom",settings:{}};return t&&(h.settings.fragment={packets:a,length:`${i}-${s}`,interval:`${l}-${c}`},h.settings.domainStrategy=d?"UseIPv4v6":"UseIPv4"),r&&(h.settings.noises=[],JSON.parse(o).forEach((e=>{let t=+e.count;delete e.count,h.settings.noises.push(...Array.from({length:t},(()=>e)))})),t||(h.settings.domainStrategy=u?"UseIPv4v6":"UseIPv4")),h}function We(e,t,r,n,o,a){let{VLTRFakeDNS:i,warpFakeDNS:s,bestVLTRInterval:l,bestWarpInterval:c}=e,d=i&&!a||s&&a,u=structuredClone(ma);if(u.remarks=t,d&&u.inbounds[0].sniffing.destOverride.push("fakedns"),r){let e=a?c:l;u.observatory.probeInterval=`${e}s`,o&&(u.routing.balancers[0].fallbackTag="prox-2"),n&&(u.observatory.subjectSelector=["chain"],u.routing.balancers[0].selector=["chain"])}else delete u.observatory,delete u.routing.balancers;return u}async function ua(e,t,r,n,o){let a=We(e,o?` ${atob("QlBC")} F - Best Ping `:` ${atob("QlBC")} - Best Ping `,!0,r,!0);return a.dns=await ir(e,t,void 0,!1,!1),a.routing.rules=Le(e,t,r,!0,!1),a.outbounds.unshift(...n),a}async function ha(e,t,r,n){let o=We(e,` ${atob("QlBC")} F - Best Fragment `,!0,r,!1,!1);o.dns=await ir(e,[],t,!1,!1),o.routing.rules=Le(e,[],r,!0,!1);let a=[],i=n.pop();return["10-20","20-30","30-40","40-50","50-60","60-70","70-80","80-90","90-100","10-30","20-40","30-50","40-60","50-70","60-80","70-90","80-100","100-200"].forEach(((e,t)=>{if(r){let e=structuredClone(r);e.tag=`chain-${t+1}`,e.streamSettings.sockopt.dialerProxy=`prox-${t+1}`,a.push(e)}let o=structuredClone(n[r?1:0]);o.tag=`prox-${t+1}`,o.streamSettings.sockopt.dialerProxy=`frag-${t+1}`;let s=structuredClone(i);s.tag=`frag-${t+1}`,s.settings.fragment.length=e,s.settings.fragment.interval="1-1",a.push(o,s)})),o.outbounds.unshift(...a),o}async function pa(e){let t=We(e,` ${atob("QlBC")} F - WorkerLess `,!1,!1,!1,!1),r=lo(e,!0,!0,"fragment");t.outbounds.unshift(r),t.dns=await ir(e,[],void 0,!0),t.routing.rules=Le(e,[],!1,!1,!0);let n=on("fake-outbound","google.com","443",globalThis.userID,"google.com","google.com","",!0,!1);return n.streamSettings.wsSettings.path="/",t.outbounds.push(n),t}async function co(e,t,r){let n,{hostName:o,defaultHttpsPorts:a}=globalThis,{proxySettings:i}=await be(e,t),s=[],l=[],c=[],{proxyIP:d,outProxy:u,outProxyParams:h,cleanIPs:p,enableIPv6:f,customCdnAddrs:m,customCdnHost:g,customCdnSni:y,VLConfigs:b,TRConfigs:v,ports:w}=i;if(u){let e=JSON.parse(h);try{n=da(e,f)}catch(e){console.log("An error occured while parsing chain proxy: ",e),n=void 0,await t.kv.put("proxySettings",JSON.stringify({...i,outProxy:"",outProxyParams:{}}))}}let _=await Oe(p,f),x=m?m.split(","):[],k=r?[..._]:[..._,...x],S=w.filter((e=>!r||a.includes(e)));b&&c.push(atob("VkxFU1M=")),v&&c.push(atob("VHJvamFu"));let C=1,E=r?lo(i,!0,!1,"fragment"):null;for(let e of c){let t=1;for(let a of S)for(let c of k){let u=x.includes(c),h=u?"C":r?"F":"",m=u?y:Me(o),b=u?g:o,v=We(i,Be(t,a,c,p,e,h),!1,n,!1,!1);r&&v.outbounds.unshift(E),v.dns=await ir(i,[c],void 0,!1,!1),v.routing.rules=Le(i,[c],n,!1,!1);let w=e===atob("VkxFU1M=")?on("proxy",c,a,b,m,d,r,u,f):fa("proxy",c,a,b,m,d,r,u,f);if(v.outbounds.unshift({...w}),w.tag=`prox-${C}`,n){v.outbounds.unshift(n);let e=structuredClone(n);e.tag=`chain-${C}`,e.streamSettings.sockopt.dialerProxy=`prox-${C}`,l.push(e)}l.push(w),s.push(v),C++,t++}}r&&l.push(E);let A=await ua(i,k,n,l,r),P=[...s,A];if(r){let e=await ha(i,o,n,l),t=await pa(i);P.push(e,t)}return new Response(JSON.stringify(P,null,4),{status:200,headers:{"Content-Type":"text/plain;charset=utf-8","Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate","CDN-Cache-Control":"no-store"}})}async function nn(e,t,r){let n,{proxySettings:o,warpConfigs:a}=await be(e,t),{warpEndpoints:i}=o,s=[],l=[],c=[],d=[],u=i.split(",").map((e=>e.split(":")[0])).filter((e=>qt(e))),h="xray"!==r?" Pro ":" ",p="xray-pro"===r?"udp-noise":void 0;for(let[e,t]of i.split(",").entries()){let i=t.split(":")[0],u=We(o,` ${e+1} - Warp${h}`,!1,!1,!1,!0),f=We(o,` ${e+1} - WoW${h}`,!1,!0,!1,!0);"xray-pro"===r&&(n=lo(o,!1,!0,"udp-noise"),u.outbounds.unshift(n),f.outbounds.unshift(n)),u.dns=f.dns=await ir(o,[i],void 0,!1,!0),u.routing.rules=Le(o,[i],!1,!1,!1),f.routing.rules=Le(o,[i],!0,!1,!1);let m=rn(o,a,t,p,r),g=rn(o,a,t,"proxy",r);u.outbounds.unshift(m),f.outbounds.unshift(g,m),s.push(u),l.push(f);let y=structuredClone(m);y.tag=`prox-${e+1}`;let b=structuredClone(g);b.tag=`chain-${e+1}`,b.streamSettings.sockopt.dialerProxy=`prox-${e+1}`,c.push(y),d.push(b)}let f=await ir(o,u,void 0,!1,!0),m=We(o,` Warp${h}- Best Ping `,!0,!1,!1,!0);m.dns=f,m.routing.rules=Le(o,u,!1,!0,!1),"xray-pro"===r&&m.outbounds.unshift(n),m.outbounds.unshift(...c);let g=We(o,` WoW${h}- Best Ping `,!0,!0,!1,!0);g.dns=f,g.routing.rules=Le(o,u,!0,!0,!1),"xray-pro"===r&&g.outbounds.unshift(n),g.outbounds.unshift(...d,...c);let y=[...s,...l,m,g];return new Response(JSON.stringify(y,null,4),{status:200,headers:{"Content-Type":"text/plain;charset=utf-8","Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate","CDN-Cache-Control":"no-store"}})}l($r,"safeCloseWebSocket"),l(en,"renderErrorPage"),l(ir,"buildXrayDNS"),l(Le,"buildXrayRoutingRules"),l(on,"buildXrayVLOutbound"),l(fa,"buildXrayTROutbound"),l(rn,"buildXrayWarpOutbound"),l(da,"buildXrayChainOutbound"),l(lo,"buildFreedomOutbound"),l(We,"buildXrayConfig"),l(ua,"buildXrayBestPingConfig"),l(ha,"buildXrayBestFragmentConfig"),l(pa,"buildXrayWorkerLessConfig"),l(co,"getXrayCustomConfigs"),l(nn,"getXrayWarpConfigs");var ma={remarks:"",log:{loglevel:"warning"},dns:{},inbounds:[{port:10808,protocol:"socks",settings:{auth:"noauth",udp:!0,userLevel:8},sniffing:{destOverride:["http","tls"],enabled:!0,routeOnly:!0},tag:"socks-in"},{port:10853,protocol:"dokodemo-door",settings:{address:"1.1.1.1",network:"tcp,udp",port:53},tag:"dns-in"}],outbounds:[{protocol:"dns",tag:"dns-out"},{protocol:"freedom",settings:{domainStrategy:"UseIP"},tag:"direct"},{protocol:"blackhole",settings:{response:{type:"http"}},tag:"block"}],policy:{levels:{8:{connIdle:300,downlinkOnly:1,handshake:4,uplinkOnly:1}},system:{statsOutboundUplink:!0,statsOutboundDownlink:!0}},routing:{domainStrategy:"IPIfNonMatch",rules:[],balancers:[{tag:"all",selector:["prox"],strategy:{type:"leastPing"}}]},observatory:{subjectSelector:["prox"],probeUrl:"https://www.gstatic.com/generate_204",probeInterval:"30s",enableConcurrency:!0},stats:{}};function sn(e,t,r){let n,o,{remoteDNS:a,localDNS:i,VLTRFakeDNS:s,enableIPv6:c,warpFakeDNS:d,warpEnableIPv6:u,bypassIran:h,bypassChina:p,bypassRussia:f,blockAds:m,blockPorn:g,customBypassRules:y,customBlockRules:b}=e,v=sr(a),w=s&&!r||d&&r,_=c&&!r||u&&r,x=y.split(",").filter((e=>qt(e))),k=b.split(",").filter((e=>qt(e))),S=[{rule:h,type:"direct",geosite:"geosite-ir",geoip:"geoip-ir"},{rule:p,type:"direct",geosite:"geosite-cn",geoip:"geoip-cn"},{rule:f,type:"direct",geosite:"geosite-category-ru",geoip:"geoip-ru"},{rule:!0,type:"block",geosite:"geosite-malware"},{rule:!0,type:"block",geosite:"geosite-phishing"},{rule:!0,type:"block",geosite:"geosite-cryptominers"},{rule:m,type:"block",geosite:"geosite-category-ads-all"},{rule:g,type:"block",geosite:"geosite-nsfw"}],C=[{address:r?"1.1.1.1":a,address_resolver:v.isHostDomain?"doh-resolver":"dns-direct",detour:" Selector",tag:"dns-remote"},{address:"localhost"===i?"local":i,detour:"direct",tag:"dns-direct"},{address:"local",tag:"dns-local"}];if(v.isHostDomain&&!r&&C.push({address:"https://8.8.8.8/dns-query",detour:" Selector",tag:"doh-resolver"}),r)o={outbound:"any",server:"dns-direct"};else{let e=t.filter((e=>qt(e)));o={domain:[...new Set(e)],server:"dns-direct"}}let E=[o,{domain:["raw.githubusercontent.com","time.apple.com"],server:"dns-direct"},{clash_mode:"Direct",server:"dns-direct"},{clash_mode:"Global",server:"dns-remote"}],A={disable_cache:!0,rule_set:[],action:"reject"};S.forEach((({rule:e,type:t,geosite:r,geoip:n})=>{e&&"direct"===t&&E.push({type:"logical",mode:"and",rules:[{rule_set:r},{rule_set:n}],server:"dns-direct"}),e&&"block"===t&&A.rule_set.push(r)})),E.push(A);let P,I,R=l((e=>({domain_suffix:[],server:e})),"createRule");return x.length&&(P=R("dns-direct"),x.forEach((e=>{P.domain_suffix.push(e)})),E.push(P)),k.length&&(I=R("dns-block"),k.forEach((e=>{I.domain_suffix.push(e)})),E.push(I)),w&&(C.push({address:"fakeip",tag:"dns-fake"}),E.push({disable_cache:!0,inbound:"tun-in",query_type:["A","AAAA"],server:"dns-fake"}),n={enabled:!0,inet4_range:"198.18.0.0/15"},_&&(n.inet6_range="fc00::/18")),{servers:C,rules:E,fakeip:n}}function ln(e){let{bypassLAN:t,bypassIran:r,bypassChina:n,bypassRussia:o,blockAds:a,blockPorn:i,blockUDP443:s,customBypassRules:c,customBlockRules:d}=e,u=c?c.split(","):[],h=d?d.split(","):[],p=[{rule:r,type:"direct",ruleSet:{geosite:"geosite-ir",geoip:"geoip-ir",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geosite-ir.srs",geoipURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geoip-ir.srs"}},{rule:n,type:"direct",ruleSet:{geosite:"geosite-cn",geoip:"geoip-cn",geositeURL:"https://raw.githubusercontent.com/SagerNet/sing-geosite/rule-set/geosite-cn.srs",geoipURL:"https://raw.githubusercontent.com/SagerNet/sing-geoip/rule-set/geoip-cn.srs"}},{rule:o,type:"direct",ruleSet:{geosite:"geosite-category-ru",geoip:"geoip-ru",geositeURL:"https://raw.githubusercontent.com/SagerNet/sing-geosite/rule-set/geosite-category-ru.srs",geoipURL:"https://raw.githubusercontent.com/SagerNet/sing-geoip/rule-set/geoip-ru.srs"}},{rule:!0,type:"block",ruleSet:{geosite:"geosite-malware",geoip:"geoip-malware",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geosite-malware.srs",geoipURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geoip-malware.srs"}},{rule:!0,type:"block",ruleSet:{geosite:"geosite-phishing",geoip:"geoip-phishing",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geosite-phishing.srs",geoipURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geoip-phishing.srs"}},{rule:!0,type:"block",ruleSet:{geosite:"geosite-cryptominers",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geosite-cryptominers.srs"}},{rule:a,type:"block",ruleSet:{geosite:"geosite-category-ads-all",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geosite-category-ads-all.srs"}},{rule:i,type:"block",ruleSet:{geosite:"geosite-nsfw",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geosite-nsfw.srs"}}],f=[],m=[],g=[],y=[],b=[];t&&m.push({ip_is_private:!0,outbound:"direct"});let v=l(((e,t)=>"direct"===t?{[e]:[],outbound:t}:{[e]:[],action:t}),"createRule"),w={type:"remote",tag:"",format:"binary",url:"",download_detour:"direct"},_=v("rule_set","direct"),x=v("rule_set","direct"),k=v("rule_set","reject"),S=v("rule_set","reject");p.forEach((({rule:e,type:t,ruleSet:r})=>{if(!e)return;let{geosite:n,geoip:o,geositeURL:a,geoipURL:i}=r,s="direct"===t,l=s?x:S;(s?_:k).rule_set.push(n),b.push({...w,tag:n,url:a}),o&&(l.rule_set.push(o),b.push({...w,tag:o,url:i}))}));let C=l(((e,t)=>{(e.rule_set?.length||e.domain_suffix?.length||e.ip_cidr?.length)&&t.push(e)}),"pushRuleIfNotEmpty");C(_,f),C(x,m),C(k,g),C(S,y);let E=l(((e,t)=>{let r=v("domain_suffix",t),n=v("ip_cidr",t);e.forEach((e=>{if(qt(e))r.domain_suffix.push(e);else{let t=Ye(e)?e.replace(/\[|\]/g,""):e;n.ip_cidr.push(t)}})),C(r,"direct"===t?f:g),C(n,"direct"===t?m:y)}),"processRules");u.length&&E(u,"direct"),h.length&&E(h,"reject");let A=[];return s&&A.push({network:"udp",port:443,protocol:"quic",action:"reject"}),A=[{action:"sniff"},{action:"hijack-dns",mode:"or",rules:[{inbound:"dns-in"},{protocol:"dns"}],type:"logical"},{clash_mode:"Direct",outbound:"direct"},{clash_mode:"Global",outbound:" Selector"},...A,...g,...y,...f,...m],{rules:A,rule_set:b}}function ba(e,t,r,n,o,a,i){let{userID:s,defaultHttpsPorts:l}=globalThis,{enableIPv6:c,proxyIP:d}=e,u=`/${Se(16)}${d?`/${btoa(d)}`:""}`,h=!!l.includes(n),p={type:atob("dmxlc3M="),server:r,server_port:+n,uuid:s,packet_encoding:"",tls:{alpn:"http/1.1",enabled:!0,insecure:i,server_name:a,utls:{enabled:!0,fingerprint:"randomized"}},transport:{early_data_header_name:"Sec-WebSocket-Protocol",max_early_data:2560,headers:{Host:o},path:u,type:"ws"},tcp_fast_open:!0,tcp_multi_path:!0,tag:t};return qt(r)&&(p.domain_strategy=c?"prefer_ipv4":"ipv4_only"),h||delete p.tls,p}function ga(e,t,r,n,o,a,i){let{TRPassword:s,defaultHttpsPorts:l}=globalThis,{enableIPv6:c,proxyIP:d}=e,u=`/tr${Se(16)}${d?`/${btoa(d)}`:""}`,h=!!l.includes(n),p={type:atob("dHJvamFu"),password:s,server:r,server_port:+n,tls:{alpn:"http/1.1",enabled:!0,insecure:i,server_name:a,utls:{enabled:!0,fingerprint:"randomized"}},transport:{early_data_header_name:"Sec-WebSocket-Protocol",max_early_data:2560,headers:{Host:o},path:u,type:"ws"},tcp_fast_open:!0,tcp_multi_path:!0,tag:t};return qt(r)&&(p.domain_strategy=c?"prefer_ipv4":"ipv4_only"),h||delete p.tls,p}function an(e,t,r,n,o){let a=n.includes("[")?n.match(/\[(.*?)\]/)[1]:n.split(":")[0],i=n.includes("[")?+n.match(/[^:]*$/)[0]:+n.split(":")[1],s=o?"162.159.192.1":a,l=o?2408:i,{warpEnableIPv6:c}=e,{warpIPv6:d,reserved:u,publicKey:h,privateKey:p}=ze(t,o),f={address:["172.16.0.2/32",d],mtu:1280,peers:[{address:s,port:l,public_key:h,reserved:Ir(u),allowed_ips:["0.0.0.0/0","::/0"],persistent_keepalive_interval:5}],private_key:p,type:"wireguard",tag:r};return qt(s)&&(f.domain_strategy=c?"prefer_ipv4":"ipv4_only"),o&&(f.detour=o),f}function ya(e,t){if(["socks","http"].includes(e.protocol)){let{protocol:r,server:n,port:o,user:a,pass:i}=e,s={type:r,tag:"",server:n,server_port:+o,username:a,password:i,detour:""};return qt(n)&&(s.domain_strategy=t?"prefer_ipv4":"ipv4_only"),"socks"===r&&(s.version="5"),s}let{server:r,port:n,uuid:o,flow:a,security:i,type:s,sni:l,fp:c,alpn:d,pbk:u,sid:h,headerType:p,host:f,path:m,serviceName:g}=e,y={type:atob("dmxlc3M="),tag:"",server:r,server_port:+n,uuid:o,flow:a,detour:""};if(qt(r)&&(y.domain_strategy=t?"prefer_ipv4":"ipv4_only"),"tls"===i||"reality"===i){let e=d?d?.split(",").filter((e=>"h2"!==e)):[];y.tls={enabled:!0,server_name:l,insecure:!1,alpn:e,utls:{enabled:!0,fingerprint:c}},"reality"===i&&(y.tls.reality={enabled:!0,public_key:u,short_id:h},delete y.tls.alpn)}if("http"===p){let e=f?.split(",");y.transport={type:"http",host:e,path:m,method:"GET",headers:{Connection:["keep-alive"],"Content-Type":["application/octet-stream"]}}}if("ws"===s){let e=m?.split("?ed=")[0],t=+m?.split("?ed=")[1]||0;y.transport={type:"ws",path:e,headers:{Host:f},max_early_data:t,early_data_header_name:"Sec-WebSocket-Protocol"}}return"grpc"===s&&(y.transport={type:"grpc",service_name:g}),y}async function cn(e,t){let{proxySettings:r,warpConfigs:n}=await be(e,t),{warpEndpoints:o}=r,a=structuredClone(dn);a.endpoints=[];let i=sn(r,void 0,!0),{rules:s,rule_set:l}=ln(r);a.dns.servers=i.servers,a.dns.rules=i.rules,i.fakeip&&(a.dns.fakeip=i.fakeip),a.route.rules=s,a.route.rule_set=l;let c=a.outbounds[0],d=a.outbounds[1];c.outbounds=[" Warp - Best Ping "," WoW - Best Ping "],a.outbounds.splice(2,0,structuredClone(d));let u=a.outbounds[2];d.tag=" Warp - Best Ping ",d.interval=`${r.bestWarpInterval}s`,u.tag=" WoW - Best Ping ",u.interval=`${r.bestWarpInterval}s`;let h=[],p=[];return o.split(",").forEach(((e,t)=>{let o=` ${t+1} - Warp `,i=` ${t+1} - WoW `,s=an(r,n,o,e,""),l=an(r,n,i,e,o);a.endpoints.push(l,s),h.push(o),p.push(i),d.outbounds.push(o),u.outbounds.push(i)})),c.outbounds.push(...h,...p),new Response(JSON.stringify(a,null,4),{status:200,headers:{"Content-Type":"text/plain;charset=utf-8","Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate","CDN-Cache-Control":"no-store"}})}async function fn(e,t){let r,{hostName:n}=globalThis,{proxySettings:o}=await be(e,t),{cleanIPs:a,ports:i,VLConfigs:s,TRConfigs:l,outProxy:c,outProxyParams:d,customCdnAddrs:u,customCdnHost:h,customCdnSni:p,bestVLTRInterval:f,enableIPv6:m}=o;if(c){let e=JSON.parse(d);try{r=ya(e,m)}catch(e){console.log("An error occured while parsing chain proxy: ",e),r=void 0,await t.kv.put("proxySettings",JSON.stringify({...o,outProxy:"",outProxyParams:{}}))}}let g=await Oe(a,m),y=u?u.split(","):[],b=[...g,...y],v=structuredClone(dn),w=sn(o,b,!1),{rules:_,rule_set:x}=ln(o);v.dns.servers=w.servers,v.dns.rules=w.rules,w.fakeip&&(v.dns.fakeip=w.fakeip),v.route.rules=_,v.route.rule_set=x;let k=v.outbounds[0],S=v.outbounds[1];k.outbounds=[" Best Ping "],S.interval=`${f}s`,S.tag=" Best Ping ";let C=1;return[...s?[atob("VkxFU1M=")]:[],...l?[atob("VHJvamFu")]:[]].forEach((e=>{let t=1;i.forEach((i=>{b.forEach((s=>{let l,c,d=y.includes(s),u=d?"C":"",f=d?p:Me(n),m=d?h:n,g=Be(t,i,s,a,e,u);if(e===atob("VkxFU1M=")&&(l=ba(o,r?`proxy-${C}`:g,s,i,m,f,d),v.outbounds.push(l)),e===atob("VHJvamFu")&&(c=ga(o,r?`proxy-${C}`:g,s,i,m,f,d),v.outbounds.push(c)),r){let e=structuredClone(r);e.tag=g,e.detour=`proxy-${C}`,v.outbounds.push(e)}k.outbounds.push(g),S.outbounds.push(g),C++,t++}))}))})),new Response(JSON.stringify(v,null,4),{status:200,headers:{"Content-Type":"text/plain;charset=utf-8","Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate","CDN-Cache-Control":"no-store"}})}l(sn,"buildSingBoxDNS"),l(ln,"buildSingBoxRoutingRules"),l(ba,"buildSingBoxVLOutbound"),l(ga,"buildSingBoxTROutbound"),l(an,"buildSingBoxWarpOutbound"),l(ya,"buildSingBoxChainOutbound"),l(cn,"getSingBoxWarpConfig"),l(fn,"getSingBoxCustomConfig");var dn={log:{level:"warn",timestamp:!0},dns:{servers:[],rules:[],strategy:"ipv4_only",independent_cache:!0},inbounds:[{type:"direct",tag:"dns-in",listen:"0.0.0.0",listen_port:6450,override_address:"1.1.1.1",override_port:53},{type:"tun",tag:"tun-in",address:["172.18.0.1/30","fdfe:dcba:9876::1/126"],mtu:9e3,auto_route:!0,strict_route:!0,endpoint_independent_nat:!0,stack:"mixed"},{type:"mixed",tag:"mixed-in",listen:"0.0.0.0",listen_port:2080}],outbounds:[{type:"selector",tag:" Selector",outbounds:[]},{type:"urltest",tag:"",outbounds:[],url:"https://www.gstatic.com/generate_204",interval:""},{type:"direct",domain_strategy:"ipv4_only",tag:"direct"}],route:{rules:[],rule_set:[],auto_detect_interface:!0,override_android_vpn:!0,final:" Selector"},ntp:{enabled:!0,server:"time.apple.com",server_port:123,detour:"direct",interval:"30m"},experimental:{cache_file:{enabled:!0,store_fakeip:!0},clash_api:{external_controller:"127.0.0.1:9090",external_ui:"ui",external_ui_download_url:"https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip",external_ui_download_detour:"direct",default_mode:"Rule"}}};async function hn(e,t,r){let{remoteDNS:n,localDNS:o,VLTRFakeDNS:a,outProxyParams:i,enableIPv6:s,warpFakeDNS:l,warpEnableIPv6:c,bypassIran:d,bypassChina:u,bypassRussia:h,customBypassRules:p}=e,f=c?["1.1.1.1","1.0.0.1","[2606:4700:4700::1111]","[2606:4700:4700::1001]"]:["1.1.1.1","1.0.0.1"],m="localhost"===o?"system":`${o}#DIRECT`,g=a&&!r||l&&r,y=s&&!r||c&&r,b=p.split(",").filter((e=>qt(e))),v=d||u||h,w=[{rule:d,geosite:"ir"},{rule:u,geosite:"cn"},{rule:h,geosite:"ru"}],_={enable:!0,listen:"0.0.0.0:1053",ipv6:y,"respect-rules":!0,"use-system-hosts":!1,nameserver:r?f.map((e=>`${e}# Selector`)):[t?`${n}#proxy-1`:`${n}# Selector`],"proxy-server-nameserver":[m],"nameserver-policy":{"raw.githubusercontent.com":m,"time.apple.com":m}};if(t&&!r){let e=JSON.parse(i).server;qt(e)&&(_["nameserver-policy"][e]=`${n}#proxy-1`)}if(v){let e=[];w.forEach((({rule:t,geosite:r})=>{t&&e.push(r)})),_["nameserver-policy"][`rule-set:${e.join(",")}`]=[m]}return b.forEach((e=>{_["nameserver-policy"][`+.${e}`]=[m]})),sr(n).isHostDomain&&!r&&(_["default-nameserver"]=["https://8.8.8.8/dns-query#"+(t?"proxy-1":" Selector")]),g&&Object.assign(_,{"enhanced-mode":"fake-ip","fake-ip-range":"198.18.0.1/16","fake-ip-filter":["geosite:private"]}),_}function pn(e){let{bypassLAN:t,bypassIran:r,bypassChina:n,bypassRussia:o,blockAds:a,blockPorn:i,blockUDP443:s,customBypassRules:c,customBlockRules:d}=e,u=c?c.split(","):[],h=d?d.split(","):[],p=[{rule:t,type:"direct",noResolve:!0,ruleProvider:{format:"yaml",geosite:"private",geoip:"private-cidr",geositeURL:"https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/private.yaml",geoipURL:"https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/private.yaml"}},{rule:r,type:"direct",ruleProvider:{format:"text",geosite:"ir",geoip:"ir-cidr",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/ir.txt",geoipURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/ircidr.txt"}},{rule:n,type:"direct",ruleProvider:{format:"yaml",geosite:"cn",geoip:"cn-cidr",geositeURL:"https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.yaml",geoipURL:"https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.yaml"}},{rule:o,type:"direct",ruleProvider:{format:"yaml",geosite:"ru",geoip:"ru-cidr",geositeURL:"https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/category-ru.yaml",geoipURL:"https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/ru.yaml"}},{rule:!0,type:"block",ruleProvider:{format:"text",geosite:"malware",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/malware.txt"}},{rule:!0,type:"block",ruleProvider:{format:"text",geosite:"phishing",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/phishing.txt"}},{rule:!0,type:"block",ruleProvider:{format:"text",geosite:"cryptominers",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/cryptominers.txt"}},{rule:a,type:"block",ruleProvider:{format:"text",geosite:"ads",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/ads.txt"}},{rule:i,type:"block",ruleProvider:{format:"text",geosite:"nsfw",geositeURL:"https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/nsfw.txt"}}];function f(e,t,r,n){let o="text"===t?"txt":t;return{[e]:{type:"http",format:t,behavior:r,url:n,path:`./ruleset/${e}.${o}`,interval:86400}}}l(f,"buildRuleProvider");let m=[],g=[],y=[],b=[],v={};p.forEach((({rule:e,type:t,ruleProvider:r,noResolve:n})=>{let{geosite:o,geoip:a,geositeURL:i,geoipURL:s,format:l}=r;if(e){if(o){("direct"===t?m:y).push(`RULE-SET,${o},${"direct"===t?"DIRECT":"REJECT"}`);let e=f(o,l,"domain",i);Object.assign(v,e)}if(a){("direct"===t?g:b).push(`RULE-SET,${a},${"direct"===t?"DIRECT":"REJECT"}${n?",no-resolve":""}`);let e=f(a,l,"ipcidr",s);Object.assign(v,e)}}}));let w=l(((e,t)=>{if(qt(e))return`DOMAIN-SUFFIX,${e},${t}`;return`${Tr(e)?"IP-CIDR":"IP-CIDR6"},${Ye(e)?e.replace(/\[|\]/g,""):e}${e.includes("/")?"":Tr(e)?"/32":"/128"},${t},no-resolve`}),"generateRule");[...u,...h].forEach(((e,t)=>{let r=t<u.length,n=r?"DIRECT":"REJECT";(r?qt(e)?m:g:qt(e)?y:b).push(w(e,n))}));let _=[];return s&&_.push("AND,((NETWORK,udp),(DST-PORT,443)),REJECT"),_.push("OR,((IP-CIDR,10.10.34.34/32),(IP-CIDR,10.10.34.35/32),(IP-CIDR,10.10.34.36/32)),REJECT"),_=[..._,...y,...b,...m,...g],_.push("MATCH, Selector"),{rules:_,ruleProviders:v}}function xa(e,t,r,n,o,a,i){let{userID:s,defaultHttpsPorts:l}=globalThis,c=!!l.includes(r),d=Ye(t)?t.replace(/\[|\]/g,""):t,u={name:e,type:atob("dmxlc3M="),server:d,port:+r,uuid:s,"packet-encoding":"packetaddr",tls:c,network:"ws",udp:!0,"ws-opts":{path:a,headers:{Host:n},"max-early-data":2560,"early-data-header-name":"Sec-WebSocket-Protocol"}};return c&&Object.assign(u,{servername:o,alpn:["http/1.1"],"client-fingerprint":"random","skip-cert-verify":i}),u}function va(e,t,r,n,o,a,i){let s=Ye(t)?t.replace(/\[|\]/g,""):t;return{name:e,type:atob("dHJvamFu"),server:s,port:+r,password:globalThis.TRPassword,network:"ws",udp:!0,"ws-opts":{path:a,headers:{Host:n},"max-early-data":2560,"early-data-header-name":"Sec-WebSocket-Protocol"},sni:o,alpn:["http/1.1"],"client-fingerprint":"random","skip-cert-verify":i}}function un(e,t,r,n,o,a){let{amneziaNoiseCount:i,amneziaNoiseSizeMin:s,amneziaNoiseSizeMax:l}=e,c=n.includes("[")?n.match(/\[(.*?)\]/)[1]:n.split(":")[0],d=n.includes("[")?+n.match(/[^:]*$/)[0]:+n.split(":")[1],{warpIPv6:u,reserved:h,publicKey:p,privateKey:f}=ze(t,o),m={name:r,type:"wireguard",ip:"172.16.0.2/32",ipv6:u,"private-key":f,server:o?"162.159.192.1":c,port:o?2408:d,"public-key":p,"allowed-ips":["0.0.0.0/0","::/0"],reserved:h,udp:!0,mtu:1280};return o&&(m["dialer-proxy"]=o),a&&(m["amnezia-wg-option"]={jc:i,jmin:s,jmax:l}),m}function wa(e){if(["socks","http"].includes(e.protocol)){let{protocol:t,server:r,port:n,user:o,pass:a}=e;return{name:"",type:"socks"===t?"socks5":t,server:r,port:+n,"dialer-proxy":"",username:o,password:a}}let{server:t,port:r,uuid:n,flow:o,security:a,type:i,sni:s,fp:l,alpn:c,pbk:d,sid:u,headerType:h,host:p,path:f,serviceName:m}=e,g={name:" Chain Best Ping ",type:atob("dmxlc3M="),server:t,port:+r,udp:!0,uuid:n,flow:o,network:i,"dialer-proxy":" Best Ping "};if("tls"===a){let e=c?c?.split(","):[];Object.assign(g,{tls:!0,servername:s,alpn:e,"client-fingerprint":l})}if("reality"===a&&Object.assign(g,{tls:!0,servername:s,"client-fingerprint":l,"reality-opts":{"public-key":d,"short-id":u}}),"http"===h){let e=f?.split(",");g["http-opts"]={method:"GET",path:e,headers:{Connection:["keep-alive"],"Content-Type":["application/octet-stream"]}}}if("ws"===i){let e=f?.split("?ed=")[0],t=+f?.split("?ed=")[1];g["ws-opts"]={path:e,headers:{Host:p},"max-early-data":t,"early-data-header-name":"Sec-WebSocket-Protocol"}}return"grpc"===i&&(g["grpc-opts"]={"grpc-service-name":m}),g}async function fo(e,t,r){let{proxySettings:n,warpConfigs:o}=await be(e,t),{warpEndpoints:a}=n,i=structuredClone(bn);i.dns=await hn(n,!0,!0);let{rules:s,ruleProviders:l}=pn(n);i.rules=s,i["rule-providers"]=l;let c=i["proxy-groups"][0],d=i["proxy-groups"][1];c.proxies=[` Warp ${r?"Pro ":""}- Best Ping `,` WoW ${r?"Pro ":""}- Best Ping `],d.name=` Warp ${r?"Pro ":""}- Best Ping `,d.interval=+n.bestWarpInterval,i["proxy-groups"].push(structuredClone(d));let u=i["proxy-groups"][2];u.name=` WoW ${r?"Pro ":""}- Best Ping `;let h=[],p=[];return a.split(",").forEach(((e,t)=>{let a=` ${t+1} - Warp ${r?"Pro ":""}`,s=` ${t+1} - WoW ${r?"Pro ":""}`,l=un(n,o,a,e,"",r),c=un(n,o,s,e,a);i.proxies.push(c,l),h.push(a),p.push(s),d.proxies.push(a),u.proxies.push(s)})),c.proxies.push(...h,...p),new Response(JSON.stringify(i,null,4),{status:200,headers:{"Content-Type":"text/plain;charset=utf-8","Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate","CDN-Cache-Control":"no-store"}})}async function mn(e,t){let r,{hostName:n,defaultHttpsPorts:o}=globalThis,{proxySettings:a}=await be(e,t),{cleanIPs:i,proxyIP:s,ports:l,VLConfigs:c,TRConfigs:d,outProxy:u,outProxyParams:h,customCdnAddrs:p,customCdnHost:f,customCdnSni:m,bestVLTRInterval:g,enableIPv6:y}=a;if(u){let e=JSON.parse(h);try{r=wa(e)}catch(e){console.log("An error occured while parsing chain proxy: ",e),r=void 0,await t.kv.put("proxySettings",JSON.stringify({...a,outProxy:"",outProxyParams:{}}))}}let b=structuredClone(bn),{rules:v,ruleProviders:w}=pn(a);b.dns=await hn(a,r,!1),b.rules=v,b["rule-providers"]=w;let _=b["proxy-groups"][0],x=b["proxy-groups"][1];_.proxies=[" Best Ping "],x.name=" Best Ping ",x.interval=+g;let k,S=await Oe(i,y),C=p?p.split(","):[],E=[...S,...C],A=1;return[...c?[atob("VkxFU1M=")]:[],...d?[atob("VHJvamFu")]:[]].forEach((e=>{let t=1;l.forEach((a=>{E.forEach((l=>{let c,d,u=C.includes(l),h=u?"C":"",p=u?m:Me(n),g=u?f:n,y=Be(t,a,l,i,e,h).replace(" : "," - ");if(e===atob("VkxFU1M=")&&(k=`/${Se(16)}${s?`/${btoa(s)}`:""}`,c=xa(r?`proxy-${A}`:y,l,a,g,p,k,u),b.proxies.push(c),_.proxies.push(y),x.proxies.push(y)),e===atob("VHJvamFu")&&o.includes(a)&&(k=`/tr${Se(16)}${s?`/${btoa(s)}`:""}`,d=va(r?`proxy-${A}`:y,l,a,g,p,k,u),b.proxies.push(d),_.proxies.push(y),x.proxies.push(y)),r){let e=structuredClone(r);e.name=y,e["dialer-proxy"]=`proxy-${A}`,b.proxies.push(e)}A++,t++}))}))})),new Response(JSON.stringify(b,null,4),{status:200,headers:{"Content-Type":"text/plain;charset=utf-8","Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate","CDN-Cache-Control":"no-store"}})}l(hn,"buildClashDNS"),l(pn,"buildClashRoutingRules"),l(xa,"buildClashVLOutbound"),l(va,"buildClashTROutbound"),l(un,"buildClashWarpOutbound"),l(wa,"buildClashChainOutbound"),l(fo,"getClashWarpConfig"),l(mn,"getClashNormalConfig");var bn={"mixed-port":7890,ipv6:!0,"allow-lan":!0,mode:"rule","log-level":"warning","disable-keep-alive":!1,"keep-alive-idle":10,"keep-alive-interval":15,"unified-delay":!1,"geo-auto-update":!0,"geo-update-interval":168,"external-controller":"127.0.0.1:9090","external-ui-url":"https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip","external-ui":"ui","external-controller-cors":{"allow-origins":["*"],"allow-private-network":!0},profile:{"store-selected":!0,"store-fake-ip":!0},dns:{},tun:{enable:!0,stack:"mixed","auto-route":!0,"strict-route":!0,"auto-detect-interface":!0,"dns-hijack":["any:53","tcp://any:53"],mtu:9e3},sniffer:{enable:!0,"force-dns-mapping":!0,"parse-pure-ip":!0,"override-destination":!1,sniff:{HTTP:{ports:[80,8080,8880,2052,2082,2086,2095]},TLS:{ports:[443,8443,2053,2083,2087,2096]}}},proxies:[],"proxy-groups":[{name:" Selector",type:"select",proxies:[]},{name:"",type:"url-test",url:"https://www.gstatic.com/generate_204",interval:30,tolerance:50,proxies:[]}],"rule-providers":{},rules:[],ntp:{enable:!0,server:"time.apple.com",port:123,interval:30}};async function uo(e,t){let{hostName:r,defaultHttpsPorts:n,client:o,userID:a,TRPassword:i}=globalThis,{proxySettings:s}=await be(e,t),{remoteDNS:l,cleanIPs:c,proxyIP:d,ports:u,VLConfigs:h,TRConfigs:p,lengthMin:f,lengthMax:m,intervalMin:g,intervalMax:y,outProxy:b,customCdnAddrs:v,customCdnHost:w,customCdnSni:_,enableIPv6:x}=s,k="",S="",C="",E=1,A=await Oe(c,x),P=v?v.split(","):[],I=[...A,...P],R=encodeURIComponent(i),T="singbox"===o?"&eh=Sec-WebSocket-Protocol&ed=2560":encodeURIComponent("?ed=2560");if(u.forEach((e=>{I.forEach(((t,i)=>{let s=i>A.length-1,l=s?"C":"",u=s?_:Me(r),b=s?w:r,v=`${Se(16)}${d?`/${encodeURIComponent(btoa(d))}`:""}${T}`,x=encodeURIComponent(Be(E,e,t,c,atob("VkxFU1M="),l)),C=encodeURIComponent(Be(E,e,t,c,atob("VHJvamFu"),l)),P=n.includes(e)?`&security=tls&sni=${u}&fp=randomized&alpn=http/1.1`:"&security=none",I="hiddify-frag"===o&&n.includes(e)?`&fragment=${f}-${m},${g}-${y},hellotls`:"";h&&(k+=`${atob("dmxlc3M6Ly8=")}${a}@${t}:${e}?path=/${v}&encryption=none&host=${b}&type=ws${P}${I}#${x}\n`),p&&(S+=`${atob("dHJvamFuOi8v")}${R}@${t}:${e}?path=/tr${v}&host=${b}&type=ws${P}${I}#${C}\n`),E++}))})),b){let e=`#${encodeURIComponent(" Chain proxy ")}`;if(b.startsWith("socks")||b.startsWith("http")){let t=/^(?:socks|http):\/\/([^@]+)@/,r=b.match(t),n=!!r&&r[1];C=n?b.replace(n,btoa(n))+e:b+e}else C=b.split("#")[0]+e}let N=btoa(k+S+C),D={"Content-Type":"text/plain;charset=utf-8","Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate","CDN-Cache-Control":"no-store"};return"hiddify-frag"===o&&Object.assign(D,{"Profile-Title":"BPB Fragment",DNS:l}),new Response(N,{status:200,headers:D})}async function ho(e,t,r){let{proxySettings:n}=await be(e,t),{warpEndpoints:o,hiddifyNoiseMode:a,noiseCountMin:i,noiseCountMax:s,noiseSizeMin:l,noiseSizeMax:c,noiseDelayMin:d,noiseDelayMax:u}=n,h="";return o.split(",").forEach(((e,t)=>{h+=`warp://${e}${r?`?ifp=${i}-${s}&ifps=${l}-${c}&ifpd=${d}-${u}&ifpm=${a}`:""}#${encodeURIComponent(` ${t+1} - Warp `)}&&detour=warp://162.159.192.1:2408#${encodeURIComponent(` ${t+1} - WoW `)}\n`})),new Response(btoa(h),{status:200,headers:{"Profile-Title":"BPB Warp"+(r?" Pro":""),DNS:"1.1.1.1","Content-Type":"text/plain;charset=utf-8","Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate","CDN-Cache-Control":"no-store"}})}async function gn(){let e=`\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>${atob("QlBC")} Generator</title>\n    <style>\n        :root {\n            --color: black;\n            --primary-color: #09639f;\n            --header-color: #09639f; \n            --background-color: #fff;\n            --form-background-color: #f9f9f9;\n            --lable-text-color: #333;\n            --h2-color: #3b3b3b;\n            --border-color: #ddd;\n            --input-background-color: white;\n            --header-shadow: 2px 2px 4px rgba(0, 0, 0, 0.25);\n        }\n        html, body { height: 100%; margin: 0; }\n        body {\n            font-family: system-ui;\n            background-color: var(--background-color);\n            position: relative;\n            overflow: hidden;\n            text-align: center;\n        }\n        body.dark-mode {\n            --color: white;\n            --primary-color: #09639F;\n            --header-color: #3498DB; \n            --background-color: #121212;\n            --form-background-color: #121212;\n            --lable-text-color: #DFDFDF;\n            --h2-color: #D5D5D5;\n            --border-color: #353535;\n            --input-background-color: #252525;\n            --header-shadow: 2px 2px 4px rgba(255, 255, 255, 0.25);\n        }\n        html, body { height: 100%; margin: 0; }\n        .container {\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            width: 90%;\n        }\n        h1 { font-size: 2.5rem; text-align: center; color: var(--header-color); margin: 0 auto 30px; text-shadow: var(--header-shadow); }        \n        h2 { text-align: center; color: var(--h2-color) }\n        strong { color: var(--lable-text-color); }\n        .output-container {\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            margin: 15px 0;\n            padding: 10px;\n            background-color: var(--input-background-color);\n            color: var(--lable-text-color);\n            border: 1px solid var(--border-color);\n            border-radius: 5px;\n            font-family: monospace;\n            font-size: 1rem;\n            word-wrap: break-word;\n        }\n        .output { flex: 1; margin-right: 10px; overflow-wrap: break-word; }\n        .copy-icon {\n            cursor: pointer;\n            font-size: 1.2rem;\n            color: var(--primary-color);\n            transition: color 0.2s;\n        }\n        .copy-icon:hover { color: #2980b9; }\n        .form-container {\n            background: var(--form-background-color);\n            border: 1px solid var(--border-color);\n            border-radius: 10px;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n            padding: 20px;\n        }\n        .form-control { margin-bottom: 15px; display: flex; align-items: center; }\n        button {\n            display: block;\n            width: 100%;\n            padding: 10px;\n            font-size: 16px;\n            font-weight: 600;\n            border: none;\n            border-radius: 5px;\n            color: white;\n            background-color: var(--primary-color);\n            cursor: pointer;\n            transition: background-color 0.3s ease;\n        }\n        .button:hover,\n        button:focus {\n            background-color: #2980b9;\n            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);\n            transform: translateY(-2px);\n        }\n        button.button:hover { color: white; }\n        .button:active { transform: translateY(1px); box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3); }\n        @media only screen and (min-width: 768px) {\n            .container { width: 40%; }\n        }\n    </style>\n    </head>\n    <body>\n        <div class="container">\n            <h1>${atob("QlBC")} Panel <span style="font-size: smaller;">${globalThis.panelVersion}</span> </h1>\n            <div class="form-container">\n                <h2>Secrets generator</h2>\n                <div>\n                    <strong>Random UUID</strong>\n                    <div class="output-container">\n                        <span id="uuid" class="output"></span>\n                        <span class="copy-icon" onclick="copyToClipboard('uuid')"></span>\n                    </div>\n                </div>\n                <div>\n                    <strong>Random ${atob("VHJvamFu")} Password</strong>\n                    <div class="output-container">\n                        <span id="${atob("dHJvamFu")}-password" class="output"></span>\n                        <span class="copy-icon" onclick="copyToClipboard('${atob("dHJvamFu")}-password')"></span>\n                    </div>\n                </div>\n                <div>\n                    <strong>Random Subscription URI path</strong>\n                    <div class="output-container">\n                        <span id="sub-path" class="output"></span>\n                        <span class="copy-icon" onclick="copyToClipboard('sub-path')"></span>\n                    </div>\n                </div>\n                <button class="button" onclick="generateCredentials()">Generate Again </button>\n            </div>\n        </div>\n        <script>\n            localStorage.getItem('darkMode') === 'enabled' && document.body.classList.add('dark-mode');\n            function generateUUID() {\n                return crypto.randomUUID();\n            }\n    \n            function generateStrongPassword() {\n                const charset =\n                    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+[]{}|;:',.<>?";\n                let password = '';\n                const randomValues = new Uint8Array(16);\n                crypto.getRandomValues(randomValues);\n    \n                for (let i = 0; i < 16; i++) {\n                    password += charset[randomValues[i] % charset.length];\n                }\n                return password;\n            }\n            \n            function generateSubURIPath() {\n                const charset = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@$&*_-+;:,.";\n                let uriPath = '';\n                const randomValues = new Uint8Array(16);\n                crypto.getRandomValues(randomValues);\n    \n                for (let i = 0; i < 16; i++) {\n                    uriPath += charset[randomValues[i] % charset.length];\n                }\n                return uriPath;\n            }\n    \n            function generateCredentials() {\n                const uuid = generateUUID();\n                const password = generateStrongPassword();\n                const uriPath = generateSubURIPath();\n    \n                document.getElementById('uuid').textContent = uuid;\n                document.getElementById('${atob("dHJvamFu")}-password').textContent = password;\n                document.getElementById('sub-path').textContent = uriPath;\n            }\n    \n            function copyToClipboard(elementId) {\n                const textToCopy = document.getElementById(elementId).textContent;\n                navigator.clipboard.writeText(textToCopy)\n                    .then(() => alert(' Copied to clipboard!'))\n                    .catch(err => console.error('Failed to copy text:', err));\n            }\n    \n            generateCredentials();\n        <\/script>\n    </body>\n    </html>`;return new Response(e,{status:200,headers:{"Content-Type":"text/html"}})}l(uo,"getNormalConfigs"),l(ho,"getHiddifyWarpConfigs"),l(gn,"renderSecretsPage");var yc={async fetch(e,t){try{Ko(e,t);let{pathName:r,subPath:n,client:o}=globalThis,a=e.headers.get("Upgrade");if(a&&"websocket"===a)return r.startsWith("/tr")?await qo(e):await Go(e);switch(r){case"/update-warp":return await no(e,t);case"/get-warp-configs":return"amnezia"===o?await so(e,t,!0):await so(e,t);case`/sub/${n}`:return"sfa"===o?await fn(e,t,!1):"clash"===o?await mn(e,t):"xray"===o?await co(e,t,!1):await uo(e,t);case`/fragsub/${n}`:return"hiddify-frag"===o?await uo(e,t):await co(e,t,!0);case`/warpsub/${n}`:return"clash"===o?await fo(e,t):"clash-pro"===o?await fo(e,t,!0):"singbox"===o?await cn(e,t,o):"hiddify-pro"===o?await ho(e,t,!0):"hiddify"===o?await ho(e,t,!1):await nn(e,t,o);case"/panel":return await Wo(e,t);case"/login":return await $o(e,t);case"/logout":return Bo();case"/panel/password":return await Fo(e,t);case"/my-ip":return await jo(e);case"/secrets":return await gn();default:return await Ho(e)}}catch(e){return await en(e)}}};export{yc as default};